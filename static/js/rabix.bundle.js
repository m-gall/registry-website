!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=69)}([function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),o=n(1);e.ensureArray=function(t,n,r){return void 0===t||null===t?[]:Array.isArray(t)?"object"==typeof t[0]||void 0===n?t.slice():t.map(function(t){return e={},e[n]=t,e;var e}):"string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:Object.keys(t).map(function(o){return r&&"object"!==e.checkMapValueType(t)&&"object"!==e.checkValueType(t[o])?i((s={},s[r]=t[o],s),(a={},a[n]=o,a)):i({},t[o],(u={},u[n]=o,u));var s,a,u})},e.checkMapValueType=function(t){var n=null;return Object.keys(t).forEach(function(i){var r=e.checkValueType(t[i]);if(n&&r!==n)return n="mismatch";n=r}),n},e.checkValueType=function(t){return Array.isArray(t)?"array":null===t?"null":"object"==typeof t?"object":typeof t},e.incrementString=function(t){var e=t.replace(/^(.*?)(\d+$)/gi,function(t,e,n){return e+ ++n});return e===t?t+"_1":e},e.spreadAllProps=function(t,e){return i({},t,e)},e.spreadSelectProps=function(t,e,n){Object.keys(t).forEach(function(i){-1===n.indexOf(i)&&void 0!==t[i]&&(e[i]=t[i])})},e.intersection=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=[]),t.filter(function(t){return-1!==e.indexOf(t)})},e.commaSeparatedToArray=function(t){return t?Array.isArray(t)?t:t.replace(/\s/g,"").split(","):[]},e.charSeparatedToArray=function(t,e){return t?Array.isArray(t)?t:t.split(e).map(function(t){return t.trim()}):[]},e.snakeCase=function(t){return void 0===t&&(t=""),t.replace(/[\s.\[\/\]-]+/g,"_").replace(/([A-Z])/g,function(t){return"_"+t.toLowerCase()})},e.isEmpty=function(t){return Array.isArray(t)?0===t.length:"object"==typeof t&&null!==t?0===Object.keys(t).length:void 0},e.fetchByLoc=function(t,e){e=e.replace(/\[/g,".[").replace(/[\[\]]/g,"");for(var n=e.split(".").filter(function(t){return t.length}),i=t;n.length;){var r=n.shift().replace(/["']/g,"");try{i=isNaN(r)?i[r]:i[parseInt(r,10)]}catch(t){return}}return i},e.cleanupNull=function(t){for(var e=Object.keys(t),n=i({},t),r=0;r<e.length;r++){var o=e[r];void 0!==t[o]&&null!==t[o]||delete n[o]}return n},e.nullifyObjValues=function(t){for(var e=Object.keys(t),n=i({},t),r=0;r<e.length;r++)n[e[r]]=null;return n},e.validateID=function(t){if(!t)throw new o.ValidityError("ID must be set",o.ErrorCode.ID_MISSING);if(!r.ID_REGEX.test(t))throw new o.ValidityError('ID "'+t+'" contains invalid characters',o.ErrorCode.ID_INVALID_CHAR)},e.incrementLastLoc=function(t,e){if(void 0===t&&(t=[]),0===t.length)return e+"[0]";var n=t[t.length-1],i=((n.loc.match(/\[(\d+)]$/g)||[""])[0].match(/\d+/g)||[""])[0];return i?(i=parseInt(i),e+"["+ ++i+"]"):null},e.isType=function(t,e){return!(!t.type||!t.type.type)&&("string"==typeof e&&(e=[e]),e.filter(function(e){return t.type.type===e||t.type.items===e}).length>0)},e.checkIfConnectionIsValid=function(t,n,i){if(void 0===i&&(i=!0),t.parentStep&&n.parentStep&&t.parentStep.id===n.parentStep.id)throw new o.ValidityError("Invalid connection. Source and destination ports belong to the same step",o.ErrorCode.CONNECTION_SAME_STEP);var r=function(t){return"string"==typeof t?t:Array.isArray(t)?"union":"object"==typeof t&&null!==t?"object":void 0},s=t.type.type,a=n.type.type,u=r(t.type.items),c=r(n.type.items);if(s===a||(u===a||"union"===u)&&!i||(c===s||"union"===c)&&i||"null"===s||"null"===a){if("union"===c||"union"===u)return!0;if("record"===c&&"object"===u||"record"===u&&"object"===c)return!0;if(u&&c&&u!==c)throw new o.ValidityError('Invalid connection. Connection type mismatch, attempting to connect "'+u+'[]" to "'+c+'[]"',o.ErrorCode.CONNECTION_TYPE);if(("File"===s||"File"===u)&&n.fileTypes.length&&t.fileTypes.length){if(e.intersection(n.fileTypes.map(function(t){return t.toLowerCase()}),t.fileTypes.map(function(t){return t.toLowerCase()})).length)return!0;throw new o.ValidityError('Invalid connection. File type mismatch, connecting formats "'+t.fileTypes+'" to "'+n.fileTypes+'"',o.ErrorCode.CONNECTION_FILE_TYPE)}return!0}var l=u?'"'+u+'[]"':'"'+s+'"',p=c?'"'+c+'[]"':'"'+a+'"';throw new o.ValidityError("Invalid connection. Connection type mismatch, attempting to connect "+l+" to "+p,o.ErrorCode.CONNECTION_TYPE)},e.flatten=function(t){var e=function(t,n){for(var i=0;i<t.length;i++){var r=t[i];Array.isArray(r)?e(r,n):n.push(r)}},n=[];return e(t,n),n},e.returnNumIfNum=function(t){return isNaN(t)?t:parseInt(t)},e.isFileType=function(t,e){var n=void 0===e||t.type.isNullable!==e;return t.type&&n&&("File"===t.type.type||"File"===t.type.items)},e.hasFileType=function(t){if(e.isFileType(t))return!0;if(Array.isArray(t.type.fields))for(var n=0;n<t.type.fields.length;n++){var i=t.type.fields[n];if(e.hasFileType(i))return!0}return!1},e.getNextAvailableId=function(t,n){for(var i=!0,r=t,o=n.length;i;){i=!1;for(var s=0;s<o;s++)n[s].id===r&&(i=!0,r=e.incrementString(r))}return r},e.checkIdValidity=function(t,n){e.validateID(t);var i=e.getNextAvailableId(t,n);if(i!==t)throw new o.ValidityError('ID "'+t+'" already exists in this tool, the next available id is "'+i+'"',o.ErrorCode.ID_DUPLICATE)},e.concatIssues=function(t,n,i){for(var r=Object.keys(n),o=0;o<r.length;o++){var s=r[o];if(t[s]&&null!==n[s])if(i)t[s]=Array.isArray(n[s])?n[s]:[n[s]];else for(var a=Array.isArray(n[s])?n[s]:[n[s]],u=0;u<a.length;u++)e.issueExistsInArray(t[s],a[u])||t[s].push(a[u]);else Array.isArray(n[s])||null===n[s]?t[s]=n[s]:t[s]=[n[s]]}return t},e.issueExistsInArray=function(t,e){for(var n=0;n<t.length;n++)if(t[n].code===e.code&&t[n].message===e.message)return!0;return!1},e.checkPortIdUniqueness=function(t){for(var e={},n=[],i=0;i<t.length;i++){var r=t[i];e[r.id]?n.push(r):e[r.id]=!0}if(n.length>0)for(var i=0;i<n.length;i++){var s=n[i];s.setIssue((a={},a[s.loc+".id"]={type:"error",code:o.ErrorCode.ID_DUPLICATE,message:"Duplicate id found: “"+s.id+"”"},a))}var a}},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});!function(t){t[t.ALL=0]="ALL",t[t.ID_ALL=100]="ID_ALL",t[t.ID_INVALID_CHAR=101]="ID_INVALID_CHAR",t[t.ID_MISSING=102]="ID_MISSING",t[t.ID_DUPLICATE=103]="ID_DUPLICATE",t[t.EXPR_ALL=200]="EXPR_ALL",t[t.EXPR_SYNTAX=201]="EXPR_SYNTAX",t[t.EXPR_REFERENCE=202]="EXPR_REFERENCE",t[t.EXPR_TYPE=203]="EXPR_TYPE",t[t.EXPR_NOT_JSON=204]="EXPR_NOT_JSON",t[t.CONNECTION_ALL=300]="CONNECTION_ALL",t[t.CONNECTION_TYPE=301]="CONNECTION_TYPE",t[t.CONNECTION_FILE_TYPE=302]="CONNECTION_FILE_TYPE",t[t.CONNECTION_SAME_STEP=303]="CONNECTION_SAME_STEP",t[t.OUTPUT_ALL=400]="OUTPUT_ALL",t[t.OUTPUT_GLOB_MISSING=401]="OUTPUT_GLOB_MISSING",t[t.OUTPUT_EVAL_EXPR=402]="OUTPUT_EVAL_EXPR",t[t.OUTPUT_EVAL_INHERIT=403]="OUTPUT_EVAL_INHERIT",t[t.TYPE_ALL=500]="TYPE_ALL",t[t.TYPE_FIELDS_MISSING=501]="TYPE_FIELDS_MISSING",t[t.TYPE_ITEMS_MISSING=502]="TYPE_ITEMS_MISSING",t[t.TYPE_SYMBOLS_MISSING=503]="TYPE_SYMBOLS_MISSING",t[t.TYPE_NAME_MISSING=504]="TYPE_NAME_MISSING",t[t.TYPE_EXTRA_PROPS=505]="TYPE_EXTRA_PROPS",t[t.TYPE_UNSUPPORTED=506]="TYPE_UNSUPPORTED",t[t.TYPE_FIELD_DUPLICATE_ID=507]="TYPE_FIELD_DUPLICATE_ID"}(e.ErrorCode||(e.ErrorCode={}));var r=function(t){function e(e,n){var i=t.call(this,e)||this;return i.code=n,i}return i(e,t),e}(Error);e.ValidityError=r},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),o=n(0),s=n(1),a=function(){function t(t){this.issues={},this._errors=[],this._warnings=[],this.hasNewErrors=!1,this.hasNewWarnings=!1,this.modelListeners=[],this.loc="",this.updateParentValidation=function(t){},this.loc=t||"",this.issues[this.loc]=[]}return t.prototype.clearListeners=function(){this.modelListeners.forEach(function(t){return t()})},Object.defineProperty(t.prototype,"warnings",{get:function(){return this.hasNewWarnings&&(this._warnings=this.filterIssues("warning"),this.hasNewWarnings=!1),this._warnings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errors",{get:function(){return this.hasNewErrors&&(this._errors=this.filterIssues("error"),this.hasNewErrors=!1),this._errors},enumerable:!0,configurable:!0}),t.prototype.updateValidity=function(t){this.issues=o.concatIssues(this.issues,t.data,t.overwrite),this.hasNewErrors=!0,this.hasNewWarnings=!0,t.stopPropagation||this.updateParentValidation(t)},t.prototype.setIssue=function(t,e){void 0===e&&(e=!1),this.updateValidity({data:t,overwrite:!1,stopPropagation:e})},t.prototype.clearIssue=function(t){var e=!1,n=t%100==0,i=t/100;for(var r in this.issues)if(this.issues[r].length)if(t===s.ErrorCode.ALL)e=!0,this.issues[r]=[];else{var o=this.issues[r].length;this.issues[r]=this.issues[r].filter(function(e){return n?Math.floor(e.code/100)!==i:e.code!==t}),e=o!==this.issues[r].length||e}e&&this.updateValidity({data:this.issues,overwrite:!0})},t.prototype.cleanValidity=function(){},t.prototype.updateLoc=function(t){var e=this.loc;this.issues[t]=this.issues[e],delete this.issues[e],this.loc=t,this.updateValidity({data:this.issues,overwrite:!0})},t.prototype.setValidationCallback=function(t){this.updateParentValidation=t},t.prototype.filterIssues=function(t){void 0===t&&(t="error");var e=[],n=this;for(var r in this.issues)!function(r){if(n.issues[r].length){var o=n.issues[r].filter(function(e){return e.type===t}),s=o.map(function(t){return i({},t,{loc:r})});e=e.concat(s)}}(r);return e},t.prototype.validate=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new r.UnimplementedMethodException("validate"),new Promise(function(e){e(t.issues)})},t}();e.ValidationBase=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){}return t}();e.UnimplementedMethodException=i},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(29),s=n(2),a=n(0),u=n(1),c=function(t){function e(e,n,i,r,o){var s=t.call(this,r)||this;return s.customProps={},s.hasDirectoryType=!1,s._items=null,s.isNullable=!1,s.isItemOrArray=!1,s.typeBinding=null,s.fields=null,s._symbols=null,s.name=null,s.unionType=null,s.nameBase="field",s.fieldConstructor=n,s.eventHub=o,s.nameBase=i,s.deserialize(e),s}return i(e,t),Object.defineProperty(e.prototype,"symbols",{get:function(){return this._symbols},set:function(t){this._symbols=t,this.eventHub&&this.eventHub.emit("io.change.type",this.loc)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},set:function(t){if(t&&"array"!==this._type)throw"ParameterTypeModel: Items can only be set to inputs type Array";if(void 0!==t&&this._items!==t){switch(t){case"enum":this._symbols=[],this.removeAllFields();break;case"record":this.fields=[],this._symbols=null;break;default:this._symbols=null,this.removeAllFields()}this._items=t,this.eventHub&&this.eventHub.emit("io.change.type",this.loc)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){if(void 0===t||this._type!==t){switch(this._type=t,t){case"array":this._symbols=null,this.removeAllFields();break;case"enum":this._items=null,this.removeAllFields(),this._symbols=this._symbols||[];break;case"record":this._items=null,this._symbols=null,this.fields=this.fields||[];break;default:this._items=null,this._symbols=null,this.removeAllFields()}this.eventHub&&this.eventHub.emit("io.change.type",this.loc)}},enumerable:!0,configurable:!0}),e.prototype.validate=function(t){var e=this;void 0===t&&(t={}),this.clearIssue(u.ErrorCode.TYPE_ALL);var n=[];return"array"===this.type&&(null===this.items&&this.setIssue((i={},i[this.loc]={type:"error",message:"Type array must have items",code:u.ErrorCode.TYPE_ITEMS_MISSING},i)),this._symbols&&"enum"!==this.items&&this.setIssue((r={},r[this.loc+".symbols"]={type:"error",message:"Type array must not have symbols",code:u.ErrorCode.TYPE_SYMBOLS_MISSING},r)),this.fields&&"record"!==this.items&&this.setIssue((o={},o[this.loc+".fields"]={type:"error",message:"Type array must not have fields",code:u.ErrorCode.TYPE_FIELDS_MISSING},o))),"enum"===this.type&&(this.items&&this.setIssue((s={},s[this.loc+".items"]={type:"error",message:"Type enum must not have items",code:u.ErrorCode.TYPE_EXTRA_PROPS},s)),this._symbols||this.setIssue((a={},a[this.loc]={type:"error",message:"Type enum must have symbols",code:u.ErrorCode.TYPE_EXTRA_PROPS},a)),this.fields&&this.setIssue((c={},c[this.loc+".fields"]={type:"error",message:"Type enum must not have fields",code:u.ErrorCode.TYPE_EXTRA_PROPS},c)),this.name||this.setIssue((l={},l[""+this.loc]={type:"error",message:"Type enum must have a name",code:u.ErrorCode.TYPE_EXTRA_PROPS},l))),"record"===this.type&&(this.items&&this.setIssue((p={},p[this.loc+".items"]={type:"error",message:"Type record must not have items",code:u.ErrorCode.TYPE_EXTRA_PROPS},p)),this._symbols&&this.setIssue((d={},d[this.loc+".symbols"]={type:"error",message:"Type record must not have symbols",code:u.ErrorCode.TYPE_EXTRA_PROPS},d)),this.fields||this.setIssue((h={},h[""+this.loc]={type:"error",message:"Type record must have fields",code:u.ErrorCode.TYPE_EXTRA_PROPS},h)),this.name||this.setIssue((f={},f[this.loc+".type"]={type:"error",message:"Type record must have a name",code:u.ErrorCode.TYPE_NAME_MISSING},f))),this.unionType&&this.setIssue((y={},y[this.loc]={type:"info",message:"Union type is not supported yet: "+this.unionType,code:u.ErrorCode.TYPE_UNSUPPORTED},y)),Promise.all(n).then(function(t){return e.issues});var i,r,o,s,a,c,l,p,d,h,f,y},e.prototype.serialize=function(t){var e=o.TypeResolver.serializeType(this,t);return"object"!=typeof e||Array.isArray(e)||"v1.0"===t||null===e||(e=r({},e,this.customProps)),e},e.prototype.deserialize=function(t){var e=this,n=["type","name","_symbols","fields","items","inputBinding","outputBinding"];try{o.TypeResolver.resolveType(t,this)}catch(t){this.setIssue((i={},i[this.loc]={message:t.message,type:"error",code:t.code},i))}"object"!=typeof t||null===t||Array.isArray(t)||a.spreadSelectProps(t,this.customProps,n),this.fields&&(this.fields=a.ensureArray(this.fields,"name","type").map(function(t,n){var i=new e.fieldConstructor(t,e.loc+".fields["+n+"]",e.eventHub);return i.isField=!0,i.setValidationCallback(function(t){return e.updateValidity(t)}),i}));var i},e.prototype.updateLoc=function(e){var n=this;t.prototype.updateLoc.call(this,e),this.fields&&this.fields.length&&this.fields.forEach(function(t,e){return t.updateLoc(n.loc+".fields["+e+"]")})},e.prototype.setType=function(t){switch(this._type=t,t){case"array":this._symbols=null,this.removeAllFields();break;case"enum":this._items=null,this.removeAllFields();break;case"record":this._items=null,this._symbols=null}this.eventHub&&this.eventHub.emit("io.change.type",this.loc)},e.prototype.getNextAvailableName=function(t){for(var e=!0,n=t,i=this.fields,r=i.length;e;){e=!1;for(var o=0;o<r;o++)i[o].id===n&&(e=!0,n=a.incrementString(n))}return n},e.prototype.addField=function(t){var e=this;if(void 0===t&&(t={}),"record"!==this.type&&"record"!==this.items)throw new Error("Fields can only be added to type or items record: type is "+this.type+", items is "+this.items+".");if(t.id){var n=this.fields.filter(function(e){return e.id===t.name||e.id===t.id});n.length>0&&this.setIssue((o={},o[this.loc]={message:'Field with name "'+n[0].id+'" already exists',type:"error",code:u.ErrorCode.TYPE_FIELD_DUPLICATE_ID},o))}if(t instanceof this.fieldConstructor)return t.loc=this.loc+".fields["+this.fields.length+"]",t.setValidationCallback(function(t){return e.updateValidity(t)}),this.eventHub&&this.eventHub.emit("field.create",t),this.fields.push(t),t;t.name=t.name||this.getNextAvailableName(this.nameBase);var i=a.incrementLastLoc(this.fields,this.loc+".fields"),r=new this.fieldConstructor(t,i,this.eventHub);return r.setValidationCallback(function(t){return e.updateValidity(t)}),this.eventHub&&this.eventHub.emit("field.create",r),this.fields.push(r),r;var o},e.prototype.removeField=function(t){var e;e="string"==typeof t?this.fields.filter(function(e){return e.id===t})[0]:t,e.clearIssue(u.ErrorCode.ALL);var n=this.fields.indexOf(e);if(n<0)throw"Field "+t+" does not exist on input";this.fields.splice(n,1);for(var i=n;i<this.fields.length;i++)this.fields[i].updateLoc(this.loc+".fields["+i+"]");this.eventHub&&this.eventHub.emit("field.remove",e)},e.prototype.removeAllFields=function(){this.fields&&this.fields.length&&this.fields.forEach(function(t){t.clearIssue(u.ErrorCode.ALL)}),this.fields=null},e}(s.ValidationBase);e.ParameterTypeModel=c},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),s=n(17),a=function(t){function e(n,i,r){var o=t.call(this,i,r)||this;return o.value="",o.tokens=[],n instanceof e&&(n=n.serialize()),n&&o.deserialize(n),o.eventHub&&o.eventHub.emit("expression.create",o),o}return i(e,t),e.prototype.serialize=function(){return"expression"===this.type&&this.eventHub&&this.eventHub.emit("expression.serialize",!0),""!==this.value?this.value:void 0},e.prototype.deserialize=function(t){"string"==typeof t&&(this.value=t,this.tokenizeAndSetType(t))},e.prototype.tokenizeAndSetType=function(t){return this.tokens=s.ExpressionEvaluator.grabExpressions(t||"")||[],this.type=1===this.tokens.length&&"literal"===this.tokens[0].type||0===this.tokens.length?"string":"expression",this.tokens},e.prototype.evaluate=function(t){return void 0===t&&(t=this.cachedContext),void 0!==this.value?this._evaluate(this.value,t,"v1.0"):new Promise(function(t){t(void 0)})},e.prototype.setValue=function(t,e){this.result=void 0,this.tokenizeAndSetType(t),this.value=t,this.eventHub&&this.eventHub.emit("expression.change",this)},e.prototype.getScript=function(){return this.value},e.prototype.toString=function(){return this.value||""},e.prototype.clone=function(){return new e(this.serialize(),this.loc,this.eventHub)},e.prototype.cloneStatus=function(t){this.setValue(t.serialize()),this.setIssue(r({},t.issues))},e}(o.ExpressionModel);e.V1ExpressionModel=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.STEP_INPUT_CONNECTION_PREFIX="in/",e.STEP_OUTPUT_CONNECTION_PREFIX="out/",e.ID_REGEX=/^[a-zA-Z0-9_;\/?\-:@&=+$,.#!~*'()\[\]]*$/},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),s=function(t){function e(n,i,r){var o=t.call(this,i,r)||this;return n instanceof e&&(n=n.serialize()),o.deserialize(n),n&&(o.type=n.script?"expression":"string"),o.eventHub&&o.eventHub.emit("expression.create",o),o}return i(e,t),e.prototype.evaluate=function(t){return void 0===t&&(t=this.cachedContext),void 0!==this.value?this._evaluate(this.value,t,"draft-2"):new Promise(function(t){t(void 0)})},e.prototype.serialize=function(){if("expression"===this.type&&this.eventHub&&this.eventHub.emit("expression.serialize",!0),!(this.value&&this.value.hasOwnProperty("script")&&""===this.value.script||""===this.value||null===this.value))return this.value},e.prototype.deserialize=function(t){void 0===t&&(t=""),this.value=t},e.prototype.setValue=function(t,e){this.result=void 0,this.value="expression"===e&&"string"==typeof t?{class:"Expression",engine:"#cwl-js-engine",script:""===t.trim()?"":t}:t,this.type=e,this.eventHub&&this.eventHub.emit("expression.change",this)},e.prototype.toString=function(){return"expression"===this.type?this.value.script:null===this.value||void 0===this.value?"":this.value.toString()},e.prototype.getScript=function(){return void 0!==this.value&&null!==this.value?this.value.script:void 0},e.prototype.clone=function(){return new e(this.serialize(),this.loc,this.eventHub)},e.prototype.cloneStatus=function(t){this.setValue(t.serialize(),t.type),this.setIssue(r({},t.issues))},e}(o.ExpressionModel);e.SBDraft2ExpressionModel=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.prototype.registerWorkflow=function(t){this.workflow=t},t.prototype.registerOnBeforeChange=function(t){this.onBeforeChange=t},t.prototype.registerOnAfterChange=function(t){this.onAfterChange=t},t.prototype.registerOnAfterRender=function(t){this.onAfterRender=t},t}();e.PluginBase=i},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(17),s=n(1),a=function(t){function e(e,n){var i=t.call(this,e)||this;return i.eventHub=n,i.customProps={},i.cachedContext={},i._type="string",i}return i(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){if("string"!==t&&"expression"!==t&&"number"!==t)throw new TypeError('Unknown ExpressionModel type. "'+t+'" does not exist or is not supported yet.');this._type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExpression",{get:function(){return"expression"===this.type},enumerable:!0,configurable:!0}),e.prototype.validate=function(t){var e=this;return this.evaluate(t).then(function(t){e.clearIssue(s.ErrorCode.EXPR_ALL)},function(t){e.clearIssue(s.ErrorCode.EXPR_ALL),e.setIssue((n={},n[e.loc]={type:t.type,message:t.message,code:t.code},n));var n})},e.prototype._evaluate=function(t,e,n){var i=this;return new Promise(function(r,a){o.ExpressionEvaluator.evaluate(t,e,n).then(function(t){i.result=t,r(t)},function(t){var e=t.message,n=s.ErrorCode.EXPR_SYNTAX;t.message.startsWith("Uncaught DataCloneError")&&(e="Error: Return value should have transferable data (fully JSON-serializable)",n=s.ErrorCode.EXPR_NOT_JSON);var r={loc:i.loc,message:e,code:n};t.message.startsWith("Uncaught SyntaxError")||"SyntaxError"===t.name?a(Object.assign({type:"error"},r)):(t.message.startsWith("Uncaught ReferenceError")||"ReferenceError"===t.name?n=s.ErrorCode.EXPR_REFERENCE:(t.message.startsWith("Uncaught TypeError")||"TypeError"===t.name)&&(n=s.ErrorCode.EXPR_TYPE),a(Object.assign({type:"warning",code:n},r)))})})},e}(r.ValidationBase);e.ExpressionModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(3),s=n(0),a=n(1),u=function(t){function e(e,n){var i=t.call(this,e)||this;return i.isField=!1,i.customProps={},i.eventHub=n,i}return i(e,t),Object.defineProperty(e.prototype,"isBound",{get:function(){return void 0!==this.inputBinding&&null!==this.inputBinding},enumerable:!0,configurable:!0}),e.prototype.removeInputBinding=function(){this.inputBinding&&this.inputBinding.clearIssue(a.ErrorCode.EXPR_ALL),this.hasSecondaryFilesInRoot||(this.secondaryFiles.forEach(function(t){return t.clearIssue(a.ErrorCode.EXPR_ALL)}),this.secondaryFiles=[]),this.inputBinding=null},e.prototype.updateLoc=function(e){t.prototype.updateLoc.call(this,e),this.type.updateLoc(e+".type")},e.prototype._addSecondaryFile=function(t,e,n){var i=this,r=s.incrementLastLoc(this.secondaryFiles,n+".secondaryFiles"),o=new e(t,r,this.eventHub);return this.secondaryFiles.push(o),o.setValidationCallback(function(t){return i.updateValidity(t)}),o},e.prototype._updateSecondaryFiles=function(t){var e=this;this.secondaryFiles.forEach(function(t){return t.clearIssue(a.ErrorCode.EXPR_ALL)}),this.secondaryFiles=[],t.forEach(function(t){return e.addSecondaryFile(t)})},e.prototype._removeSecondaryFile=function(t){var e=this.secondaryFiles[t];e&&(e.setValue("","string"),this.secondaryFiles.splice(t,1))},e.prototype.validate=function(t){var e=[];try{s.validateID(this.id)}catch(t){this.setIssue((n={},n[this.loc+".id"]={type:"error",message:t.message,code:t.code},n))}return this.inputBinding&&e.push(this.inputBinding.validate(t)),this.type&&e.push(this.type.validate(t)),this.secondaryFiles&&e.concat(this.secondaryFiles.map(function(e){return e.validate(t)})),Promise.all(e);var n},e.prototype.serialize=function(){new o.UnimplementedMethodException("serialize","CommandInputParameterModel")},e.prototype.deserialize=function(t){new o.UnimplementedMethodException("deserialize","CommandInputParameterModel")},e.prototype.attachFileTypeListeners=function(){var t=this;this.eventHub&&this.modelListeners.push(this.eventHub.on("io.change.type",function(e){t.loc+".type"===e&&(s.isFileType(t)||t.updateSecondaryFiles([]))}))},e}(r.ValidationBase);e.CommandInputParameterModel=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),o=n(42),s=n(43),a=n(3),u=n(0),c=n(2),l=n(44),p=n(14),d=n(18),h=n(15),f=n(16),y=n(19),v=n(20),m=n(1),g=function(t){function e(e){var n=t.call(this,e)||this;return n.class="Workflow",n.hasBatch=!1,n.steps=[],n.inputs=[],n.outputs=[],n.hints=[],n.customProps={},n.eventHub=new o.EventHub(["step.create","step.remove","step.change","step.update","step.change.id","step.inPort.show","step.inPort.hide","step.inPort.remove","step.inPort.create","step.outPort.remove","step.outPort.create","step.port.change","connections.updated","input.remove","input.create","output.create","output.remove","io.change","io.change.id","io.change.type","connection.create","connection.remove"]),n.initializeGraphWatchers(),n}return i(e,t),Object.defineProperty(e.prototype,"connections",{get:function(){return Array.from(this.graph.edges)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nodes",{get:function(){return Array.from(this.graph.vertices)},enumerable:!0,configurable:!0}),e.prototype.addVertex=function(t,e,n){void 0===n&&(n=this.graph);try{n.addVertex(t,e,function t(){e.id=this.getNextAvailableId(e.connectionId,!(e instanceof d.StepModel),n),n.addVertex(e.connectionId,e,t)}.bind(this))}catch(t){e.setIssue((i={},i[e.loc]={message:t.message,code:t.code,type:"error"},i))}var i},e.prototype.initializeGraphWatchers=function(){var t=this;this.eventHub.on("step.inPort.create",function(e){t.addVertex(e.connectionId,e),t.graph.addEdge({id:e.connectionId,type:"StepInput"},{id:e.parentStep.id,type:"Step"},!1)}),this.eventHub.on("step.outPort.create",function(e){t.addVertex(e.connectionId,e),t.graph.addEdge({id:e.parentStep.id,type:"Step"},{id:e.connectionId,type:"StepOutput"},!1)}),this.eventHub.on("step.inPort.remove",function(e){t.clearPort(e),t.graph.removeVertex(e.connectionId),t.graph.removeEdge([e.connectionId,e.parentStep.connectionId])}),this.eventHub.on("step.outPort.remove",function(e){t.clearOutPort(e),t.graph.removeVertex(e.connectionId),t.graph.removeEdge([e.parentStep.connectionId,e.connectionId])}),this.eventHub.on("step.port.change",function(e){if(t.graph.setVertexData(e.connectionId,e),e instanceof v.WorkflowStepOutputModel&&t.graph.hasOutgoing(e.connectionId)){Array.from(t.graph.edges).forEach(function(n){if(n.source.id===e.connectionId){var i=t.findById(n.destination.id);if(!(i instanceof f.WorkflowOutputParameterModel)||1!==i.source.length)return;t.removeOutput(i),t.createOutputFromPort(e.connectionId,{customProps:i.customProps})}})}})},e.prototype.on=function(t,e){return{dispose:this.eventHub.on(t,e)}},e.prototype.off=function(t,e){this.eventHub.off(t,e)},e.prototype.serializeEmbedded=function(t){void 0===t&&(t=!1),new a.UnimplementedMethodException("serializeEmbedded","WorkflowModel")},e.prototype.serialize=function(){new a.UnimplementedMethodException("serialize","WorkflowModel")},e.prototype.deserialize=function(t){new a.UnimplementedMethodException("deserialize","WorkflowModel")},e.prototype.addHint=function(t){return new a.UnimplementedMethodException("addHint","WorkflowModel"),null},e.prototype.createReq=function(t,e,n,i){var r=this;void 0===i&&(i=!1);var o,s=i?"hints":"requirements";return n=n||this.loc+"."+s+"["+this[s].length+"]",o=new p.RequirementBaseModel(t,e,n),o.isHint=i,this[s].push(o),o.setValidationCallback(function(t){return r.updateValidity(t)}),o},e.prototype.setBatch=function(t,e){},e.prototype.findById=function(t){return this.graph.getVertexData(t)},e.prototype._exposePort=function(t,e){return this.clearPort(t),this._createInputFromPort(t,e,!1,!0)},e.prototype.exposePort=function(t){new a.UnimplementedMethodException("exposePort","WorkflowModel")},e.prototype.includePort=function(t){"exposed"===t.status&&this.clearPort(t),t.isVisible=!0,this.graph.hasVertex(t.connectionId)||(this.addVertex(t.connectionId,t),this.graph.addEdge({id:t.parentStep.id,type:"StepInput"},{id:t.connectionId,type:"Step"},!0)),this.eventHub.emit("step.inPort.show",t)},e.prototype.clearPort=function(t){for(;t.source.length;){var e=t.source[0],n=this.getSourceConnectionId(e);this.disconnect(n,t.connectionId)}t.isVisible=!1,this.eventHub.emit("step.inPort.hide",t),t.clearIssue(m.ErrorCode.ALL)},e.prototype.clearOutPort=function(t){var e=this;this.graph.edges.forEach(function(n){n.source.id===t.connectionId&&e.disconnect(t.connectionId,n.destination.id)}),t.isVisible=!1},e.prototype.removeDanglingInput=function(t){var e=this;this.graph.hasOutgoing(t)||(this.graph.removeVertex(t),this.inputs=this.inputs.filter(function(n){return n.connectionId!==t||(e.eventHub.emit("input.remove",n),!1)}))},e.prototype.removeDanglingOutput=function(t){var e=this;this.graph.hasIncoming(t)||(this.graph.removeVertex(t),this.outputs=this.outputs.filter(function(n){return n.connectionId!==t||(n.clearIssue(m.ErrorCode.ALL),e.eventHub.emit("output.remove",n),!1)}))},e.prototype.removeStep=function(t){"string"==typeof t&&(t=this.graph.getVertexData(t));for(var e=0;e<this.steps.length;e++)if(this.steps[e].id===t.id){this.steps[e].clearIssue(m.ErrorCode.ALL),this.steps.splice(e,1);break}this.removeStepFromGraph(t);for(var n=this.inputs.length;n--;)this.removeDanglingInput(this.inputs[n].connectionId);for(var i=this.outputs.length;i--;)this.removeDanglingOutput(this.outputs[i].connectionId);for(var r=this.gatherDestinations(),o=0;o<r.length;o++)for(var e=0;e<t.out.length;e++){var s=r[o].source.indexOf(t.out[e].sourceId);s>-1&&(r[o].source.splice(s,1),this.validateDestination(r[o]))}t.cleanValidity(),this.eventHub.emit("step.remove",t)},e.prototype.removeStepFromGraph=function(t){var e=this;this.graph.removeVertex(t.connectionId);var n=t.in.map(function(t){return t.connectionId}),i=t.out.map(function(t){return t.connectionId});this.graph.edges.forEach(function(r){-1!==n.indexOf(r.destination.id)||-1!==i.indexOf(r.source.id)?(e.eventHub.emit("connection.remove",e.graph.getVertexData(r.source.id),e.graph.getVertexData(r.destination.id)),e.graph.removeEdge(r)):r.destination.id!==t.connectionId&&r.source.id!==t.connectionId||e.graph.removeEdge(r)}),n.forEach(function(t){return e.graph.removeVertex(t)}),i.forEach(function(t){return e.graph.removeVertex(t)})},e.prototype.removeInput=function(t){"string"==typeof t&&(t=this.graph.getVertexData(t));for(var e=0;e<this.inputs.length;e++)if(this.inputs[e].id==t.id){this.inputs[e].clearIssue(m.ErrorCode.ALL),this.inputs.splice(e,1);break}this.removeIONodeFromGraph(t);for(var e=0;e<this.outputs.length;e++)this.removeDanglingOutput(this.outputs[e].connectionId);for(var n=this.gatherDestinations(),e=0;e<n.length;e++){var i=n[e].source.indexOf(t.sourceId);-1!==i&&n[e].source.splice(i,1)}this.eventHub.emit("input.remove",t)},e.prototype.removeOutput=function(t){"string"==typeof t&&(t=this.graph.getVertexData(t));for(var e=0;e<this.outputs.length;e++)if(this.outputs[e].id==t.id){this.outputs[e].clearIssue(m.ErrorCode.ALL),this.outputs.splice(e,1);break}for(var e=0;e<this.inputs.length;e++)this.removeDanglingInput(this.inputs[e].connectionId);this.removeIONodeFromGraph(t),this.eventHub.emit("output.remove",t)},e.prototype.isSourceFromStep=function(t,e){throw new a.UnimplementedMethodException("isSourceFromStep","WorkflowModel")},e.prototype.checkIdValidity=function(t,e){u.validateID(t);var n=this.getNextAvailableId(e);if(n!==t)throw new Error('ID already exists on graph, the next available id is "'+n+'"')},e.prototype.changeStepId=function(t,e){var n=this;if(e!==t.id){this.checkIdValidity(e,e);var i=t.id;this.removeStepFromGraph(t),t.id=e,this.addStepToGraph(t),t.in.forEach(function(t){var e={id:t.connectionId,type:"StepInput"};t.source.forEach(function(i){n.connectSource(i,t,e)})}),this.gatherDestinations().forEach(function(e){for(var r=0;r<e.source.length;r++)!function(r){var o=e.source[r],s=n.isSourceFromStep(o,i);if(s){e.source[r]=t.out.find(function(t){return t.id===s}).sourceId;var a={id:e.connectionId,type:n.getNodeType(e)};n.connectSource(e.source[r],e,a)}}(r)}),this.eventHub.emit("step.change.id",t)}},e.prototype.removeIONodeFromGraph=function(t){var e=this;this.graph.edges.forEach(function(n){n.destination.id!==t.connectionId&&n.source.id!==t.connectionId||e.disconnect(n.source.id,n.destination.id)}),this.graph.removeVertex(t.connectionId)},e.prototype.changeIONodeId=function(t,e){var n=this;if(t.id!==e){var i=t instanceof h.WorkflowInputParameterModel?r.STEP_OUTPUT_CONNECTION_PREFIX:r.STEP_INPUT_CONNECTION_PREFIX;this.checkIdValidity(e,""+i+e+"/"+e);var o=t.connectionId,s=t.id,a=t.sourceId;t.id=e,this.graph.removeVertex(o),this.addVertex(t.connectionId,t),t instanceof f.WorkflowOutputParameterModel&&this.graph.edges.forEach(function(e){e.destination.id===o&&(e.destination.id=t.connectionId)}),t instanceof h.WorkflowInputParameterModel&&this.graph.edges.forEach(function(e){if(e.source.id===o){e.source.id=t.connectionId;for(var i=n.graph.getVertexData(e.destination.id),r=0;r<i.source.length;r++)i.source[r]===a&&(i.source[r]=t.sourceId)}}),this.eventHub.emit("io.change.id",t,s)}},e.prototype.addEdge=function(t,e,n,i){void 0===n&&(n=!0),void 0===i&&(i=!0),this.graph.addEdge(t,e,n,i)},e.prototype.checkSrcAndDest=function(t,e){if("string"==typeof t&&(t=this.graph.getVertexData(t)),"string"==typeof e&&(e=this.graph.getVertexData(e)),!t||!e)throw new Error("Source and destination must be defined");if(!(t instanceof h.WorkflowInputParameterModel||t instanceof v.WorkflowStepOutputModel))throw new Error("Expected source to be instanceof WorkflowInputParameterModel or WorkflowStepOutputModel, instead got "+t.constructor.name);if(!(e instanceof f.WorkflowOutputParameterModel||e instanceof y.WorkflowStepInputModel))throw new Error("Expected destination to be instanceof WorkflowOutputParameterModel or WorkflowStepInputModel, instead got "+e.constructor.name);return[t,e]},e.prototype.disconnect=function(t,e){if(i=this.checkSrcAndDest(t,e),t=i[0],e=i[1],!this.graph.removeEdge({source:{id:t.connectionId},destination:{id:e.connectionId}}))throw new Error("Could not remove nonexistent connection between "+t.connectionId+" and "+e.connectionId);for(var n=e.source.length;n--;)e.source[n]===t.sourceId&&e.source.splice(n,1);this.validateDestination(e),t instanceof h.WorkflowInputParameterModel&&this.removeDanglingInput(t.connectionId),e instanceof f.WorkflowOutputParameterModel&&this.removeDanglingOutput(e.connectionId),this.eventHub.emit("connection.remove",t,e);var i},e.prototype.connect=function(t,e,n){if(void 0===n&&(n=!0),r=this.checkSrcAndDest(t,e),t=r[0],e=r[1],e.parentStep&&t.parentStep&&e.parentStep.id===t.parentStep.id)throw new Error("Cannot connect ports that belong to the same step: "+e.parentStep.id);e.source.push(t.sourceId);var i=this.validateConnection(e,t);return this.addEdge({id:t.connectionId,type:this.getNodeType(t)},{id:e.connectionId,type:this.getNodeType(e)},n,i),this.eventHub.emit("connection.create",t,e),i;var r},e.prototype.addStepFromProcess=function(t){new a.UnimplementedMethodException("addStepFromProcess","WorkflowModel")},e.prototype.getNextAvailableId=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=this.graph);var i=!0,r=t,o=[];for(-1!==t.indexOf("/")&&e&&(o=r.split("/"));i;)e?(i=n.hasVertex(["in",o[1],o[2]].join("/"))||n.hasVertex(["out",o[1],o[2]].join("/")))&&(o=[o[0],u.incrementString(o[1]),u.incrementString(o[2])],r=o.join("/")):(i=n.hasVertex(r))&&(r=u.incrementString(r));return-1!==r.indexOf("/")?r.split("/")[2]:r},e.prototype.isConnected=function(){try{this.graph||(this.graph=this.constructGraph());var t=this.graph.isConnected();return t||this.setIssue((e={},e[this.loc]={message:"Workflow is not connected",type:"warning"},e)),t}catch(t){return this.setIssue((n={},n[this.loc]={message:t,type:"error"},n)),!1}var e,n},e.prototype.hasCycles=function(){try{this.graph||(this.graph=this.constructGraph());var t=this.graph.hasCycles();return t&&this.setIssue((e={},e[this.loc]={message:"Workflow contains cycles",type:"error"},e)),t}catch(t){return this.setIssue((n={},n[this.loc]={message:t,type:"error"},n)),!1}var e,n},e.prototype.gatherValidPorts=function(t,e,n){return e.filter(function(e){try{return u.checkIfConnectionIsValid(t,e,n),!0}catch(t){return!1}})},e.prototype.gatherValidConnectionPoints=function(t){if("string"==typeof t&&(t=this.graph.getVertexData(t)),t instanceof h.WorkflowInputParameterModel||t instanceof v.WorkflowStepOutputModel){var e=this.gatherDestinations();return this.gatherValidPorts(t,e,!0)}var n=this.gatherSources();return this.gatherValidPorts(t,n,!1)},e.prototype.gatherSources=function(){return this.steps.reduce(function(t,e){return t.concat(e.out)},[]).concat(this.inputs)},e.prototype.gatherDestinations=function(){return this.steps.reduce(function(t,e){return t.concat(e.in)},[]).concat(this.outputs)},e.prototype.addStepToGraph=function(t,e){var n=this;void 0===e&&(e=this.graph),this.addVertex(t.id,t,e),t.out.forEach(function(t){n.addVertex(t.connectionId,t,e),e.addEdge({id:t.parentStep.id,type:"Step"},{id:t.connectionId,type:"StepOutput"},!1)}),t.in.forEach(function(t){n.addVertex(t.connectionId,t,e),e.addEdge({id:t.connectionId,type:"StepInput"},{id:t.parentStep.id,type:"Step"},!1)})},e.prototype._createInputFromPort=function(t,e,n,i,o){var s=this;if(void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===o&&(o={}),"string"==typeof t&&(t=this.graph.getVertexData(t)),!t||!this.graph.hasVertex(t.connectionId)){if(!i)throw new Error("WorkflowStepInputModel "+t.destinationId+" does not exist on the graph");this.addVertex(t.connectionId,t),this.addEdge({id:t.connectionId,type:"StepInput"},{id:t.parentStep.id,type:"Step"},!1)}var a=Object.assign((c={id:this.getNextAvailableId(""+r.STEP_OUTPUT_CONNECTION_PREFIX+t.id+"/"+t.id,!0),type:t.type?t.type.serialize():"null"},c["sbg:fileTypes"]=t.fileTypes,c.inputBinding=t.inputBinding,c),o.customProps),u=new e(a,this.loc+".inputs["+this.inputs.length+"]",this.eventHub);return u.setValidationCallback(function(t){return s.updateValidity(t)}),this.inputs.push(u),this.addInputToGraph(u),u.isVisible=n,t.isVisible=n,this.eventHub.emit("input.create",u),this.connect(u,t,n),u;var c},e.prototype._createOutputFromPort=function(t,e,n,i,o){var s=this;if(void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===o&&(o={}),"string"==typeof t&&(t=this.graph.getVertexData(t)),!t||!this.graph.hasVertex(t.connectionId)){if(!i)throw new Error("WorkflowStepInputModel "+t.sourceId+" does not exist on the graph");this.addVertex(t.connectionId,t),this.addEdge({id:t.connectionId,type:"StepInput"},{id:t.parentStep.id,type:"Step"},!1)}var a=Object.assign((c={id:this.getNextAvailableId(""+r.STEP_INPUT_CONNECTION_PREFIX+t.id+"/"+t.id,!0),type:t.type?t.type.serialize():"null"},c["sbg:fileTypes"]=t.fileTypes,c),o.customProps),u=new e(a,this.loc+".outputs["+this.outputs.length+"]",this.eventHub);return u.setValidationCallback(function(t){return s.updateValidity(t)}),this.outputs.push(u),this.addOutputToGraph(u),this.eventHub.emit("output.create",u),t.isVisible=n,this.connect(t,u,n),u;var c},e.prototype.addInputToGraph=function(t,e){void 0===e&&(e=this.graph),this.addVertex(t.connectionId,t,e)},e.prototype.addOutputToGraph=function(t,e){void 0===e&&(e=this.graph),this.addVertex(t.connectionId,t,e)},e.prototype.connectSource=function(t,e,n,i){void 0===i&&(i=this.graph);var r=this.getSourceConnectionId(t),o=i.getVertexData(r);if(void 0===o)return void e.setIssue((u={},u[""+e.loc]={type:"error",message:"Destination id "+e.id+' has unknown source "'+t+'". This may result in a cycle in the graph'},u));var s=!(o instanceof h.WorkflowInputParameterModel&&!o.isVisible);e.isVisible=s;var a=this.validateConnection(e,o,i);i.addEdge({id:o.connectionId,type:this.getNodeType(o)},n,s,a);var u},e.prototype.constructGraph=function(){var t=this,e=this.gatherDestinations(),n=new s.Graph;return this.inputs.forEach(function(e){return t.addInputToGraph(e,n)}),this.outputs.forEach(function(e){return t.addOutputToGraph(e,n)}),this.steps.forEach(function(e){return t.addStepToGraph(e,n)}),e.forEach(function(e){var i={id:e.connectionId,type:t.getNodeType(e)};e.source&&(Array.isArray(e.source)?e.source.forEach(function(r){t.connectSource(r,e,i,n)}):t.connectSource(e.source,e,i,n))}),n},e.prototype.getNodeType=function(t){return t instanceof h.WorkflowInputParameterModel?"WorkflowInput":t instanceof v.WorkflowStepOutputModel?"StepOutput":t instanceof d.StepModel?"Step":t instanceof y.WorkflowStepInputModel?"StepInput":t instanceof f.WorkflowOutputParameterModel?"WorkflowOutput":void 0},e.prototype.getSourceConnectionId=function(t){new a.UnimplementedMethodException("getSourceConnectionId")},e.prototype.validateConnections=function(){var t=this,e=this.gatherSources(),n=this.gatherDestinations();this.connections.forEach(function(i){if(i.isVisible){var r=e.find(function(t){return t.connectionId===i.source.id}),o=n.find(function(t){return t.connectionId===i.destination.id});t.validateConnection(o,r)}})},e.prototype.validateConnection=function(t,e,n){if(void 0===n&&(n=this.graph),e&&t){var i=!1;try{u.checkIfConnectionIsValid(e,t),i=!0}catch(n){var r=t instanceof l.V1WorkflowOutputParameterModel?"outputSource":"source";t.setIssue((o={},o[t.loc+"."+r+"["+e.sourceId+"]"]={message:n.message,type:"warning",code:n.code},o))}return Array.from(n.edges).filter(function(n){return n.isVisible&&n.destination.id===t.connectionId&&n.source.id===e.connectionId}).forEach(function(t){t.isValid=i}),i;var o}},e.prototype.validateDestination=function(t){var e=this;t.clearIssue(m.ErrorCode.CONNECTION_ALL),this.connections.filter(function(e){return e.isVisible&&e.destination.id===t.connectionId}).map(function(t){return e.findById(t.source.id)}).forEach(function(n){e.validateConnection(t,n)})},e.prototype.validateConnectionsForIOPort=function(t){var e=this;if(t instanceof h.WorkflowInputParameterModel){this.connections.filter(function(e){return e.isVisible&&e.source.id===t.connectionId}).map(function(t){return e.findById(t.destination.id)}).forEach(function(t){e.validateDestination(t)})}else this.validateDestination(t);this.eventHub.emit("connections.updated")},e.prototype.validateGraph=function(){try{this.graph.topSort()}catch(n){"Graph has cycles"===n.message?this.setIssue((t={},t[this.loc]={message:"Graph has cycles",type:"error"},t)):"Can't sort unconnected graph"===n&&this.setIssue((e={},e[this.loc]={message:"Graph is not connected",type:"warning"},e))}var t,e},e}(c.ValidationBase);e.WorkflowModel=g},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(3),s=function(t){function e(e){var n=t.call(this,e)||this;return n.customProps={},n}return i(e,t),e.prototype.serialize=function(){return new o.UnimplementedMethodException("serialize","ProcessRequirementModel"),null},e.prototype.deserialize=function(t){new o.UnimplementedMethodException("deserialize","ProcessRequirementModel")},e}(r.ValidationBase);e.ProcessRequirementModel=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(3),s=n(1),a=n(0),u=function(t){function e(e,n){var i=t.call(this,e)||this;return i.eventHub=n,i.customProps={},i}return i(e,t),e.prototype.updateOutputBinding=function(t){new o.UnimplementedMethodException("updateOutputBinding","CommandOutputParameterModel")},e.prototype._addSecondaryFile=function(t,e,n){var i=this,r=a.incrementLastLoc(this.secondaryFiles,n+".secondaryFiles"),o=new e(t,r,this.eventHub);return this.secondaryFiles.push(o),o.setValidationCallback(function(t){return i.updateValidity(t)}),o},e.prototype._updateSecondaryFiles=function(t){var e=this;this.secondaryFiles.forEach(function(t){return t.clearIssue(s.ErrorCode.EXPR_ALL)}),this.secondaryFiles=[],t.forEach(function(t){return e.addSecondaryFile(t)})},e.prototype._removeSecondaryFile=function(t){var e=this.secondaryFiles[t];e&&(e.setValue("","string"),this.secondaryFiles.splice(t,1))},e.prototype.updateLoc=function(e){t.prototype.updateLoc.call(this,e),this.type.updateLoc(e+".type")},e.prototype.validate=function(t){var e=this;this.clearIssue(s.ErrorCode.ALL);var n=[];return n.push(this.outputBinding.validate(t)),n.push(this.type.validate(t)),n.concat(this.secondaryFiles.map(function(e){return e.validate(t)})),Promise.all(n).then(function(){return e.issues})},e.prototype.attachFileTypeListeners=function(){var t=this;this.eventHub&&this.modelListeners.push(this.eventHub.on("io.change.type",function(e){t.loc+".type"===e&&(a.isFileType(t)||(t.updateSecondaryFiles([]),t.outputBinding&&t.outputBinding.setInheritMetadataFrom(null)))}))},e}(r.ValidationBase);e.CommandOutputParameterModel=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(12),o=n(7),s=n(0),a=n(9),u=function(t){function e(e,n,i,r){var o=t.call(this,i)||this;return o.exprConstructor=n,o.eventHub=r,o.customProps={},o.deserialize(e),o}return i(e,t),e.prototype.updateValue=function(t){var e=this;this.value=t,t instanceof a.ExpressionModel&&(this.value.setValidationCallback(function(t){return e.updateValidity(t)}),this.value.loc=this.loc+".value")},e.prototype.serialize=function(){if("Object"!==this.customProps.constructor.name)return this.customProps;var t={};this.class&&(t.class=this.class);var e;return e=this.value instanceof a.ExpressionModel?this.value.serialize():this.value,e&&(t.value=e),Object.assign({},t,this.customProps)},e.prototype.deserialize=function(t){var e=this;if("Object"!==t.constructor.name)return void(this.customProps=t);this.class=t.class,void 0!==t.value&&null!==t.value&&(this.value=t.value,("string"==typeof this.value||this.value.script&&this.exprConstructor===o.SBDraft2ExpressionModel)&&(this.value=new this.exprConstructor(t.value,this.loc+".value",this.eventHub),this.value.setValidationCallback(function(t){return e.updateValidity(t)}))),s.spreadSelectProps(t,this.customProps,["class","value"])},e}(r.ProcessRequirementModel);e.RequirementBaseModel=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(6),s=n(3),a=n(1),u=function(t){function e(e,n){var i=t.call(this,e)||this;return i.fileTypes=[],i.isVisible=!0,i.customProps={},i.eventHub=n,i}return i(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label=t,this.eventHub.emit("io.change",this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sourceId",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectionId",{get:function(){return""+o.STEP_OUTPUT_CONNECTION_PREFIX+this.id+"/"+this.id},enumerable:!0,configurable:!0}),e.prototype.updateLoc=function(e){t.prototype.updateLoc.call(this,e),this.type.updateLoc(e+".type")},e.prototype.serialize=function(){new s.UnimplementedMethodException("serialize","WorkflowInputParameterModel")},e.prototype.deserialize=function(t){new s.UnimplementedMethodException("deserialize","WorkflowInputParameterModel")},e.prototype.validate=function(){var t=this;this.clearIssue(a.ErrorCode.ALL);var e=[];return e.push(this.type.validate()),Promise.all(e).then(function(e){return t.issues})},e}(r.ValidationBase);e.WorkflowInputParameterModel=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(6),s=n(3),a=n(1),u=function(t){function e(e,n){var i=t.call(this,e)||this;return i.fileTypes=[],i.isField=!1,i.isVisible=!0,i.customProps={},i.eventHub=n,i}return i(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label=t,this.eventHub.emit("io.change",this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destinationId",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectionId",{get:function(){return""+o.STEP_INPUT_CONNECTION_PREFIX+this.id+"/"+this.id},enumerable:!0,configurable:!0}),e.prototype.updateLoc=function(e){t.prototype.updateLoc.call(this,e),this.type.updateLoc(e+".type")},e.prototype.serialize=function(){new s.UnimplementedMethodException("serialize","WorkflowOutputParameterModel")},e.prototype.deserialize=function(t){new s.UnimplementedMethodException("deserialize","WorkflowOutputParameterModel")},e.prototype.validate=function(){var t=this;this.clearIssue(a.ErrorCode.ALL);var e=[];return e.push(this.type.validate()),Promise.all(e).then(function(e){return t.issues})},e}(r.ValidationBase);e.WorkflowOutputParameterModel=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.evaluate=function(e,n,i){var r=this;if(void 0===n&&(n={}),"v1.0"===i){if("number"==typeof e)e=e.toString();else if("object"==typeof e)return new Promise(function(t,n){n("Unexpected object type when evaluating v1.0 Expression: "+e)});try{var o=t.grabExpressions(e).map(function(e){switch(e.type){case"func":return t.evaluateExpression("(function() {"+r.libraries.join("\n\n")+"\n\n"+e.value+"})()",n);case"expr":return t.evaluateExpression(r.libraries.join("\n\n")+"\n\n"+e.value,n);case"literal":return new Promise(function(t){return t(e.value)})}});return 1===o.length?o[0]:Promise.all(o).then(function(t){return t.join("")})}catch(t){return new Promise(function(e,n){n(t)})}}else if("draft-2"===i){if("string"==typeof e||"number"==typeof e)return new Promise(function(t){return t(e)});var s="{"===e.script.trim().charAt(0)?"(function()"+e.script+")()":e.script;return t.evaluateExpression(s,n)}},t.evaluateD2=function(e,n){if("string"==typeof e||"number"==typeof e)return new Promise(function(t){return t(e)});var i="{"===e.script.trim().charAt(0)?"(function()"+e.script+")()":e.script;return t.evaluateExpression(i,n)},t.grabExpressions=function(t){for(var e=[],n=0,i=r.LITERAL,o="",s="",a="",u=0,c=0;n<t.length;){var l=t[n];switch(i){case r.LITERAL:"$"===l&&"("===t[n+1]?(o&&(e.push({type:"literal",value:o}),o=""),n++,s="",i=r.EXPR):"$"===l&&"{"===t[n+1]?(o&&(e.push({type:"literal",value:o}),o=""),n++,a="",i=r.FUNC):"\\"===l&&"$"===t[n+1]?(o+="\\$",n++):o+=l;break;case r.EXPR:switch(l){case"(":s+=l,c++;break;case")":0===c?(e.push({type:"expr",value:s}),i=r.LITERAL):(s+=l,c--);break;default:s+=l}break;case r.FUNC:switch(l){case"{":a+=l,u++;break;case"}":0===u?(e.push({type:"func",value:a}),i=r.LITERAL):(a+=l,u--);break;default:a+=l}}n++}return i===r.LITERAL&&o.length>0&&e.push({type:"literal",value:o}),i!==r.EXPR&&i!==r.FUNC||(e=[{value:t,type:"literal"}]),e},t.evaluateExpression=null,t.libraries=[],t}();e.ExpressionEvaluator=i;var r;!function(t){t[t.LITERAL=0]="LITERAL",t[t.FUNC=1]="FUNC",t[t.EXPR=2]="EXPR"}(r||(r={}))},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),s=n(3),a=n(14),u=function(t){function e(e,n){var i=t.call(this,e)||this;return i.isVisible=!0,i.runPath="",i.hints=[],i.customProps={},i.eventHub=n,i}return i(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label=t,this.eventHub.emit("step.change",this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inAsMap",{get:function(){return this.in.reduce(function(t,e){return r({},t,(n={},n[e.id]=e,n));var n},{})},enumerable:!0,configurable:!0}),e.prototype.setRunProcess=function(t){new s.UnimplementedMethodException("setRunProcess","StepModel")},Object.defineProperty(e.prototype,"connectionId",{get:function(){return this.id},enumerable:!0,configurable:!0}),e.prototype.compareInPorts=function(t){void 0===t&&(t=!1)},e.prototype.compareOutPorts=function(t){void 0===t&&(t=!1)},e.prototype.serializeEmbedded=function(){new s.UnimplementedMethodException("serializeEmbedded","StepModel")},e.prototype.addHint=function(t){return new s.UnimplementedMethodException("addHint","WorkflowModel"),null},e.prototype.createReq=function(t,e,n,i){var r=this;void 0===i&&(i=!1);var o,s=i?"hints":"requirements";return n=n||this.loc+"."+s+"["+this[s].length+"]",o=new a.RequirementBaseModel(t,e,n),o.isHint=i,this[s].push(o),o.setValidationCallback(function(t){return r.updateValidity(t)}),o},e.prototype.serialize=function(){new s.UnimplementedMethodException("serialize","StepModel")},e.prototype.deserialize=function(t){new s.UnimplementedMethodException("deserialize","StepModel")},e.portDifference=function(t,e){for(var n=[],i=[],r=t.slice(),o=0;o<e.length;o++)!function(t){var o=r.findIndex(function(n){return n.id===e[t].id});-1===o?n.push(e[t]):i=i.concat(r.splice(o,1))}(o);return[n,i,r]},e}(o.ValidationBase);e.StepModel=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(3),s=n(6),a=function(t){function e(e){var n=t.call(this,e)||this;return n.source=[],n.fileTypes=[],n.isVisible=!1,n.customProps={},n}return i(e,t),Object.defineProperty(e.prototype,"connectionId",{get:function(){return""+s.STEP_INPUT_CONNECTION_PREFIX+this.parentStep.id+"/"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destinationId",{get:function(){return this.parentStep.id+"/"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this.isVisible?"port":this.source.length?1===this.source.length?"exposed":void 0:"editable"},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){new o.UnimplementedMethodException("serialize")},e.prototype.deserialize=function(t){new o.UnimplementedMethodException("deserialize")},e}(r.ValidationBase);e.WorkflowStepInputModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(3),s=n(6),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fileTypes=[],e.customProps={},e.isVisible=!0,e}return i(e,t),e.prototype.serialize=function(){new o.UnimplementedMethodException("serialize")},e.prototype.deserialize=function(t){new o.UnimplementedMethodException("deserialize")},Object.defineProperty(e.prototype,"sourceId",{get:function(){return this.parentStep.id+"/"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectionId",{get:function(){return""+s.STEP_OUTPUT_CONNECTION_PREFIX+this.parentStep.id+"/"+this.id},enumerable:!0,configurable:!0}),e}(r.ValidationBase);e.WorkflowStepOutputModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(80),o=n(42),s=n(23),a=n(3),u=n(0),c=n(1),l=n(2),p=n(10),d=n(13),h=function(t){function e(e){var n=t.call(this,e||"document")||this;return n.class="CommandLineTool",n.baseCommand=[],n.inputs=[],n.outputs=[],n.arguments=[],n.requirements=[],n.hints=[],n.successCodes=[],n.temporaryFailCodes=[],n.permanentFailCodes=[],n.expressions=new Set,n.validationPromises=[],n.jobInputs={},n.runtime={},n.constructed=!1,n.customProps={},n.commandLineWatcher=function(){},n.eventHub=new o.EventHub(["input.create","input.remove","input.change","input.change.id","io.change.type","output.create","output.remove","output.change.id","argument.create","argument.remove","field.create","field.remove","validate","binding.shellQuote","expression.create","expression.change","expression.serialize","output.metadata.inherit"]),n}return i(e,t),e.prototype.setJobInputs=function(t){this.jobInputs=t||s.JobHelper.getNullJobInputs(this),this.validateAllExpressions(),this.updateCommandLine()},e.prototype.on=function(t,e){return{dispose:this.eventHub.on(t,e)}},e.prototype.off=function(t,e){this.eventHub.off(t,e)},e.prototype.initializeJobWatchers=function(){var t=this;this.eventHub.on("input.change.id",function(e){var n=t.jobInputs;if(e.port.isField&&(n=t.findFieldRoot(e.port,n),Array.isArray(n)))return void n.forEach(function(t){t[e.newId]=t[e.oldId]||s.JobHelper.generateMockJobData(e.port),delete t[e.oldId]});n[e.newId]=n[e.oldId]||s.JobHelper.generateMockJobData(e.port),delete n[e.oldId],t.updateCommandLine()}),this.eventHub.on("io.change.type",function(e){if(0===e.search(t.loc)&&e.search("inputs")>-1){e=e.substr(t.loc.length).replace(/type$/,"");var n=u.fetchByLoc(t,e);if(!n)return;var i=t.jobInputs;if(n.isField&&(i=t.findFieldRoot(n,i),Array.isArray(i))){for(var r=0;r<i.length;r++)i[r][n.id]=s.JobHelper.generateMockJobData(n);return void t.updateCommandLine()}i[n.id]=s.JobHelper.generateMockJobData(n),t.updateCommandLine()}}),this.eventHub.on("input.remove",function(e){delete t.jobInputs[e.id],t.updateCommandLine()}),this.eventHub.on("field.remove",function(e){if(e instanceof p.CommandInputParameterModel){var n=t.findFieldRoot(e,t.jobInputs);Array.isArray(n)?n.forEach(function(t){return delete t[e.id]}):delete n[e.id],t.updateCommandLine()}}),this.eventHub.on("input.create",function(e){t.jobInputs[e.id]=s.JobHelper.generateMockJobData(e),t.updateCommandLine()}),this.eventHub.on("field.create",function(e){if(e instanceof p.CommandInputParameterModel){var n=t.findFieldRoot(e,t.jobInputs);if(Array.isArray(n))for(var i=0;i<n.length;i++)n[i][e.id]=s.JobHelper.generateMockJobData(e);else n[e.id]=s.JobHelper.generateMockJobData(e);t.updateCommandLine()}})},e.prototype.initializeExprWatchers=function(){var t=this;this.eventHub.on("expression.create",function(e){t.expressions.add(e),t.constructed&&t.validationPromises.push(t.validateExpression(e))}),this.eventHub.on("expression.change",function(e){t.validationPromises.push(t.validateExpression(e))})},e.prototype.validateExpression=function(t){var e;if(/inputs|outputs/.test(t.loc)){var n=/.*(?:inputs\[\d+]|.*outputs\[\d+]|.*fields\[\d+])/.exec(t.loc)[0].replace("document","");e=u.fetchByLoc(this,n)}return t.validate(this.getContext(e))},e.prototype.validateAllExpressions=function(){var t=this;this.expressions.forEach(function(e){t.validationPromises.push(t.validateExpression(e))})},e.prototype.findFieldRoot=function(t,e){for(var n=!0,i=[],r=t.loc;n;){var o=this.findFieldParent(r);i.unshift({id:o.id,isArray:"array"===o.type.type}),n=o.isField,r=o.loc}var s=function(t,e){if(null===e||void 0===e)return null;if(0===t.length)return e;var n=t[0];return n.isArray?Array.isArray(e[n.id])?u.flatten(e[n.id].map(function(e){return s(t.slice(1),e)})):null:s(t.slice(1),e[n.id])};return s(i,e)},e.prototype.findFieldParent=function(t){return t=t.substr(this.loc.length).replace(/\.type\.fields\[\d+]$/,""),u.fetchByLoc(this,t)},e.prototype.changeIOId=function(t,e){if(t.id!==e){var n,i,r=t.id;t instanceof p.CommandInputParameterModel?n="input":t instanceof d.CommandOutputParameterModel&&(n="output"),t.isField&&(i=this.findFieldParent(t.loc).type.fields),u.checkIdValidity(e,i||this.inputs.concat(this.outputs)),t.clearIssue(c.ErrorCode.ID_ALL),t.id=e,u.isType(t,["record","enum"])&&(t.type.name=e),this.eventHub.emit(n+".change.id",{port:t,oldId:r,newId:t.id})}},e.prototype.addHint=function(t){return new a.UnimplementedMethodException("addHint","CommandLineToolModel"),null},e.prototype.updateStream=function(t,e){new a.UnimplementedMethodException("updateStream","CommandLineToolModel")},e.prototype._addOutput=function(t,e){var n=this;void 0===e&&(e={id:null});var i=u.incrementLastLoc(this.outputs,this.loc+".outputs");e.id=e.id||u.getNextAvailableId("output",this.inputs.concat(this.outputs));var r=new t(e,i,this.eventHub);r.setValidationCallback(function(t){return n.updateValidity(t)});try{u.checkIdValidity(r.id,this.inputs.concat(this.outputs))}catch(t){this.setIssue((o={},o[r.loc+".id"]={type:"error",message:t.message,code:t.code},o))}return this.outputs.push(r),r;var o},e.prototype.addOutput=function(t){return new a.UnimplementedMethodException("addOutput","CommandLineToolModel"),null},e.prototype.removeOutput=function(t){var e=this.outputs.indexOf(t);if(!(e<0)){this.outputs[e].clearIssue(c.ErrorCode.ALL),this.outputs[e].clearListeners(),this.outputs.splice(e,1);for(var n=e;n<this.outputs.length;n++)this.outputs[n].updateLoc(this.loc+".outputs["+n+"]");this.eventHub.emit("output.remove",t)}},e.prototype._addInput=function(t,e){var n=this;void 0===e&&(e={id:null});var i=u.incrementLastLoc(this.inputs,this.loc+".inputs");e.id=e.id||u.getNextAvailableId("input",this.inputs.concat(this.outputs));var r=new t(e,i,this.eventHub);r.setValidationCallback(function(t){return n.updateValidity(t)});try{u.checkIdValidity(r.id,this.inputs.concat(this.outputs))}catch(t){this.setIssue((o={},o[r.loc+".id"]={type:"error",message:t.message,code:t.code},o))}return this.inputs.push(r),this.eventHub.emit("input.create",r),r;var o},e.prototype.addInput=function(t){return new a.UnimplementedMethodException("addInput","CommandLineToolModel"),null},e.prototype.removeInput=function(t){var e=this.inputs.indexOf(t);if(!(e<0)){this.inputs[e].clearIssue(c.ErrorCode.ALL),this.inputs[e].clearListeners(),this.inputs.splice(e,1);for(var n=e;n<this.inputs.length;n++)this.inputs[n].updateLoc(this.loc+".inputs["+n+"]");this.eventHub.emit("input.remove",t)}},e.prototype.addArgument=function(t){return new a.UnimplementedMethodException("addArgument","CommandLineToolModel"),null},e.prototype.removeArgument=function(t){var e=this.arguments.indexOf(t);if(!(e<0)){this.arguments[e].clearIssue(c.ErrorCode.ALL),this.arguments[e].clearListeners(),this.arguments.splice(e,1);for(var n=e;n<this.arguments.length;n++)this.arguments[n].updateLoc(this.loc+".arguments["+n+"]");this.eventHub.emit("argument.remove",t)}},e.prototype.addBaseCommand=function(t){return new a.UnimplementedMethodException("addBaseCommand","CommandLineToolModel"),null},e.prototype.setRequirement=function(t,e){new a.UnimplementedMethodException("setRequirement","CommandLineToolModel")},e.prototype.updateCommandLine=function(){var t=this;this.constructed&&this.generateCommandLineParts().then(function(e){t.commandLineWatcher(e)})},e.prototype.onCommandLineResult=function(t){this.commandLineWatcher=t},e.prototype.generateCommandLine=function(){return this.generateCommandLineParts().then(function(t){return t.filter(function(t){return!!t.value}).map(function(t){return t.value}).join(" ").trim()})},e.prototype.generateCommandLineParts=function(){return r.generateCommandLineParts(this,this.jobInputs,this.runtime)},e.prototype.validate=function(){var t=this;return Promise.all(this.validationPromises).then(function(){t.validationPromises=[]})},e}(l.ValidationBase);e.CommandLineToolModel=h},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(3),s=n(1),a=function(t){function e(e,n){var i=t.call(this,e)||this;return i.eventHub=n,i.hasBinding=!1,i.customProps={},i}return i(e,t),Object.defineProperty(e.prototype,"prefix",{get:function(){return this.binding?this.binding.prefix:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.binding?this.binding.position||0:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"separate",{get:function(){return!this.binding||!1!==this.binding.separate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemSeparator",{get:function(){return this.binding?this.binding.itemSeparator:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueFrom",{get:function(){return this.binding?this.binding.valueFrom:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shellQuote",{get:function(){return this.binding?this.binding.shellQuote:void 0},enumerable:!0,configurable:!0}),e.prototype.toggleBinding=function(t){new o.UnimplementedMethodException("toggleBinding","CommandArgumentModel")},e.prototype.updatePrimitive=function(t){new o.UnimplementedMethodException("updatePrimitive","CommandArgumentModel")},e.prototype.updateBinding=function(t){new o.UnimplementedMethodException("updateBinding","CommandArgumentModel")},e.prototype.toString=function(){return new o.UnimplementedMethodException("toString","CommandArgumentModel"),null},e.prototype.serialize=function(){return new o.UnimplementedMethodException("serialize","CommandArgumentModel"),null},e.prototype.deserialize=function(t){new o.UnimplementedMethodException("deserialize","CommandArgumentModel")},e.prototype.validate=function(t){var e=this;return this.clearIssue(s.ErrorCode.EXPR_ALL),this.hasBinding?this.binding.validate(t):new Promise(function(t){t(e.issues)})},e}(r.ValidationBase);e.CommandArgumentModel=a},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(33),o=n(48),s=function(){function t(){}return t.generateMockJobData=function(e){function n(t,e){return Math.floor(Math.random()*(e-t))+t}function s(t,e){return Math.random()*(e-t)+t}var a=e.type.type,u=e.type.items,c=e.id,l=e.type.symbols,p=e instanceof r.V1CommandInputParameterModel||e instanceof o.V1WorkflowInputParameterModel?"v1.0":"sbg:draft-2",d=function(t){return{path:"/path/to/"+t+".ext",class:"File",size:0,contents:"file contents",secondaryFiles:[]}},h={File:d(c),Directory:{path:"/path/to/"+c,class:"Directory",basename:c},enum:l?l[0]:c,string:c+"-string-value",int:n(0,11),float:s(0,11),boolean:!0,record:{},map:{},array:{File:[d(c+"-1"),d(c+"-2")],Directory:[{path:"/path/to/"+c,class:"Directory",basename:c},{path:"/path/to/"+c,class:"Directory",basename:c}],string:[c+"-string-value-1",c+"-string-value-2"],int:[n(0,11),n(0,11)],float:[s(0,11),s(0,11)],record:[{}],map:[{}],enum:[l?l[0]||"":c||""],boolean:[!0,!0]}},f=h[a];if("array"===a&&(f=f[u],"record"===u&&e.type.fields)){f=[];var y={};e.type.fields.forEach(function(e){y[e.id]=t.generateMockJobData(e)});var v=JSON.parse(JSON.stringify(y)),m=JSON.parse(JSON.stringify(y));f.push(v),f.push(m)}return"record"===a&&e.type.fields&&e.type.fields.forEach(function(e){f[e.id]=t.generateMockJobData(e)}),"File"===a&&"v1.0"===p&&(f=i({},f,{basename:c+".ext",nameroot:c,nameext:".ext"})),void 0!==f?f:null},t.getJobInputs=function(e){var n={};return e.inputs.forEach(function(e){n[e.id]=t.generateMockJobData(e)}),n},t.getNullJobInputs=function(t){var e={};return t.inputs.forEach(function(t){e[t.id]=null}),e},t}();e.JobHelper=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(27),r=n(111),o=n(55),s=n(54),a=function(){function t(t,e){this.dataModel=e,this.position={x:0,y:0},this.dataModel=e,Object.assign(this.position,t)}return t.makeIconFragment=function(t){var e="";return t instanceof i.StepModel&&t.run?"Workflow"===t.run.class?e=this.workflowIconSvg:"CommandLineTool"===t.run.class&&(e=this.toolIconSvg):t instanceof i.WorkflowInputParameterModel&&t.type?e="File"===t.type.type||"array"===t.type.type&&"File"===t.type.items?this.fileInputIconSvg:this.inputIconSvg:t instanceof i.WorkflowOutputParameterModel&&t.type&&(e="File"===t.type.type||"array"===t.type.type&&"File"===t.type.items?this.fileOutputIconSvg:this.outputIconSvg),e},t.makeTemplate=function(e,n){void 0===n&&(n=1);var a=~~(e.customProps&&e.customProps["sbg:x"]),u=~~(e.customProps&&e.customProps["sbg:y"]),c="step";e instanceof i.WorkflowInputParameterModel?c="input":e instanceof i.WorkflowOutputParameterModel&&(c="output");var l=(e.in||[]).filter(function(t){return t.isVisible}),p=(e.out||[]).filter(function(t){return t.isVisible}),d=Math.max(l.length,p.length),h=t.radius+d*s.IOPort.radius,f="",y="";e.type&&(f="type-"+e.type.type,e.type.items&&(y="items-"+e.type.items));var v=l.sort(function(t,e){return-t.id.localeCompare(e.id)}).map(function(e,n,i){return t.makePortTemplate(e,"input",o.SVGUtils.matrixToTransformAttr(t.createPortMatrix(i.length,n,h,"input")))}).reduce(function(t,e){return t+e},""),m=p.sort(function(t,e){return-t.id.localeCompare(e.id)}).map(function(e,n,i){return t.makePortTemplate(e,"output",o.SVGUtils.matrixToTransformAttr(t.createPortMatrix(i.length,n,h,"output")))}).reduce(function(t,e){return t+e},"");return'\n            <g tabindex="-1" class="node '+c+" "+f+" "+y+'"\n               data-connection-id="'+e.connectionId+'"\n               transform="matrix(1, 0, 0, 1, '+a+", "+u+')"\n               data-id="'+e.id+'">\n               \n                <g class="core" transform="matrix(1, 0, 0, 1, 0, 0)">\n                    <circle cx="0" cy="0" r="'+h+'" class="outer"></circle>\n                    <circle cx="0" cy="0" r="'+.75*h+'" class="inner"></circle>\n                    \n                    '+t.makeIconFragment(e)+'\n                </g>\n                \n                <text transform="matrix('+n+",0,0,"+n+",0,"+(h+30)+')" class="title label">'+r.HtmlUtils.escapeHTML(e.label||e.id)+"</text>\n                \n                "+v+"\n                "+m+"\n            </g>\n        "},t.makePortTemplate=function(t,e,n){void 0===n&&(n="matrix(1, 0, 0, 1, 0, 0)");var i="input"===e?"input-port":"output-port",r=t.label||t.id;return'\n            <g class="port '+i+'" transform="'+(n||"matrix(1, 0, 0, 1, 0, 0)")+'"\n               data-connection-id="'+t.connectionId+'"\n               data-port-id="'+t.id+'"\n            >\n                <g class="io-port">\n                    <circle cx="0" cy="0" r="7" class="port-handle"></circle>\n                </g>\n                <text x="0" y="0" transform="matrix(1,0,0,1,0,0)" class="label unselectable">'+r+"</text>\n            </g>\n            \n        "},t.createPortMatrix=function(t,e,n,i){var r=140*(e+1)/(t+1)-70;return"input"===i&&(r=250-140*(e+1)/(t+1)),o.SVGUtils.createMatrix().rotate(r).translate(n,0).rotate(-r)},t.patchModelPorts=function(t){var e=[{connectionId:t.connectionId,isVisible:!0,id:t.id}];if(t instanceof i.WorkflowInputParameterModel){var n=Object.create(t);return Object.assign(n,{out:e})}if(t instanceof i.WorkflowOutputParameterModel){var n=Object.create(t);return Object.assign(n,{in:e})}return t},t.radius=30,t.workflowIconSvg='<svg class="node-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400.01 399.88" x="-9" y="-10" width="20" height="20"><title>workflow</title><path d="M400,200a80,80,0,0,1-140.33,52.53L158.23,303.24a80,80,0,1,1-17.9-35.77l101.44-50.71a80.23,80.23,0,0,1,0-33.52L140.33,132.53a79.87,79.87,0,1,1,17.9-35.77l101.44,50.71A80,80,0,0,1,400,200Z" transform="translate(0.01 -0.16)"/></svg>',t.toolIconSvg='<svg class="node-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 398.39 397.78" x="-10" y="-8" width="20" height="15"><title>tool2</title><polygon points="38.77 397.57 0 366 136.15 198.78 0 31.57 38.77 0 200.63 198.78 38.77 397.57"/><rect x="198.39" y="347.78" width="200" height="50"/></svg>',t.fileInputIconSvg='<svg class="node-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 499 462.86" y="-10" x="-11" width="20" height="20"><title>file_input</title><path d="M386.06,0H175V58.29l50,50V50H337.81V163.38h25l86.19.24V412.86H225V353.71l-50,50v59.15H499V112.94Zm1.75,113.45v-41l41.1,41.1Z"/><polygon points="387.81 1.06 387.81 1.75 387.12 1.06 387.81 1.06"/><polygon points="290.36 231 176.68 344.68 141.32 309.32 194.64 256 0 256 0 206 194.64 206 142.32 153.68 177.68 118.32 290.36 231"/></svg>',t.fileOutputIconSvg='<svg class="node-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 499 462.86" x="-7" y="-11" width="20" height="20"><title>file_output</title><polygon points="387.81 1.06 387.81 1.75 387.12 1.06 387.81 1.06"/><polygon points="499 231 385.32 344.68 349.96 309.32 403.28 256 208.64 256 208.64 206 403.28 206 350.96 153.68 386.32 118.32 499 231"/><path d="M187.81,163.38l77.69.22H324V112.94L211.06,0H0V462.86H324V298.5H274V412.86H50V50H162.81V163.38Zm25-90.92,41.1,41.1-41.1-.11Z"/></svg>',t.inputIconSvg='<svg class="node-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 499 365" x="-11" y="-10" width="20" height="20"><title>type_input</title><g id="input"><path d="M316.5,68a181.72,181.72,0,0,0-114.12,40.09L238,143.72a132.5,132.5,0,1,1,1.16,214.39L203.48,393.8A182.5,182.5,0,1,0,316.5,68Z" transform="translate(0 -68)"/><g id="Layer_22" data-name="Layer 22"><g id="Layer_9_copy_4" data-name="Layer 9 copy 4"><polygon points="290.36 182 176.68 295.68 141.32 260.32 194.64 207 0 207 0 157 194.64 157 142.32 104.68 177.68 69.32 290.36 182"/></g></g></g></svg>',t.outputIconSvg='<svg class="node-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500.36 365" x="-9" y="-10" width="20" height="20"><title>type_output</title><g id="output"><path d="M291.95,325.23a134,134,0,0,1-15.76,19,132.5,132.5,0,1,1,0-187.38,133.9,133.9,0,0,1,16.16,19.55l35.81-35.81A182.5,182.5,0,1,0,327.73,361Z" transform="translate(0 -68)"/><g id="circle_source_copy" data-name="circle source copy"><g id="Layer_22_copy" data-name="Layer 22 copy"><g id="Layer_9_copy_5" data-name="Layer 9 copy 5"><polygon points="500.36 182 386.68 295.68 351.32 260.32 404.64 207 210 207 210 157 404.64 157 352.32 104.68 387.68 69.32 500.36 182"/></g></g></g></g></svg>',t}();e.GraphNode=a},function(t,e){function n(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var o=i(r);return[n].concat(r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"})).concat([o]).join("\n")}return[n].join("\n")}function i(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i=n(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<t.length;r++){var s=t[r];"number"==typeof s[0]&&i[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),e.push(s))}},e}},function(t,e,n){function i(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=f[i.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](i.parts[o]);for(;o<i.parts.length;o++)r.parts.push(l(i.parts[o],e))}else{for(var s=[],o=0;o<i.parts.length;o++)s.push(l(i.parts[o],e));f[i.id]={id:i.id,refs:1,parts:s}}}}function r(t,e){for(var n=[],i={},r=0;r<t.length;r++){var o=t[r],s=e.base?o[0]+e.base:o[0],a=o[1],u=o[2],c=o[3],l={css:a,media:u,sourceMap:c};i[s]?i[s].parts.push(l):n.push(i[s]={id:s,parts:[l]})}return n}function o(t,e){var n=v(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=b[b.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),b.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function s(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=b.indexOf(t);e>=0&&b.splice(e,1)}function a(t){var e=document.createElement("style");return t.attrs.type="text/css",c(e,t.attrs),o(t,e),e}function u(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",c(e,t.attrs),o(t,e),e}function c(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function l(t,e){var n,i,r,o;if(e.transform&&t.css){if(!(o=e.transform(t.css)))return function(){};t.css=o}if(e.singleton){var c=g++;n=m||(m=a(e)),i=p.bind(null,n,c,!1),r=p.bind(null,n,c,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=u(e),i=h.bind(null,n,e),r=function(){s(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(e),i=d.bind(null,n),r=function(){s(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}function p(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=w(e,r);else{var o=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function d(t,e){var n=e.css,i=e.media;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function h(t,e,n){var i=n.css,r=n.sourceMap,o=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||o)&&(i=_(i)),r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var s=new Blob([i],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}var f={},y=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),v=function(t){var e={};return function(n){return void 0===e[n]&&(e[n]=t.call(this,n)),e[n]}}(function(t){return document.querySelector(t)}),m=null,g=0,b=[],_=n(72);t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},e.attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=y()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=r(t,e);return i(n,e),function(t){for(var o=[],s=0;s<n.length;s++){var a=n[s],u=f[a.id];u.refs--,o.push(u)}if(t){i(r(t,e),e)}for(var s=0;s<o.length;s++){var u=o[s];if(0===u.refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete f[u.id]}}}};var w=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(77)),i(n(104))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(11),r=n(78),o=n(98),s=function(){function t(){}return t.from=function(t,e){if(t instanceof i.WorkflowModel)return t;if(t)switch(t.cwlVersion){case"v1.0":return new r.V1WorkflowModel(t,e);case"sbg:draft-2":case"draft-2":default:return new o.SBDraft2WorkflowModel(t,e)}return new o.SBDraft2WorkflowModel(t,e)},t}();e.WorkflowFactory=s},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=function(){function t(){}return t.resolveType=function(e,n){if(n=n||{type:null,items:null,fields:null,symbols:null,isNullable:!1,isItemOrArray:!1,typeBinding:null,name:null,unionType:null},null===e||void 0===e)return n.isNullable=!0,n;var o=e;"function"==typeof e.serialize&&(o=e.serialize());var s;try{s=JSON.parse(JSON.stringify(o))}catch(t){s=i({},o),console.error(t)}if("string"==typeof s){var a=/(\w+)([\[\]?]+)/g.exec(s);return a?(/\?/.test(a[2])&&(n.isNullable=!0),/\[]/.test(a[2])?(n.type="array",n.items=a[1]):n.type=a[1],n):(n.type=s,n)}if(Array.isArray(s)){var u=s.indexOf("null");if(u>-1&&(n.isNullable=!0,s.splice(u,1)),1!==s.length){if(2!==s.length)throw n.unionType=s,new r.ValidityError("TypeResolverError: Union types not supported yet! Found type "+s,r.ErrorCode.TYPE_UNSUPPORTED);var c=t.resolveType(s[0]),l=t.resolveType(s[1]);if(c.items!==l.type&&l.items!==c.type)throw n.unionType=s,new r.ValidityError("TypeResolverError: Union types not supported yet. Found type "+s,r.ErrorCode.TYPE_UNSUPPORTED);"array"===c.type?s.splice(0,1):s.splice(1,1),n.isItemOrArray=!0}if("string"==typeof s[0])return t.resolveType(s[0],n);if("object"==typeof s[0])return t.resolveType(s[0],n);throw new r.ValidityError("TypeResolverError: expected complex object, instead got "+s[0],r.ErrorCode.TYPE_UNSUPPORTED)}if("object"!=typeof s)throw new r.ValidityError("TypeResolverError: expected complex object, array, or string, instead got "+s,r.ErrorCode.TYPE_UNSUPPORTED);if(!s.type)throw new r.ValidityError("TypeResolverError: expected complex object with type field, instead got "+JSON.stringify(s),r.ErrorCode.TYPE_UNSUPPORTED);switch("array"===n.type?n.items=s.type:n.type=s.type,s.type){case"array":return n.typeBinding=s.inputBinding||null,"string"==typeof s.items?(n.items=s.items,n):Array.isArray(s.items)||"array"===s.items.type?(n.items=s.items,n):t.resolveType(s.items,n);case"record":return n.fields=s.fields,n.name=s.name||null,n;case"enum":return n.symbols=s.symbols,n.name=s.name||null,n;case"string":case"File":case"null":case"boolean":case"int":case"long":case"Directory":case"double":return n;default:throw new r.ValidityError("TypeResolverError: unmatched complex type, expected 'enum', 'array', or 'record', got '"+s.type+"'",r.ErrorCode.TYPE_UNSUPPORTED)}},t.doesTypeMatch=function(t,e){if(t)switch(t){case"int":case"float":case"long":case"double":return"number"==typeof e;case"File":case"record":case"Directory":return"object"==typeof e&&!Array.isArray(e);case"array":return Array.isArray(e);case"enum":return"string"==typeof e;default:return typeof e===t}return!0},t.serializeType=function(t,e){var n;if(t.unionType){var i=t.unionType;"array"===t.type?t.items=i:t.type=i,t.isNullable&&(i.push("null"),t.isNullable=!1)}if(null===t.type||void 0===t.type)return null;switch(t.type){case"array":"enum"===t.items?n={type:"array",items:{type:"enum",name:t.name||"",symbols:t.symbols}}:"record"===t.items?n={type:"array",items:{type:"record",name:t.name||"",fields:t.fields.map(function(t){return"function"==typeof t.serialize?t.serialize():t})}}:"v1.0"!==e||t.typeBinding||"string"!=typeof t.items?(n={type:"array",items:t.items},t.typeBinding&&(n.inputBinding=t.typeBinding)):n=t.items+"[]";break;case"record":n={type:"record",fields:t.fields.map(function(t){return"function"==typeof t.serialize?t.serialize():t}),name:t.name||""},t.typeBinding&&(n.inputBinding=t.typeBinding);break;case"enum":n={type:"enum",symbols:t.symbols,name:t.name||""},t.typeBinding&&(n.inputBinding=t.typeBinding);break;default:n=t.type}if(t.isItemOrArray){var r={type:"array",items:n};return n=[n],n.push(r),t.isNullable&&n.unshift("null"),n}return t.isNullable?n="v1.0"===e&&"string"==typeof n?n+"?":["null",n]:"v1.0"!==e&&(n=[n]),n},t}();e.TypeResolver=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(21),r=n(82),o=n(88),s=function(){function t(){}return t.from=function(t,e){if(t instanceof i.CommandLineToolModel)return t;if(t)switch(t.cwlVersion){case"v1.0":return new r.V1CommandLineToolModel(t,e);case"sbg:draft-2":case"draft-2":default:return new o.SBDraft2CommandLineToolModel(t,e)}return new o.SBDraft2CommandLineToolModel(t,e)},t}();e.CommandLineToolFactory=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n){t=void 0===t?"":t,t=t.toString(),this.value=t.trim(),this.type=e,this.loc=n}return t}();e.CommandLinePart=i},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),s=n(3),a=function(t){function e(e,n){var i=t.call(this,e)||this;return i.eventHub=n,i.customProps={},i}return i(e,t),e.prototype.validate=function(t){var e=this;return new s.UnimplementedMethodException("validate","CommandLineBindingModel"),new Promise(function(t,n){return t(e.issues)})},e.prototype.setValueFrom=function(t){new s.UnimplementedMethodException("setValueFrom","CommandLineBindingModel")},e.prototype.serialize=function(){return new s.UnimplementedMethodException("serialize","CommandLineBindingModel"),null},e.prototype.deserialize=function(t){new s.UnimplementedMethodException("deserialize","CommandLineBindingModel")},e.prototype.cloneStatus=function(t){this.setIssue(r({},t.issues)),this.deserialize(t.serialize())},e}(o.ValidationBase);e.CommandLineBindingModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(10),s=n(4),a=n(0),u=n(47),c=n(5),l=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.secondaryFiles=[],r.hasSecondaryFiles=!0,r.hasSecondaryFilesInRoot=!0,r.hasStageInput=!1,e&&r.deserialize(e),r}return i(e,t),e.prototype.updateInputBinding=function(t){var e=this;t instanceof u.V1CommandLineBindingModel&&(this.inputBinding.cloneStatus(t),this.inputBinding.setValidationCallback(function(t){return e.updateValidity(t)}))},e.prototype.createInputBinding=function(){var t=this;return this.inputBinding=new u.V1CommandLineBindingModel({},this.loc+".inputBinding",this.eventHub),this.inputBinding.setValidationCallback(function(e){return t.updateValidity(e)}),this.inputBinding},e.prototype.addSecondaryFile=function(t){return this._addSecondaryFile(t,c.V1ExpressionModel,this.loc)},e.prototype.updateSecondaryFiles=function(t){this._updateSecondaryFiles(t)},e.prototype.removeSecondaryFile=function(t){this._removeSecondaryFile(t)},e.prototype.serialize=function(){var t=r({},this.customProps);return this.isField?t.name=this.id||"":t.id=this.id||"",t.type=this.type.serialize("v1.0"),this.inputBinding&&(t.inputBinding=this.inputBinding.serialize()),this.label&&(t.label=this.label),this.description&&(t.doc=this.description),this.fileTypes.length&&!this.isField&&(t["sbg:fileTypes"]=this.fileTypes.join(", ")),void 0===this.streamable||this.isField||(t.streamable=this.streamable),this.secondaryFiles&&this.secondaryFiles.length&&!this.isField&&(t.secondaryFiles=this.secondaryFiles.map(function(t){return t.serialize()}).filter(function(t){return!!t})),t},e.prototype.deserialize=function(t){var n=this,i=["type","doc","inputBinding","label","secondaryFiles","sbg:fileTypes","streamable"];t.name?(this.id=t.name,this.isField=!0,i.push("name")):(this.id=t.id,i.push("id")),this.type=new s.ParameterTypeModel(t.type,e,this.id+"_field",this.loc+".type",this.eventHub),this.type.setValidationCallback(function(t){return n.updateValidity(t)}),this.type.hasDirectoryType=!0,a.isType(this,["record","enum"])&&!this.type.name&&(this.type.name=this.id),t.inputBinding&&(this.inputBinding=new u.V1CommandLineBindingModel(t.inputBinding,this.loc+".inputBinding",this.eventHub),this.inputBinding.setValidationCallback(function(t){return n.updateValidity(t)})),this.label=t.label,this.description=a.ensureArray(t.doc).join("\n"),this.secondaryFiles=a.ensureArray(t.secondaryFiles).map(function(t){return n.addSecondaryFile(t)}),this.fileTypes=a.commaSeparatedToArray(t["sbg:fileTypes"]),this.streamable=t.streamable,this.attachFileTypeListeners(),a.spreadSelectProps(t,this.customProps,i)},e}(o.CommandInputParameterModel);e.V1CommandInputParameterModel=l},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(12),o=n(0),s=function(t){function e(e,n){var i=t.call(this,n)||this;return i.class="DockerRequirement",i.customProps={},i.serializedKeys=["class","dockerFile","dockerImageId","dockerLoad","dockerOutputDirectory","dockerPull"],e&&i.deserialize(e),i}return i(e,t),e.prototype.serialize=function(){var t=this,e={};this.serializedKeys.forEach(function(n){t[n]&&(e[n]=t[n])});var n=Object.keys(e),i=Object.keys(this.customProps);if(1!==n.length||"class"!==n[0]||0!==i.length)return o.spreadAllProps(e,this.customProps)},e.prototype.deserialize=function(t){var e=this;this.serializedKeys.forEach(function(n){e[n]=t[n]}),this.class="DockerRequirement",o.spreadSelectProps(t,this.customProps,this.serializedKeys)},e}(r.ProcessRequirementModel);e.DockerRequirementModel=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(1),s=function(t){function e(e,n){var i=t.call(this,e)||this;return i.eventHub=n,i.customProps={},i}return i(e,t),e.prototype.setGlob=function(t,e){var n=this,i=t.serialize();this._glob.clearIssue(o.ErrorCode.ALL),this._glob=new e(i,this.loc+".glob",this.eventHub),this._glob.setValidationCallback(function(t){return n.updateValidity(t)}),this.validateGlob()},e.prototype.validateGlob=function(){if(this._glob){void 0===this._glob.serialize()?this._glob.setIssue((t={},t[this.loc+".glob"]={message:"Glob should be specified",type:"warning",code:o.ErrorCode.OUTPUT_GLOB_MISSING},t),!0):this._glob.clearIssue(o.ErrorCode.OUTPUT_GLOB_MISSING);var t}},e.prototype.setOutputEval=function(t,e){var n=this;this._outputEval&&this._outputEval.clearIssue(o.ErrorCode.ALL),this._outputEval=new e(t.serialize(),this.loc+".outputEval",this.eventHub),this._outputEval.setValidationCallback(function(t){return n.updateValidity(t)})},e}(r.ValidationBase);e.CommandOutputBindingModel=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),o=n(12),s=n(1),a=function(t){function e(e,n){var i=t.call(this,e)||this;return i.eventHub=n,i}return i(e,t),e.prototype.addDirent=function(t){return new r.UnimplementedMethodException("addDirent","CreateFileRequirementModel"),null},e.prototype.addExpression=function(t){return new r.UnimplementedMethodException("addExpression","CreateFileRequirementModel"),null},e.prototype.validate=function(t){var e=this;return this.clearIssue(s.ErrorCode.ALL),Promise.all(this.listing.map(function(e){return e.validate(t)})).then(function(){return e.issues},function(){return e.issues})},e}(o.ProcessRequirementModel);e.CreateFileRequirementModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(3),s=n(1),a=function(t){function e(e,n){var i=t.call(this,e)||this;return i.eventHub=n,i.customProps={},i}return i(e,t),e.prototype.serialize=function(){return new o.UnimplementedMethodException("serialize","DirentModel"),null},e.prototype.deserialize=function(t){new o.UnimplementedMethodException("deserialize","DirentModel")},e.prototype.validate=function(t){return this.clearIssue(s.ErrorCode.ALL),Promise.all([this.entry.validate(t),this.entryName.validate(t)])},e}(r.ValidationBase);e.DirentModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(12),o=function(t){function e(e,n){var i=t.call(this,e)||this;return i.eventHub=n,i.class="ResourceRequirement",i}return i(e,t),e}(r.ProcessRequirementModel);e.ResourceRequirementModel=o},function(t,e,n){"use strict";var i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},r=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(109),a=n(110),u=n(40),c=n(24),l=n(56),p=n(57),d=function(){function t(t){var e=this;this.svgID=this.makeID(),this.minScale=.2,this.maxScale=2,this.editingEnabled=!0,this.labelScale=1,this.plugins=[],this.handlersThatCanBeDisabled=[],this.disposers=[],this.pendingFirstDraw=!0,this._scale=1,this.svgRoot=t.svgRoot,this.plugins=t.plugins||[],this.domEvents=new s.DomEvents(this.svgRoot),this.model=t.model,this.editingEnabled=!1!==t.editingEnabled,this.svgRoot.classList.add(this.svgID),this.svgRoot.innerHTML='\n            <rect x="0" y="0" width="100%" height="100%" class="pan-handle" transform="matrix(1,0,0,1,0,0)"></rect>\n            <g class="workflow" transform="matrix(1,0,0,1,0,0)"></g>\n        ',this.workflow=this.svgRoot.querySelector(".workflow"),this.invokePlugins("registerWorkflow",this),this.eventHub=new a.EventHub(["connection.create","app.create.step","app.create.input","app.create.output","beforeChange","afterChange","afterRender","selectionChange"]),this.hookPlugins(),this.draw(t.model),this.eventHub.on("afterRender",function(){return e.invokePlugins("afterRender")})}return Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(t){this.workflowBoundingClientRect=this.svgRoot.getBoundingClientRect();var e=(this.workflowBoundingClientRect.right+this.workflowBoundingClientRect.left)/2,n=(this.workflowBoundingClientRect.top+this.workflowBoundingClientRect.bottom)/2;this.scaleAtPoint(t,e,n)},enumerable:!0,configurable:!0}),t.canDrawIn=function(t){return 0!==t.getBoundingClientRect().width},t.makeConnectionPath=function(t,e,n,i,r){if(void 0===r&&(r="right"),!r)return"M "+t+" "+e+" C "+(t+n)/2+" "+e+" "+(t+n)/2+" "+i+" "+n+" "+i;if("right"===r){var o=t+Math.abs(t-n)/2,s=n-Math.abs(t-n)/2;return"M "+t+" "+e+" C "+o+" "+e+" "+s+" "+i+" "+n+" "+i}if("left"===r){var o=t-Math.abs(t-n)/2,s=n+Math.abs(t-n)/2;return"M "+t+" "+e+" C "+o+" "+e+" "+s+" "+i+" "+n+" "+i}},t.prototype.draw=function(t){var e=this;void 0===t&&(t=this.model);var n=this.workflow.getAttribute("transform");if(this.model!==t||this.pendingFirstDraw){this.pendingFirstDraw=!1,this.model=t;var i=this.model.on("step.change",this.onStepChange.bind(this)),s=this.model.on("step.create",this.onStepCreate.bind(this)),a=this.model.on("step.remove",this.onStepRemove.bind(this)),u=this.model.on("input.create",this.onInputCreate.bind(this)),l=this.model.on("input.remove",this.onInputRemove.bind(this)),p=this.model.on("output.create",this.onOutputCreate.bind(this)),d=this.model.on("output.remove",this.onOutputRemove.bind(this)),h=this.model.on("step.inPort.show",this.onInputPortShow.bind(this)),f=this.model.on("step.inPort.hide",this.onInputPortHide.bind(this)),y=this.model.on("connection.create",this.onConnectionCreate.bind(this)),v=this.model.on("connection.remove",this.onConnectionRemove.bind(this)),m=this.model.on("step.outPort.create",this.onOutputPortCreate.bind(this)),g=this.model.on("step.outPort.remove",this.onOutputPortRemove.bind(this));this.disposers.push(function(){i.dispose(),s.dispose(),a.dispose(),u.dispose(),l.dispose(),p.dispose(),d.dispose(),h.dispose(),f.dispose(),y.dispose(),v.dispose(),m.dispose(),g.dispose()}),this.invokePlugins("afterModelChange")}this.clearCanvas();var b=r(this.model.steps,this.model.inputs,this.model.outputs).filter(function(t){return t.isVisible}),_="";try{for(var w=o(b),P=w.next();!P.done;P=w.next()){var E=P.value,O=c.GraphNode.patchModelPorts(E),C=isNaN(parseInt(O.customProps["sbg:x"])),M=isNaN(parseInt(O.customProps["sbg:y"]));(C||M)&&!0,_+=c.GraphNode.makeTemplate(O)}}catch(t){S={error:t}}finally{try{P&&!P.done&&(x=w.return)&&x.call(w)}finally{if(S)throw S.error}}this.workflow.innerHTML+=_,this.redrawEdges(),Array.from(this.workflow.querySelectorAll(".node")).forEach(function(t){e.workflow.appendChild(t)}),this.addEventListeners(),this.workflow.setAttribute("transform",n),this.scaleAtPoint(this.scale),this.invokePlugins("afterRender");var S,x},t.prototype.findParent=function(t,e){void 0===e&&(e="node");for(var n=t;n;){if(n.classList.contains(e))return n;n=n.parentElement}},t.prototype.getPlugin=function(t){return this.plugins.find(function(e){return e instanceof t})},t.prototype.on=function(t,e){this.eventHub.on(t,e)},t.prototype.off=function(t,e){this.eventHub.off(t,e)},t.prototype.fitToViewport=function(t){void 0===t&&(t=!1),this.scaleAtPoint(1),Object.assign(this.workflow.transform.baseVal.getItem(0).matrix,{e:0,f:0});var e=this.svgRoot.getBoundingClientRect(),n=this.workflow.getBoundingClientRect();if(0===e.width||0===e.height)throw new Error("Cannot fit workflow to the area that has no visible viewport.");var i=n.height/(e.height-100),r=n.width/(e.width-100),o=Math.max(i,r),s=Math.min(this.scale/o,1);t||(s=Math.max(s,this.minScale)),this.scaleAtPoint(s);var a=this.workflow.getBoundingClientRect(),u=e.top-a.top+Math.abs(e.height-a.height)/2,c=e.left-a.left+Math.abs(e.width-a.width)/2,l=this.workflow.transform.baseVal.getItem(0).matrix;l.e+=c,l.f+=u},t.prototype.redrawEdges=function(){var t=this,e=new Set;Array.from(this.workflow.querySelectorAll(".edge")).forEach(function(t){if(t.classList.contains("highlighted")){var n=t.attributes["data-source-connection"].value+t.attributes["data-destination-connection"].value;e.add(n)}t.remove()});var n=this.model.connections.map(function(n){var i=n.source.id+n.destination.id,r=e.has(i)?"highlighted":"";return u.Edge.makeTemplate(n,t.workflow,r)}).reduce(function(t,e){return t+e},"");this.workflow.innerHTML=n+this.workflow.innerHTML},t.prototype.scaleAtPoint=function(t,e,n){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),this._scale=t,this.labelScale=1+(1-this._scale)/(2*this._scale);var i=this.workflow.transform.baseVal,r=i.getItem(0).matrix,s=this.transformScreenCTMtoCanvas(e,n);r.e+=r.a*s.x,r.f+=r.a*s.y,r.a=r.d=t,r.e-=t*s.x,r.f-=t*s.y;var a=this.workflow.querySelectorAll(".node .label");try{for(var u=o(a),c=u.next();!c.done;c=u.next()){var l=c.value,p=l.transform.baseVal.getItem(0).matrix;Object.assign(p,{a:this.labelScale,d:this.labelScale})}}catch(t){d={error:t}}finally{try{c&&!c.done&&(h=u.return)&&h.call(u)}finally{if(d)throw d.error}}var d,h},t.prototype.transformScreenCTMtoCanvas=function(t,e){var n=this.svgRoot,i=this.workflow.getScreenCTM(),r=n.createSVGPoint();r.x=t,r.y=e;var o=r.matrixTransform(i.inverse());return{x:o.x,y:o.y}},t.prototype.enableEditing=function(t){this.invokePlugins("onEditableStateChange",t),this.editingEnabled=t},t.prototype.destroy=function(){this.svgRoot.classList.remove(this.svgID),this.clearCanvas(),this.eventHub.empty(),this.invokePlugins("destroy");try{for(var t=o(this.disposers),e=t.next();!e.done;e=t.next()){(0,e.value)()}}catch(t){n={error:t}}finally{try{e&&!e.done&&(i=t.return)&&i.call(t)}finally{if(n)throw n.error}}var n,i},t.prototype.resetTransform=function(){this.workflow.setAttribute("transform","matrix(1,0,0,1,0,0)"),this.scaleAtPoint()},t.prototype.addEventListeners=function(){var t,e,n,i,r=this;this.domEvents.drag(".pan-handle",function(t,r){i.e=e+t,i.f=n+r},function(r,o,s){t=s.querySelector(".workflow"),i=t.transform.baseVal.getItem(0).matrix,e=i.e,n=i.f},function(){t=void 0,i=void 0}),this.domEvents.on("mouseover",".node",function(t,e,n){r.workflow.querySelector(".edge.dragged")||e.parentElement.appendChild(e)})},t.prototype.clearCanvas=function(){this.domEvents.detachAll(),this.workflow.innerHTML="",this.workflow.setAttribute("transform","matrix(1,0,0,1,0,0)"),this.workflow.setAttribute("class","workflow")},t.prototype.hookPlugins=function(){var t=this;this.plugins.forEach(function(e){e.registerOnBeforeChange(function(e){t.eventHub.emit("beforeChange",e)}),e.registerOnAfterChange(function(e){t.eventHub.emit("afterChange",e)}),e.registerOnAfterRender(function(e){t.eventHub.emit("afterRender",e)})})},t.prototype.invokePlugins=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.plugins.forEach(function(n){"function"==typeof n[t]&&n[t].apply(n,r(e))})},t.prototype.onConnectionCreate=function(t,e){if(t.isVisible&&e.isVisible){var n=t.connectionId,i=e.connectionId;u.Edge.spawnBetweenConnectionIDs(this.workflow,n,i)}},t.prototype.onConnectionRemove=function(t,e){if(t.isVisible&&e.isVisible){var n=t.connectionId,i=e.connectionId;this.svgRoot.querySelector('.edge[data-source-connection="'+n+'"][data-destination-connection="'+i+'"').remove()}},t.prototype.onInputCreate=function(t){if(t.isVisible){var e=c.GraphNode.patchModelPorts(t),n=c.GraphNode.makeTemplate(e,this.labelScale),i=p.TemplateParser.parse(n);this.workflow.appendChild(i)}},t.prototype.onOutputCreate=function(t){if(t.isVisible){var e=c.GraphNode.patchModelPorts(t),n=c.GraphNode.makeTemplate(e,this.labelScale),i=p.TemplateParser.parse(n);this.workflow.appendChild(i)}},t.prototype.onStepCreate=function(t){!t.customProps["sbg:x"]&&t.run.customProps&&t.run.customProps["sbg:x"]&&(Object.assign(t.customProps,{"sbg:x":t.run.customProps["sbg:x"],"sbg:y":t.run.customProps["sbg:y"]}),delete t.run.customProps["sbg:x"],delete t.run.customProps["sbg:y"]);var e=c.GraphNode.makeTemplate(t,this.labelScale),n=p.TemplateParser.parse(e);this.workflow.appendChild(n)},t.prototype.onStepChange=function(t){var e=this.workflow.querySelector('.step[data-id="'+t.connectionId+'"] .title');e&&(e.textContent=t.label)},t.prototype.onInputPortShow=function(t){var e=this.svgRoot.querySelector('.step[data-connection-id="'+t.parentStep.connectionId+'"]');new l.StepNode(e,t.parentStep).update()},t.prototype.onInputPortHide=function(t){var e=this.svgRoot.querySelector('.step[data-connection-id="'+t.parentStep.connectionId+'"]');new l.StepNode(e,t.parentStep).update()},t.prototype.onOutputPortCreate=function(t){var e=this.svgRoot.querySelector('.step[data-connection-id="'+t.parentStep.connectionId+'"]');new l.StepNode(e,t.parentStep).update()},t.prototype.onOutputPortRemove=function(t){var e=this.svgRoot.querySelector('.step[data-connection-id="'+t.parentStep.connectionId+'"]');new l.StepNode(e,t.parentStep).update()},t.prototype.onStepRemove=function(t){this.svgRoot.querySelector('.step[data-connection-id="'+t.connectionId+'"]').remove()},t.prototype.onInputRemove=function(t){if(t.isVisible){this.svgRoot.querySelector('.node.input[data-connection-id="'+t.connectionId+'"]').remove()}},t.prototype.onOutputRemove=function(t){if(t.isVisible){this.svgRoot.querySelector('.node.output[data-connection-id="'+t.connectionId+'"]').remove()}},t.prototype.makeID=function(t){void 0===t&&(t=6);for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",i=0;i<t;i++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},t}();e.Workflow=d},function(t,e,n){"use strict";var i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},r=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(53),s=n(54),a=n(39),u=function(){function t(){}return t.makeTemplate=function(t,e,n){if(!t.isVisible||"Step"===t.source.type||"Step"===t.destination.type)return"";var r=i(t.source.id.split("/"),3),o=(r[0],r[1]),s=r[2],u=i(t.destination.id.split("/"),3),c=(u[0],u[1]),l=u[2],p=e.querySelector('.node[data-id="'+o+'"] .output-port[data-port-id="'+s+'"] .io-port'),d=e.querySelector('.node[data-id="'+c+'"] .input-port[data-port-id="'+l+'"] .io-port');if(t.source.type===t.destination.type)return void console.error("Can't update edge between nodes of the same type.",t);if(!p)return void console.error("Source vertex not found for edge "+t.source.id,t);if(!d)return void console.error("Destination vertex not found for edge "+t.destination.id,t);var h=p.getCTM(),f=d.getCTM(),y=e.transform.baseVal[0].matrix,v=a.Workflow.makeConnectionPath((h.e-y.e)/h.a,(h.f-y.f)/h.a,(f.e-y.e)/h.a,(f.f-y.f)/h.a);return'\n            <g tabindex="-1" class="edge '+n+'"\n               data-source-port="'+s+'"\n               data-destination-port="'+l+'"\n               data-source-node="'+o+'"\n               data-source-connection="'+t.source.id+'"\n               data-destination-connection="'+t.destination.id+'"\n               data-destination-node="'+c+'">\n                <path class="sub-edge outer" d="'+v+'"></path>\n                <path class="sub-edge inner" d="'+v+'"></path>\n            </g>\n        '},t.spawn=function(t,e){void 0===t&&(t=""),void 0===e&&(e={});var n=document.createElementNS("http://www.w3.org/2000/svg","g"),r=i((e.source||"//").split("/"),3),o=(r[0],r[1]),s=r[2],a=i((e.destination||"//").split("/"),3),u=(a[0],a[1]),c=a[2];return n.classList.add("edge"),o&&n.classList.add(o),u&&n.classList.add(u),n.setAttribute("tabindex","-1"),n.setAttribute("data-destination-node",u),n.setAttribute("data-destination-port",c),n.setAttribute("data-source-port",s),n.setAttribute("data-source-node",o),n.setAttribute("data-source-connection",e.source),n.setAttribute("data-destination-connection",e.destination),n.innerHTML='\n            <path class="sub-edge outer" d="'+t+'"></path>\n            <path class="sub-edge inner" d="'+t+'"></path>\n        ',n},t.spawnBetweenConnectionIDs=function(e,n,i){if(n.startsWith("in")){var a=n;n=i,i=a}var u=e.querySelector('.port[data-connection-id="'+n+'"]'),c=e.querySelector('.port[data-connection-id="'+i+'"]'),l=o.Geometry.getTransformToElement(u,e),p=o.Geometry.getTransformToElement(c,e),d=s.IOPort.makeConnectionPath(l.e,l.f,p.e,p.f),h=e.querySelector('.edge[data-source-connection="'+n+'"][data-destination-connection="'+i+'"]');if(h){console.log("Updating existing edge");try{for(var f=r(h.querySelectorAll(".sub-edge")),y=f.next();!y.done;y=f.next()){y.value.setAttribute("d",d)}}catch(t){g={error:t}}finally{try{y&&!y.done&&(b=f.return)&&b.call(f)}finally{if(g)throw g.error}}return h}var v=t.spawn(d,{source:n,destination:i}),m=e.querySelector(".node");return e.insertBefore(v,m),v;var g,b},t.findEdge=function(t,e,n){return t.querySelector('[data-source-connection="'+e+'"][data-destination-connection="'+n+'"]')},t.parseConnectionID=function(t){var e=i((t||"//").split("/"),3);return{side:e[0],stepID:e[1],portID:e[2]}},t}();e.Edge=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var s=n(8),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selection=new Map,e.cleanups=[],e.selectionChangeCallbacks=[],e.css={selected:"__selection-plugin-selected",highlight:"__selection-plugin-highlight",fade:"__selection-plugin-fade",plugin:"__plugin-selection"},e}return i(e,t),e.prototype.registerWorkflow=function(e){var n=this;t.prototype.registerWorkflow.call(this,e),this.svg=this.workflow.svgRoot,this.svg.classList.add(this.css.plugin);var i=this.onClick.bind(this);this.svg.addEventListener("click",i),this.cleanups.push(function(){return n.svg.removeEventListener("click",i)})},e.prototype.afterRender=function(){this.restoreSelection()},e.prototype.afterModelChange=function(){"function"==typeof this.detachModelEvents&&this.detachModelEvents(),this.detachModelEvents=this.bindModelEvents()},e.prototype.destroy=function(){this.detachModelEvents(),this.detachModelEvents=void 0,this.svg.classList.remove(this.css.plugin);try{for(var t=r(this.cleanups),e=t.next();!e.done;e=t.next()){(0,e.value)()}}catch(t){n={error:t}}finally{try{e&&!e.done&&(i=t.return)&&i.call(t)}finally{if(n)throw n.error}}var n,i},e.prototype.clearSelection=function(){var t=this.svg.querySelectorAll("."+this.css.selected),e=this.svg.querySelectorAll("."+this.css.highlight);try{for(var n=r(t),i=n.next();!i.done;i=n.next()){var o=i.value;o.classList.remove(this.css.selected)}}catch(t){u={error:t}}finally{try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(u)throw u.error}}try{for(var s=r(e),a=s.next();!a.done;a=s.next()){var o=a.value;o.classList.remove(this.css.highlight)}}catch(t){l={error:t}}finally{try{a&&!a.done&&(p=s.return)&&p.call(s)}finally{if(l)throw l.error}}this.svg.classList.remove(this.css.fade),this.selection.clear(),this.emitChange(null);var u,c,l,p},e.prototype.getSelection=function(){return this.selection},e.prototype.registerOnSelectionChange=function(t){this.selectionChangeCallbacks.push(t)},e.prototype.selectStep=function(t){var e='[data-connection-id="'+t+'"]',n=this.svg.querySelector(e);n&&this.materializeClickOnElement(n)},e.prototype.bindModelEvents=function(){var t=this,e=function(){return t.restoreSelection()},n=[],i=["connection.create","connection.remove"],o=this;try{for(var s=r(i),a=s.next();!a.done;a=s.next()){var u=a.value;!function(t){var i=o.workflow.model.on(t,e);n.push(function(){return i.dispose()})}(u)}}catch(t){c={error:t}}finally{try{a&&!a.done&&(l=s.return)&&l.call(s)}finally{if(c)throw c.error}}return function(){return n.forEach(function(t){return t()})};var c,l},e.prototype.restoreSelection=function(){var t=this;this.selection.forEach(function(n,i){if("node"===n){var r=t.svg.querySelector('[data-connection-id="'+i+'"]');r&&t.selectNode(r)}else if("edge"===n){var s=o(i.split(e.edgePortsDelimiter),2),a=s[0],u=s[1],c='[data-source-connection="'+a+'"][data-destination-connection="'+u+'"]',l=t.svg.querySelector(c);l&&t.selectEdge(l)}})},e.prototype.onClick=function(t){var e=t.target;this.clearSelection(),this.materializeClickOnElement(e)},e.prototype.materializeClickOnElement=function(t){var n;if(n=this.workflow.findParent(t,"node"))this.selectNode(n),this.selection.set(n.getAttribute("data-connection-id"),"node"),this.emitChange(n);else if(n=this.workflow.findParent(t,"edge")){this.selectEdge(n);var i=[n.getAttribute("data-source-connection"),e.edgePortsDelimiter,n.getAttribute("data-destination-connection")].join("");this.selection.set(i,"edge"),this.emitChange(i)}},e.prototype.selectNode=function(t){this.svg.classList.add(this.css.fade),t.classList.add(this.css.selected),t.classList.add(this.css.highlight);var e=t.getAttribute("data-id"),n=this.svg.querySelectorAll('.edge[data-source-node="'+e+'"],.edge[data-destination-node="'+e+'"'),i=this.svg.getElementsByClassName("node")[0];try{for(var o=r(n),s=o.next();!s.done;s=o.next()){var a=s.value;a.classList.add(this.css.highlight),this.workflow.workflow.insertBefore(a,i);var u=a.getAttribute("data-source-node"),c=a.getAttribute("data-destination-node"),l=this.svg.querySelectorAll('.node[data-id="'+u+'"],.node[data-id="'+c+'"]');try{for(var p=r(l),d=p.next();!d.done;d=p.next()){d.value.classList.add(this.css.highlight)}}catch(t){y={error:t}}finally{try{d&&!d.done&&(v=p.return)&&v.call(p)}finally{if(y)throw y.error}}}}catch(t){h={error:t}}finally{try{s&&!s.done&&(f=o.return)&&f.call(o)}finally{if(h)throw h.error}}var h,f,y,v},e.prototype.selectEdge=function(t){t.classList.add(this.css.highlight),t.classList.add(this.css.selected);var e=t.getAttribute("data-source-node"),n=t.getAttribute("data-destination-node"),i=t.getAttribute("data-source-port"),o=t.getAttribute("data-destination-port"),s='.node[data-id="'+n+'"] .input-port[data-port-id="'+o+'"]',a='.node[data-id="'+e+'"] .output-port[data-port-id="'+i+'"]',u=this.svg.querySelectorAll(s+", "+a);try{for(var c=r(u),l=c.next();!l.done;l=c.next()){l.value.classList.add(this.css.highlight)}}catch(t){p={error:t}}finally{try{l&&!l.done&&(d=c.return)&&d.call(c)}finally{if(p)throw p.error}}var p,d},e.prototype.emitChange=function(t){try{for(var e=r(this.selectionChangeCallbacks),n=e.next();!n.done;n=e.next()){(0,n.value)(t)}}catch(t){i={error:t}}finally{try{n&&!n.done&&(o=e.return)&&o.call(e)}finally{if(i)throw i.error}}var i,o},e.edgePortsDelimiter="$!$",e}(s.PluginBase);e.SelectionPlugin=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.handlers=t.reduce(function(t,e){return Object.assign(t,(n={},n[e]=[],n));var n},{})}return t.prototype.on=function(t,e){var n=this;return this.guard(t,"subscribe to"),this.handlers[t].push(e),function(){return n.off(t,e)}},t.prototype.off=function(t,e){return this.guard(t,"unsubscribe from"),this.handlers[t].splice(this.handlers[t].findIndex(function(t){return e===t}),1)},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.guard(t,"emit");for(var i=0;i<this.handlers[t].length;i++)(r=this.handlers[t])[i].apply(r,e);var r},t.prototype.empty=function(){for(var t in this.handlers)this.handlers[t]=[]},t.prototype.guard=function(t,e){if(!this.handlers[t])throw new Error("Cannot "+e+" a non-supported event “"+t+"”. \n            Supported events are: "+Object.keys(this.handlers).join(", ")+"”")},t}();e.EventHub=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(1);!function(t){t[t.CreateVertex=0]="CreateVertex",t[t.IgnoreEdge=1]="IgnoreEdge",t[t.AddEdge=2]="AddEdge",t[t.Error=3]="Error"}(i=e.VertexMissing||(e.VertexMissing={}));var o=function(){function t(t,e,n){if(void 0===n&&(n=i.Error),this.vertices=new Map(t),this.edges=new Set,e)for(var r=0,o=Array.from(e);r<o.length;r++){var s=o[r];this.addEdge({id:s[0]},{id:s[1]},!0,!0,n)}}return t.prototype.addVertex=function(t,e,n){if(void 0===e&&(e=null),this.hasVertex(t)){if(!n)throw new r.ValidityError("Vertex '"+t+"' already exists",r.ErrorCode.ID_DUPLICATE);e=n(this.vertices.get(t))}else this.vertices.set(t,e)},t.prototype.setVertexData=function(t,e){void 0===e&&(e=null),this.throwMissingVertex(t),this.vertices.set(t,e)},t.prototype.getVertexData=function(t){return this.vertices.get(t)},t.prototype.hasVertex=function(t){return this.vertices.has(t)},t.prototype.removeVertex=function(t){return this.vertices.delete(t)},t.prototype.addEdge=function(t,e,n,r,o){switch(void 0===n&&(n=!0),void 0===r&&(r=!0),void 0===o&&(o=i.Error),o){case i.Error:this.throwMissingVertex(t.id),this.throwMissingVertex(e.id);break;case i.CreateVertex:this.addVertex(t.id,null,function(t){return t}),this.addVertex(e.id,null,function(t){return t});break;case i.IgnoreEdge:if(!this.hasVertex(t.id)||!this.hasVertex(e.id))return}this.edges.add({source:t,destination:e,isVisible:n,isValid:r})},t.prototype.removeEdge=function(t){return Array.isArray(t)&&(t={source:{id:t[0]},destination:{id:t[1]}}),this.edges.delete(Array.from(this.edges.values()).find(function(e){return e.source.id===t.source.id&&e.destination.id===t.destination.id}))},t.prototype.topSort=function(){var t=this;if(!this.isConnected())throw"Can't sort unconnected graph";if(0==this.vertices.size)return[];if(1==this.vertices.size)return[this.vertices.keys().next().value];var e=new Set(this.vertices.keys()),n=new Set(this.edges.values()),i=[];n.forEach(function(t){e.delete(t.destination.id)});for(var r=Array.from(e);r.length>0;)!function(){var e=r.shift();i.push(e),n.forEach(function(i){i.source.id==e&&(n.delete(i),t.hasIncoming(i.destination.id,n)||r.push(i.destination.id))})}();if(n.size>0)throw new Error("Graph has cycles");return i},t.prototype.hasOutgoing=function(t,e){void 0===e&&(e=this.edges);for(var n=0,i=Array.from(e);n<i.length;n++){if(i[n].source.id===t)return!0}return!1},t.prototype.hasIncoming=function(t,e){void 0===e&&(e=this.edges);for(var n=0,i=Array.from(e);n<i.length;n++){if(i[n].destination.id==t)return!0}return!1},t.prototype.isConnected=function(){if(0==this.vertices.size||1==this.vertices.size)return!0;if(0==this.edges.size)return!1;var t=new Set(this.vertices.keys()),e=t.values().next().value;t.delete(e);var n=new Set(this.edges);return this.connectedIter(t,n,[e])},t.prototype.connectedIter=function(t,e,n){for(var i=new Set,r=0,o=n;r<o.length;r++)for(var s=o[r],a=0,u=this.reached(e,s);a<u.length;a++){var c=u[a];i.add(c)}for(var l=0,p=Array.from(i);l<p.length;l++){var d=p[l];t.delete(d)||i.delete(d)}return 0==t.size||0!=i.size&&this.connectedIter(t,e,Array.from(i))},t.prototype.reached=function(t,e){for(var n=new Set,i=0,r=Array.from(t);i<r.length;i++){var o=r[i];o.source.id==e?(n.add(o.destination.id),t.delete(o)):o.destination.id==e&&(n.add(o.source.id),t.delete(o))}return Array.from(n)},t.prototype.hasCycles=function(){if(0==this.vertices.size)return!1;if(0==this.edges.size)return!1;try{return this.topSort(),!1}catch(t){return"Graph has cycles"===t.message}},t.prototype.throwMissingVertex=function(t){if(!this.hasVertex(t))throw new Error("Vertex '"+t+"' doesn't exist")},t}();e.Graph=o},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(16),o=n(4),s=n(0),a=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return e&&r.deserialize(e),r}return i(e,t),e.prototype.deserialize=function(t){var n=this,i=["id","name","outputSource","type","label","doc","sbg:fileTypes"];this.isField=!!t.name,this.isField?i.push("name"):i.push("id"),this.isField?this.id=t.name:this.id=t.id,this.isField||(this.source=s.ensureArray(t.outputSource)),this.type=new o.ParameterTypeModel(t.type,e,this.id+"_field",this.loc+".type",this.eventHub),this.type.setValidationCallback(function(t){return n.updateValidity(t)}),this.type.hasDirectoryType=!0,this._label=t.label,this.description=s.ensureArray(t.doc).join("\n\n"),this.isField||(this.fileTypes=s.commaSeparatedToArray(t["sbg:fileTypes"])),s.spreadSelectProps(t,this.customProps,i)},e.prototype.serialize=function(){var t={};return this.isField?t.name=this.id:(t.id=this.id,this.source.length&&(t.outputSource=this.source.slice()),this.fileTypes.length&&(t["sbg:fileTypes"]=this.fileTypes.join(", "))),this.type&&(t.type=this.type.serialize("v1.0")),this._label&&(t.label=this._label),this.description&&(t.doc=this.description),s.spreadAllProps(t,this.customProps)},e}(r.WorkflowOutputParameterModel);e.V1WorkflowOutputParameterModel=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(81),r=n(22),o=n(10),s=n(9),a=function(){function t(){}return t.prepare=function(t,e,n,a,u){var c="primitive";if(t instanceof o.CommandInputParameterModel||"record"===t.type){var l=e[t.id]||null;u="input",null===l?c="nullValue":Array.isArray(l)?c="array":"boolean"==typeof l?c="boolean":"object"==typeof l&&"File"!==l.class&&"Directory"!==l.class&&(c="record")}return t instanceof r.CommandArgumentModel&&(c="argument",u="argument"),t instanceof s.ExpressionModel&&(c="expression"),"stdin"!==u&&"stdout"!==u||(c="stream"),"string"==typeof t&&(c="string"),(0,i.CommandLineParsers[c])(t,e,e[t.id||null],n,u,a)},t.flattenInputsAndArgs=function(e){return e.filter(function(t){return!(t instanceof o.CommandInputParameterModel)||!!t.inputBinding}).reduce(function(e,n,i){var s=function(t,e){var n,o;return s=[t,e].map(function(t){return t instanceof r.CommandArgumentModel?{pos:~~t.position,id:i.toString()}:{pos:~~t.inputBinding.position,id:t.id}}),n=s[0],o=s[1],~~n.pos-~~o.pos||(n.id?n.id.localeCompare(o.id):-1);var s};return n instanceof o.CommandInputParameterModel&&n.type.fields?e.concat.apply(e,[n].concat(t.flattenInputsAndArgs(n.type.fields).sort(s))):e.concat(n).sort(s)},[])},t.flattenJob=function(e,n){return Object.keys(e).reduce(function(i,r){return null===e[r]?Object.assign(n,(o={},o[r]=null,o)):"object"==typeof e[r]&&"File"!==e[r].class?Object.assign(n,(s={},s[r]=e[r],s),t.flattenJob(e[r],{})):Object.assign(n,(a={},a[r]=e[r],a));var o,s,a},{})},t}();e.CommandLinePrepare=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(22),o=n(5),s=n(47),a=n(1),u=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.hasExprPrimitive=!0,r.hasShellQuote=!0,e&&r.deserialize(e),r}return i(e,t),Object.defineProperty(e.prototype,"arg",{get:function(){return this.primitive||this.binding},set:function(t){this.deserialize(t)},enumerable:!0,configurable:!0}),e.prototype.toggleBinding=function(t){var e=this;t?(this.binding=new s.V1CommandLineBindingModel({},this.loc,this.eventHub),this.binding.setValidationCallback(function(t){return e.updateValidity(t)}),this.primitive.clearIssue(a.ErrorCode.ALL),this.primitive=void 0):(this.primitive=new o.V1ExpressionModel("",this.loc,this.eventHub),this.primitive.setValidationCallback(function(t){return e.updateValidity(t)}),this.binding.clearIssue(a.ErrorCode.ALL),this.binding=void 0),this.hasBinding=t},e.prototype.updatePrimitive=function(t){this.hasBinding=!1,this.binding=void 0,this.primitive.setValue(t)},e.prototype.updateBinding=function(t){var e=this;this.binding.prefix=t.prefix,this.binding.position=t.position,this.binding.separate=t.separate,this.binding.itemSeparator=t.itemSeparator,this.binding.shellQuote=t.shellQuote,this.binding.valueFrom=new o.V1ExpressionModel(t.valueFrom,this.loc+".valueFrom"),this.binding.valueFrom.setValidationCallback(function(t){return e.updateValidity(t)}),this.primitive=void 0,this.hasBinding=!0},e.prototype.serialize=function(){return this.binding?this.binding.serialize():this.primitive?this.primitive.serialize():""},e.prototype.toString=function(){return this.primitive?this.primitive.serialize():this.binding?this.binding.valueFrom.toString():void 0},e.prototype.deserialize=function(t){var e=this;"string"==typeof t||t instanceof o.V1ExpressionModel?(this.hasBinding=!1,this.primitive=new o.V1ExpressionModel(t,this.loc,this.eventHub),this.primitive.setValidationCallback(function(t){return e.updateValidity(t)})):t instanceof s.V1CommandLineBindingModel?(this.hasBinding=!0,this.binding=new s.V1CommandLineBindingModel(t.serialize(),this.loc,this.eventHub),this.binding.setValidationCallback(function(t){return e.updateValidity(t)})):"object"==typeof t&&(this.hasBinding=!0,this.binding=new s.V1CommandLineBindingModel(t,this.loc,this.eventHub),this.binding.setValidationCallback(function(t){return e.updateValidity(t)}))},e}(r.CommandArgumentModel);e.V1CommandArgumentModel=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(32),o=n(5),s=n(0),a=n(1),u=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.shellQuote=!0,r.hasSecondaryFiles=!1,r.hasShellQuote=!0,r.serializedKeys=["position","prefix","separate","itemSeparator","valueFrom","shellQuote","loadContents"],e&&r.deserialize(e),r}return i(e,t),e.prototype.setValueFrom=function(t){var e=this;this.valueFrom=new o.V1ExpressionModel(t,this.loc+".valueFrom",this.eventHub),this.valueFrom.setValidationCallback(function(t){return e.updateValidity(t)})},e.prototype.deserialize=function(t){var e=this;this.position=isNaN(t.position)?0:parseInt(t.position),this.prefix=t.prefix,this.separate=!1!==t.separate,this.itemSeparator=t.itemSeparator,this.shellQuote=!1!==t.shellQuote,this.loadContents=!0===t.loadContents,this.valueFrom=new o.V1ExpressionModel(t.valueFrom,this.loc+".valueFrom",this.eventHub),this.valueFrom.setValidationCallback(function(t){return e.updateValidity(t)}),s.spreadSelectProps(t,this.customProps,this.serializedKeys)},e.prototype.serialize=function(){var t=this,e={};return this.serializedKeys.forEach(function(n){void 0!==t[n]&&null!==t[n]&&"valueFrom"!==n&&(e[n]=t[n])}),e.loadContents||delete e.loadContents,!1!==e.shellQuote?delete e.shellQuote:!1===e.shellQuote&&this.eventHub&&this.eventHub.emit("binding.shellQuote",!0),!1!==e.separate&&delete e.separate,void 0!==this.valueFrom.serialize()&&(e.valueFrom=this.valueFrom.serialize()),s.spreadAllProps(e,this.customProps)},e.prototype.validate=function(t){var e=this;this.clearIssue(a.ErrorCode.ALL);var n=[];return n.push(this.valueFrom.validate(t)),Promise.all(n).then(function(){return e.issues})},e}(r.CommandLineBindingModel);e.V1CommandLineBindingModel=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),o=n(4),s=n(0),a=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return e&&r.deserialize(e),r}return i(e,t),e.prototype.deserialize=function(t){var n=this,i=["id","name","type","label","doc","sbg:fileTypes"];this._label=t.label,this.description=s.ensureArray(t.doc).join("\n\n"),this.id=t.id||t.name,this.isField=!!t.name,this.type=new o.ParameterTypeModel(t.type,e,this.id+"_field",this.loc+".type",this.eventHub),this.type.setValidationCallback(function(t){return n.updateValidity(t)}),this.type.hasDirectoryType=!0,this.fileTypes=s.commaSeparatedToArray(t["sbg:fileTypes"]),this.isVisible=!t["sbg:exposed"],s.spreadSelectProps(t,this.customProps,i)},e.prototype.serialize=function(){var t={};return this.isField?t.name=this.id:(t.id=this.id,this.fileTypes.length&&(t["sbg:fileTypes"]=this.fileTypes.join(", "))),this.type.type&&(t.type=this.type.serialize("v1.0")),this._label&&(t.label=this._label),this.description&&(t.doc=this.description),s.spreadAllProps(t,this.customProps)},e}(r.WorkflowInputParameterModel);e.V1WorkflowInputParameterModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(13),o=n(4),s=n(0),a=n(50),u=n(5),c=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.secondaryFiles=[],r.hasSecondaryFiles=!0,r.customProps={},e&&r.deserialize(e),r}return i(e,t),e.prototype.addSecondaryFile=function(t){return void 0===t&&(t=""),this._addSecondaryFile(t,u.V1ExpressionModel,this.loc)},e.prototype.updateSecondaryFiles=function(t){this._updateSecondaryFiles(t)},e.prototype.removeSecondaryFile=function(t){this._removeSecondaryFile(t)},e.prototype.serialize=function(){var t={};return this.isField?t.name=this.id:t.id=this.id,this.description&&(t.doc=this.description),this.label&&(t.label=this.label),t.type=this.type.serialize("v1.0"),this.outputBinding&&(t.outputBinding=this.outputBinding.serialize()),this.isField||!this.secondaryFiles.length||"File"!==this.type.type&&"File"!==this.type.items||(t.secondaryFiles=this.secondaryFiles.map(function(t){return t.serialize()}).filter(function(t){return!!t})),!this.isField&&this.fileTypes.length&&(t["sbg:fileTypes"]=this.fileTypes.join(", ")),!this.isField&&this.streamable&&(t.streamable=this.streamable),s.spreadAllProps(t,this.customProps)},e.prototype.deserialize=function(t){var n=this,i=["id","type","outputBinding","label","doc","secondaryFiles","sbg:fileTypes","streamable"];this.isField=!!t.name,this.id=t.id||t.name,this.type=new o.ParameterTypeModel(t.type,e,this.id+"_field",this.loc+".type",this.eventHub),this.type.setValidationCallback(function(t){return n.updateValidity(t)}),this.type.hasDirectoryType=!0,s.isType(this,["record","enum"])&&!this.type.name&&(this.type.name=this.id),this.outputBinding=new a.V1CommandOutputBindingModel(t.outputBinding,this.loc+".outputBinding",this.eventHub),this.outputBinding.setValidationCallback(function(t){return n.updateValidity(t)}),this.label=t.label,this.description=s.ensureArray(t.doc).join("\n\n"),this.secondaryFiles=s.ensureArray(t.secondaryFiles).map(function(t){return n.addSecondaryFile(t)}),this.fileTypes=s.commaSeparatedToArray(t["sbg:fileTypes"]),this.streamable=t.streamable,this.attachFileTypeListeners(),s.spreadSelectProps(t,this.customProps,i)},e}(r.CommandOutputParameterModel);e.V1CommandOutputParameterModel=c},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(35),o=n(5),s=n(1),a=function(t){function e(e,n,i){void 0===e&&(e={});var r=t.call(this,n,i)||this;return r.hasSecondaryFiles=!1,r.hasMetadata=!1,r.hasInheritMetadata=!0,e&&r.deserialize(e),r}return i(e,t),Object.defineProperty(e.prototype,"glob",{get:function(){return this._glob},set:function(t){this.setGlob(t,o.V1ExpressionModel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputEval",{get:function(){return this._outputEval},set:function(t){!new RegExp(e.INHERIT_REGEX).test(t.serialize())&&this.inheritMetadataFrom&&(this.inheritMetadataFrom=null),this.setOutputEval(t,o.V1ExpressionModel)},enumerable:!0,configurable:!0}),e.prototype.setInheritMetadataFrom=function(t){var n=this._outputEval.serialize();if(t){this.inheritMetadataFrom=t,this.eventHub.emit("output.metadata.inherit");var i="$(inheritMetadata(self, inputs."+t+"))";void 0===n?this._outputEval.setValue(i):(n=n.replace(new RegExp(e.INHERIT_REGEX),""),n&&this._outputEval.setIssue((o={},o[this.loc+".outputEval"]={type:"warning",code:s.ErrorCode.OUTPUT_EVAL_INHERIT,message:"Inheriting metadata appended some code to outputEval, this might change its behavior"},o)),this._outputEval.setValue((n+"\n\n"+i).trim()))}else if(void 0!==n){var r=n.replace(new RegExp(e.INHERIT_REGEX),"");this._outputEval.setValue(r||void 0),this._outputEval.clearIssue(s.ErrorCode.OUTPUT_EVAL_INHERIT),this.inheritMetadataFrom=t}var o},e.prototype.deserialize=function(t){var n=this,i=t.glob;if(Array.isArray(t.glob)&&(i=t.glob[0]),this.loadContents=!0===t.loadContents,this._glob=new o.V1ExpressionModel(i,this.loc+".glob",this.eventHub),this._glob.setValidationCallback(function(t){return n.updateValidity(t)}),this.validateGlob(),this._outputEval=new o.V1ExpressionModel(t.outputEval,this.loc+".outputEval",this.eventHub),this._outputEval.setValidationCallback(function(t){return n.updateValidity(t)}),t.outputEval){var r=new RegExp(e.INHERIT_REGEX).exec(t.outputEval);this.inheritMetadataFrom=r?r[1]:null}},e.prototype.serialize=function(){var t={};return this.loadContents&&(t.loadContents=!0),this._glob&&void 0!==this._glob.serialize()&&(t.glob=this._glob.serialize()),this._outputEval&&void 0!==this._outputEval.serialize()&&(t.outputEval=this._outputEval.serialize()),t},e.INHERIT_REGEX=/\$\(inheritMetadata\(self, inputs.(.*?)\)\)/g,e}(r.CommandOutputBindingModel);e.V1CommandOutputBindingModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(32),o=n(0),s=n(7),a=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.hasSecondaryFiles=!0,r.hasShellQuote=!1,r.serializedKeys=["position","prefix","separate","itemSeparator","valueFrom","loadContents","secondaryFiles"],r.deserialize(e||{}),r}return i(e,t),e.prototype.setValueFrom=function(t){var e=this;this.valueFrom=new s.SBDraft2ExpressionModel(t,this.loc+".valueFrom",this.eventHub),this.valueFrom.setValidationCallback(function(t){return e.updateValidity(t)})},e.prototype.validate=function(t){var e=this,n=[];return this.valueFrom&&n.push(this.valueFrom.validate(t)),Promise.all(n).then(function(){return e.issues},function(t){return console.warn("SBDraft2CommandLineBindingModel threw error in validation: "+t),e.issues})},e.prototype.serialize=function(){var t=this,e={};return this.serializedKeys.forEach(function(n){void 0!==t[n]&&null!==t[n]&&"valueFrom"!==n&&"secondaryFiles"!==n&&(e[n]=t[n])}),e.loadContents||delete e.loadContents,void 0!==this.valueFrom.serialize()&&(e.valueFrom=this.valueFrom.serialize()),o.spreadAllProps(e,this.customProps)},e.prototype.deserialize=function(t){var e=this;t&&t.constructor===Object&&(this.position=isNaN(t.position)?0:parseInt(t.position),this.prefix=t.prefix,this.separate=t.separate,this.itemSeparator=t.itemSeparator,this.loadContents=!0===t.loadContents,this.valueFrom=new s.SBDraft2ExpressionModel(t.valueFrom,this.loc+".valueFrom",this.eventHub),this.valueFrom.setValidationCallback(function(t){return e.updateValidity(t)}),o.spreadSelectProps(t,this.customProps,this.serializedKeys))},e}(r.CommandLineBindingModel);e.SBDraft2CommandLineBindingModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(33),s=n(49),a=n(0),u=function(t){function e(e,n){var i=t.call(this,n)||this;return i.class="ExperssionTool",i.customProps={},e&&i.deserialize(e),i}return i(e,t),e.prototype.serialize=function(){return a.spreadAllProps({},this.customProps)},e.prototype.deserialize=function(t){this.inputs=a.ensureArray(t.inputs,"id","type").map(function(t){return new o.V1CommandInputParameterModel(t)}),this.outputs=a.ensureArray(t.outputs,"id","type").map(function(t){return new s.V1CommandOutputParameterModel(t)}),this.id=t.id,this.label=t.label,this.description=t.doc||t.description,a.spreadSelectProps(t,this.customProps,[])},e}(r.ValidationBase);e.ExpressionToolModel=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.distance=function(t,e,n,i){return Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2))},t.getTransformToElement=function(t,e){var n=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),t.ownerSVGElement){var r=t.transform.baseVal.getItem(0).matrix,o=r.e,s=r.f;return n(t.parentNode,o+e,s+i)}var a=t.createSVGMatrix();return a.e=e,a.f=i,a},i=n(e),r=n(t),o=t.ownerSVGElement.createSVGMatrix();return o.e=i.e-r.e,o.f=i.f-r.f,o.inverse()},t}();e.Geometry=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.makeConnectionPath=function(t,e,n,i,r){if(void 0===r&&(r="right"),!r)return"M "+t+" "+e+" C "+(t+n)/2+" "+e+" "+(t+n)/2+" "+i+" "+n+" "+i;if("right"===r){var o=t+Math.abs(t-n)/2,s=n-Math.abs(t-n)/2;return"M "+t+" "+e+" C "+o+" "+e+" "+s+" "+i+" "+n+" "+i}if("left"===r){var o=t-Math.abs(t-n)/2,s=n+Math.abs(t-n)/2;return"M "+t+" "+e+" C "+o+" "+e+" "+s+" "+i+" "+n+" "+i}},t.radius=7,t}();e.IOPort=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.matrixToTransformAttr=function(t){return"matrix("+t.a+", "+t.b+", "+t.c+", "+t.d+", "+t.e+", "+t.f+")"},t.createMatrix=function(){return document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()},t}();e.SVGUtils=i},function(t,e,n){"use strict";var i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},r=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(40),a=n(24),u=n(57),c=function(){function t(t,e){this.stepEl=t,this.svg=t.ownerSVGElement,this.model=e}return t.prototype.update=function(){var t=a.GraphNode.makeTemplate(this.model),e=u.TemplateParser.parse(t);this.stepEl.innerHTML=e.innerHTML;var n=this.svg.querySelectorAll('.edge[data-destination-node="'+this.model.connectionId+'"]'),i=this.svg.querySelectorAll('.edge[data-source-node="'+this.model.connectionId+'"');try{for(var c=o(r(n,i)),l=c.next();!l.done;l=c.next()){var p=l.value;s.Edge.spawnBetweenConnectionIDs(this.svg.querySelector(".workflow"),p.getAttribute("data-source-connection"),p.getAttribute("data-destination-connection"))}}catch(t){d={error:t}}finally{try{l&&!l.done&&(h=c.return)&&h.call(c)}finally{if(d)throw d.error}}console.log("Should redraw input port",n);var d,h},t}();e.StepNode=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.parse=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","g");return e.innerHTML=t,e.firstElementChild},t}();e.TemplateParser=i},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),s=n(59),a=n(24),u=n(53),c=n(40),l=n(64),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.snapRadius=120,e.css={plugin:"__plugin-port-drag",snap:"__port-drag-snap",dragging:"__port-drag-dragging",suggestion:"__port-drag-suggestion"},e.detachDragListenerFn=void 0,e.wheelPrevent=function(t){return t.stopPropagation()},e.ghostX=0,e.ghostY=0,e}return i(e,t),e.prototype.registerWorkflow=function(e){t.prototype.registerWorkflow.call(this,e),this.panner=new l.EdgePanner(this.workflow),this.workflow.svgRoot.classList.add(this.css.plugin)},e.prototype.afterRender=function(){this.workflow.editingEnabled&&this.attachPortDrag()},e.prototype.onEditableStateChange=function(t){t?this.attachPortDrag():this.detachPortDrag()},e.prototype.destroy=function(){this.detachPortDrag()},e.prototype.detachPortDrag=function(){"function"==typeof this.detachDragListenerFn&&this.detachDragListenerFn(),this.detachDragListenerFn=void 0},e.prototype.attachPortDrag=function(){this.detachPortDrag(),this.detachDragListenerFn=this.workflow.domEvents.drag(".port",this.onMove.bind(this),this.onMoveStart.bind(this),this.onMoveEnd.bind(this))},e.prototype.onMove=function(t,e,n,i){var r=this;document.addEventListener("mousewheel",this.wheelPrevent,!0);var o=this.workflow.transformScreenCTMtoCanvas(n.clientX,n.clientY),s=this.workflow.scale,a=(t-this.lastMouseMove.x)/s,c=(e-this.lastMouseMove.y)/s;this.panner.triggerCollisionDetection(n.clientX,n.clientY,function(t,e){r.ghostX+=t,r.ghostY+=e,r.translateGhostNode(r.ghostX,r.ghostY),r.updateEdge(r.portOnCanvas.x,r.portOnCanvas.y,r.ghostX,r.ghostY)});var l=u.Geometry.distance(this.nodeCoords.x,this.nodeCoords.y,o.x,o.y),p=this.findClosestPort(o.x,o.y);this.updateSnapPort(p.portEl,p.distance),this.ghostX+=a,this.ghostY+=c,this.translateGhostNode(this.ghostX,this.ghostY),this.updateGhostNodeVisibility(l,p.distance),this.updateEdge(this.portOnCanvas.x,this.portOnCanvas.y,this.ghostX,this.ghostY),this.lastMouseMove={x:t,y:e}},e.prototype.onMoveStart=function(t,e){this.lastMouseMove={x:0,y:0},this.originPort=e;var n=e.getScreenCTM();this.portOnCanvas=this.workflow.transformScreenCTMtoCanvas(n.e,n.f),this.ghostX=this.portOnCanvas.x,this.ghostY=this.portOnCanvas.y,this.boundingClientRect=this.workflow.svgRoot.getBoundingClientRect();var i=this.workflow.findParent(e).transform.baseVal.getItem(0).matrix;this.nodeCoords={x:i.e,y:i.f};var r=this.workflow.workflow;this.portType=e.classList.contains("input-port")?"input":"output",this.ghostNode=this.createGhostNode(this.portType),r.appendChild(this.ghostNode),this.edgeGroup=c.Edge.spawn(),this.edgeGroup.classList.add(this.css.dragging),r.appendChild(this.edgeGroup),this.workflow.svgRoot.classList.add(this.css.dragging),this.portOrigins=this.getPortCandidateTransformations(e),this.highlightSuggestedPorts(e.getAttribute("data-connection-id"))},e.prototype.onMoveEnd=function(t){document.removeEventListener("mousewheel",this.wheelPrevent,!0),this.panner.stop();var e=this.ghostNode.getAttribute("data-type"),n=!this.ghostNode.classList.contains("hidden"),i=void 0!==this.snapPort,r=n&&"input"===e,o=n&&"output"===e,s=this.originPort.getAttribute("data-connection-id");if(i)this.createEdgeBetweenPorts(this.originPort,this.snapPort);else if(r||o){var a=this.workflow.transformScreenCTMtoCanvas(t.clientX,t.clientY),u={"sbg:x":a.x,"sbg:y":a.y};r?this.workflow.model.createInputFromPort(s,{customProps:u}):this.workflow.model.createOutputFromPort(s,{customProps:u})}this.cleanMemory(),this.cleanStyles()},e.prototype.updateSnapPort=function(t,e){var n=t!==this.snapPort,i=e>this.snapRadius;if(this.snapPort&&(n||i)){var r=this.workflow.findParent(this.snapPort);this.snapPort.classList.remove(this.css.snap),r.classList.remove(this.css.snap),delete this.snapPort}if(!(e>this.snapRadius)){var o=this.originPort.getAttribute("data-connection-id"),s=t.getAttribute("data-connection-id");if(this.findEdge(o,s))return void delete this.snapPort;this.snapPort=t;var a=this.workflow.findParent(t),u="input"===this.portType?"output":"input";t.classList.add(this.css.snap),a.classList.add(this.css.snap),a.classList.add(this.css.snap+"-"+u)}},e.prototype.updateEdge=function(t,e,n,i){var o=this.edgeGroup.children;try{for(var a=r(o),u=a.next();!u.done;u=a.next()){var c=u.value,l=s.Workflow.makeConnectionPath(t,e,n,i,"input"===this.portType?"left":"right");c.setAttribute("d",l)}}catch(t){p={error:t}}finally{try{u&&!u.done&&(d=a.return)&&d.call(a)}finally{if(p)throw p.error}}var p,d},e.prototype.updateGhostNodeVisibility=function(t,e){var n=this.ghostNode.classList.contains("hidden"),i=t>this.snapRadius&&e>this.snapRadius;i&&n?this.ghostNode.classList.remove("hidden"):i||n||this.ghostNode.classList.add("hidden")},e.prototype.translateGhostNode=function(t,e){this.ghostNode.transform.baseVal.getItem(0).setTranslate(t,e)},e.prototype.getPortCandidateTransformations=function(t){var e=this.workflow.findParent(t),n=e.getAttribute("data-connection-id"),i="input"===this.portType?"output":"input",o='.node:not([data-connection-id="'+n+'"]) .port.'+i+"-port",s=this.workflow.workflow.querySelectorAll(o),a=new Map;try{for(var c=r(s),l=c.next();!l.done;l=c.next()){var p=l.value;a.set(p,u.Geometry.getTransformToElement(p,this.workflow.workflow))}}catch(t){d={error:t}}finally{try{l&&!l.done&&(h=c.return)&&h.call(c)}finally{if(d)throw d.error}}return a;var d,h},e.prototype.highlightSuggestedPorts=function(t){for(var e=this.workflow.model.gatherValidConnectionPoints(t),n=0;n<e.length;n++){var i=e[n];if(i.isVisible){var r='.port[data-connection-id="'+i.connectionId+'"]',o=this.workflow.workflow.querySelector(r);this.workflow.findParent(o).classList.add(this.css.suggestion),o.classList.add(this.css.suggestion)}}},e.prototype.createGhostNode=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","g");return e.setAttribute("transform","matrix(1,0,0,1,0,0)"),e.setAttribute("data-type",t),e.classList.add("ghost"),e.classList.add("node"),e.innerHTML='<circle class="ghost-circle" cx="0" cy="0" r="'+a.GraphNode.radius/1.5+'"></circle>',e},e.prototype.findClosestPort=function(t,e){var n=void 0,i=1/0;return this.portOrigins.forEach(function(r,o){var s=u.Geometry.distance(t,e,r.e,r.f);s<i&&(n=o,i=s)}),{portEl:n,distance:i}},e.prototype.cleanMemory=function(){this.edgeGroup.remove(),this.ghostNode.remove(),this.snapPort=void 0,this.edgeGroup=void 0,this.nodeCoords=void 0,this.originPort=void 0,this.portOrigins=void 0,this.boundingClientRect=void 0},e.prototype.cleanStyles=function(){this.workflow.svgRoot.classList.remove(this.css.dragging);for(var t in this.css){var e=this.workflow.svgRoot.querySelectorAll("."+this.css[t]);try{for(var n=r(e),i=n.next();!i.done;i=n.next()){i.value.classList.remove(this.css[t])}}catch(t){o={error:t}}finally{try{i&&!i.done&&(s=n.return)&&s.call(n)}finally{if(o)throw o.error}}}var o,s},e.prototype.createEdgeBetweenPorts=function(t,e){var n=t.getAttribute("data-connection-id"),i=e.getAttribute("data-connection-id");if(n.startsWith("in")){var r=n;n=i,i=r}this.workflow.model.connect(n,i)},e.prototype.findEdge=function(t,e){var n='[data-source-connection="'+t+'"][data-destination-connection="'+e+'"]',i='[data-source-connection="'+e+'"][data-destination-connection="'+t+'"]';return this.workflow.workflow.querySelector(n+","+i)},e}(o.PluginBase);e.SVGPortDragPlugin=p},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(39)),i(n(60)),i(n(61)),i(n(62)),i(n(63)),i(n(58)),i(n(41)),i(n(65)),i(n(66))},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.registerWorkflow=function(e){t.prototype.registerWorkflow.call(this,e),this.svg=e.svgRoot,this.dispose=this.attachWheelListener()},e.prototype.attachWheelListener=function(){var t=this,e=this.onMouseWheel.bind(this);return this.svg.addEventListener("mousewheel",e,!0),function(){return t.svg.removeEventListener("mousewheel",e,!0)}},e.prototype.onMouseWheel=function(t){var e=this.workflow.scale,n=e-t.deltaY/500,i=n<e;n>e&&this.workflow.maxScale<n||i&&this.workflow.minScale>n||(this.workflow.scaleAtPoint(n,t.clientX,t.clientY),t.stopPropagation())},e.prototype.destroy=function(){this.dispose(),this.dispose=void 0},e}(r.PluginBase);e.ZoomPlugin=o},function(t,e,n){"use strict";var i=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var s=n(24),a=n(55),u=function(){function t(){}return t.prototype.registerWorkflow=function(t){this.workflow=t,this.svgRoot=t.svgRoot},t.prototype.registerOnBeforeChange=function(t){this.onBeforeChange=function(){return t({type:"arrange"})}},t.prototype.registerOnAfterChange=function(t){this.onAfterChange=function(){return t({type:"arrange"})}},t.prototype.registerOnAfterRender=function(t){this.triggerAfterRender=function(){return t({type:"arrange"})}},t.prototype.afterRender=function(){try{for(var t=i(this.workflow.model.steps),e=t.next();!e.done;e=t.next()){var n=e.value;if(n.isVisible){return void(isNaN(parseInt(n.customProps["sbg:x"]))&&this.arrange())}}}catch(t){r={error:t}}finally{try{e&&!e.done&&(o=t.return)&&o.call(t)}finally{if(r)throw r.error}}var r,o},t.prototype.arrange=function(){this.onBeforeChange(),this.workflow.resetTransform();var t=this.makeNodeGraphs(),e=t.mainGraph,n=t.danglingNodes,i=this.distributeNodesIntoColumns(e),r=this.calculateColumnSizes(i),o=r.distributionArea,u=r.columnDimensions,c=o.height/2,l=0,p=0,d={};i.forEach(function(t,e){var n=u[e],i=c-n.height/2-t[0].rect.height/2;t.forEach(function(t){i+=t.rect.height/2;var e=a.SVGUtils.createMatrix().translate(l,i);i+=t.rect.height/2,i>p&&(p=i),t.el.setAttribute("transform",a.SVGUtils.matrixToTransformAttr(e)),d[t.connectionID]={x:e.e,y:e.f}}),l+=n.width});var h=Object.keys(n).sort(function(t,e){var n=t.startsWith("out/"),i=t.startsWith("in/"),r=e.startsWith("out/"),o=e.startsWith("in/"),s=t.toLowerCase(),a=e.toLowerCase();return i?o?a.localeCompare(s):1:n?o?-1:r?a.localeCompare(s):1:o||r?-1:a.localeCompare(s)}),f=5*s.GraphNode.radius,y=0,v=0,m=new Map,g=new Map;l=0;var b=Math.max(o.width,3*f);h.forEach(function(t,e){var i=n[t],r=i.firstElementChild.getBoundingClientRect();m.set(e,r.width),0===l&&(l-=r.width/2),r.height>y&&(y=r.height),(l+=r.width+30+Math.max(150-r.width,0))>=b&&e<h.length-1&&(g.set(v++,y),y=0,l=0)}),g.set(v,y);var _=p;l=0,v=0,h.forEach(function(t,e){var i=n[t],r=m.get(e),o=g.get(v),s=l+r/2,u=_+30+Math.ceil(o/2)+(0===l?0:s)/b*f;0===l&&(s-=r/2,l-=r/2),l+=r+30+Math.max(150-r,0);var c=a.SVGUtils.createMatrix().translate(s,u);i.setAttribute("transform",a.SVGUtils.matrixToTransformAttr(c)),d[t]={x:c.e,y:c.f},l>=b&&(_+=Math.ceil(o)+30,l=0,y=0,v++)}),this.workflow.redrawEdges(),this.workflow.fitToViewport(),this.onAfterChange(d),this.triggerAfterRender();for(var w in d){var P=d[w],E=this.workflow.model.findById(w);E.customProps||(E.customProps={}),Object.assign(E.customProps,{"sbg:x":P.x,"sbg:y":P.y})}return d},t.prototype.calculateColumnSizes=function(t){for(var e={width:0,height:0},n=[],i=1;i<t.length;i++){for(var r=0,o=0,s=0;s<t[i].length;s++){var a=t[i][s];o+=a.rect.height,r<a.rect.width&&(r=a.rect.width)}n[i]={height:o,width:r},e.width+=r,o>e.height&&(e.height=o)}return{columnDimensions:n,distributionArea:e}},t.prototype.distributeNodesIntoColumns=function(t){for(var e={},n=Object.keys(t).sort(function(t,e){return e.localeCompare(t)}),i=[],r=0;r<n.length;r++){var o=n[r],s=t[o];if("input"!==s.type)e[o]=this.traceLongestNodePathLength(s,t);else{for(var a=1/0,u=0;u<s.outputs.length;u++){var c=e[s.outputs[u]];c<a&&(a=c)}e[o]=a===1/0?1:a-1}var l=e[o];i[l]||(i[l]=[]),i[l].push(t[o])}return i},t.prototype.indexNodesByID=function(){for(var t={},e=this.svgRoot.querySelectorAll(".node"),n=0;n<e.length;n++)t[e[n].getAttribute("data-connection-id")]=e[n];return t},t.prototype.traceLongestNodePathLength=function(t,e,n){if(void 0===n&&(n=new Set),n.add(t),0===t.inputs.length)return 1;for(var i=[],r=0;r<t.inputs.length;r++){var s=e[t.inputs[r]];n.has(s)||i.push(this.traceLongestNodePathLength(s,e,n))}return Math.max.apply(Math,o(i))+1},t.prototype.makeNodeGraphs=function(){for(var t=this.indexNodesByID(),e={},n=this.svgRoot.querySelectorAll(".edge"),i=0;i<n.length;i++){var o=n[i],s=o.getAttribute("data-source-connection"),a=o.getAttribute("data-destination-connection"),u=r(s.split("/"),3),c=u[0],l=u[1],p=u[2],d=r(a.split("/"),3),h=d[0],f=d[1],y=d[2],v="step",m="step";l===p&&(v="in"===c?"output":"input"),f===y&&(m="in"===h?"output":"input");var g=this.svgRoot.querySelector('.node[data-id="'+l+'"]'),b=this.svgRoot.querySelector('.node[data-id="'+f+'"]'),_=g.getAttribute("data-connection-id"),w=b.getAttribute("data-connection-id");delete t[_],delete t[w],e[l]||(e[l]={inputs:[],outputs:[],type:v,connectionID:_,el:g,rect:g.getBoundingClientRect()}),e[f]||(e[f]={inputs:[],outputs:[],type:m,connectionID:w,el:b,rect:b.getBoundingClientRect()}),e[l].outputs.push(f),e[f].inputs.push(l)}return{mainGraph:e,danglingNodes:t}},t}();e.SVGArrangePlugin=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.modelDisposers=[],e.css={plugin:"__plugin-validate",invalid:"__validate-invalid"},e}return i(e,t),e.prototype.registerWorkflow=function(e){t.prototype.registerWorkflow.call(this,e),this.workflow.svgRoot.classList.add(this.css.plugin)},e.prototype.afterModelChange=function(){this.disposeModelListeners();var t=this.workflow.model.on("connections.updated",this.renderEdgeValidation.bind(this)),e=this.workflow.model.on("connection.create",this.renderEdgeValidation.bind(this));this.modelDisposers.concat([t.dispose,e.dispose])},e.prototype.destroy=function(){this.disposeModelListeners()},e.prototype.afterRender=function(){this.renderEdgeValidation()},e.prototype.onEditableStateChange=function(t){t?this.renderEdgeValidation():this.removeClasses(this.workflow.workflow.querySelectorAll(".edge"))},e.prototype.disposeModelListeners=function(){try{for(var t=r(this.modelDisposers),e=t.next();!e.done;e=t.next()){(0,e.value)()}}catch(t){n={error:t}}finally{try{e&&!e.done&&(i=t.return)&&i.call(t)}finally{if(n)throw n.error}}this.modelDisposers=[];var n,i},e.prototype.removeClasses=function(t){try{for(var e=r(t),n=e.next();!n.done;n=e.next()){n.value.classList.remove(this.css.invalid)}}catch(t){i={error:t}}finally{try{n&&!n.done&&(o=e.return)&&o.call(e)}finally{if(i)throw i.error}}var i,o},e.prototype.renderEdgeValidation=function(){var t=this,e=this.workflow.workflow.querySelectorAll(".edge");this.removeClasses(e),this.workflow.model.connections.forEach(function(n){if(!n.isValid)try{for(var i=r(e),o=i.next();!o.done;o=i.next()){var s=o.value,a=s.getAttribute("data-source-connection"),u=s.getAttribute("data-destination-connection");if(n.source.id===a&&n.destination.id===u){s.classList.add(t.css.invalid);break}}}catch(t){c={error:t}}finally{try{o&&!o.done&&(l=i.return)&&l.call(i)}finally{if(c)throw c.error}}var c,l})},e}(o.PluginBase);e.SVGValidatePlugin=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(59),s=n(8),a=n(64),u=function(t){function e(e){void 0===e&&(e={});var n=t.call(this)||this;return n.scrollMargin=50,n.movementSpeed=10,n.wheelPrevent=function(t){return t.stopPropagation()},n.boundMoveHandler=n.onMove.bind(n),n.boundMoveStartHandler=n.onMoveStart.bind(n),n.boundMoveEndHandler=n.onMoveEnd.bind(n),n.detachDragListenerFn=void 0,Object.assign(n,e),n}return i(e,t),e.prototype.onEditableStateChange=function(t){t?this.attachDrag():this.detachDrag()},e.prototype.afterRender=function(){this.workflow.editingEnabled&&this.attachDrag()},e.prototype.destroy=function(){this.detachDrag()},e.prototype.registerWorkflow=function(e){t.prototype.registerWorkflow.call(this,e),this.edgePanner=new a.EdgePanner(this.workflow,{scrollMargin:this.scrollMargin,movementSpeed:this.movementSpeed})},e.prototype.detachDrag=function(){"function"==typeof this.detachDragListenerFn&&this.detachDragListenerFn(),this.detachDragListenerFn=void 0},e.prototype.attachDrag=function(){this.detachDrag(),this.detachDragListenerFn=this.workflow.domEvents.drag(".node .core",this.boundMoveHandler,this.boundMoveStartHandler,this.boundMoveEndHandler)},e.prototype.getWorkflowMatrix=function(){return this.workflow.workflow.transform.baseVal.getItem(0).matrix},e.prototype.onMove=function(t,e,n){var i=this,r=this.workflow.scale,o={x:this.getWorkflowMatrix().e-this.startWorkflowTranslation.x,y:this.getWorkflowMatrix().f-this.startWorkflowTranslation.y};this.edgePanner.triggerCollisionDetection(n.clientX,n.clientY,function(t,e){i.sdx+=t,i.sdy+=e,i.translateNodeBy(i.movingNode,t,e),i.redrawEdges(i.sdx,i.sdy)}),this.sdx=(t-o.x)/r,this.sdy=(e-o.y)/r;var s=this.sdx+this.startX,a=this.sdy+this.startY;this.translateNodeTo(this.movingNode,s,a),this.redrawEdges(this.sdx,this.sdy)},e.prototype.onMoveStart=function(t,e){var n=this.workflow.svgRoot;document.addEventListener("mousewheel",this.wheelPrevent,!0);var i=e.parentNode,o=i.transform.baseVal.getItem(0).matrix;this.startX=o.e,this.startY=o.f;var s=i.getAttribute("data-id");this.startWorkflowTranslation={x:this.getWorkflowMatrix().e,y:this.getWorkflowMatrix().f},this.boundingClientRect=n.getBoundingClientRect(),this.movingNode=e.parentNode,this.inputEdges=new Map,this.outputEdges=new Map;var a=".edge[data-source-node='"+s+"'] .sub-edge",u=".edge[data-destination-node='"+s+"'] .sub-edge",c=n.querySelectorAll([u,a].join(", "));try{for(var l=r(c),p=l.next();!p.done;p=l.next()){var d=p.value,h=d.parentElement.getAttribute("data-destination-node")===s,f=d.getAttribute("d").split(" ").map(Number).filter(function(t){return!isNaN(t)});h?this.inputEdges.set(d,f):this.outputEdges.set(d,f)}}catch(t){y={error:t}}finally{try{p&&!p.done&&(v=l.return)&&v.call(l)}finally{if(y)throw y.error}}var y,v},e.prototype.translateNodeBy=function(t,e,n){var i=t.transform.baseVal.getItem(0).matrix;this.translateNodeTo(t,i.e+e,i.f+n)},e.prototype.translateNodeTo=function(t,e,n){t.transform.baseVal.getItem(0).setTranslate(e,n)},e.prototype.redrawEdges=function(t,e){this.inputEdges.forEach(function(n,i){var r=o.Workflow.makeConnectionPath(n[0],n[1],n[6]+t,n[7]+e);i.setAttribute("d",r)}),this.outputEdges.forEach(function(n,i){var r=o.Workflow.makeConnectionPath(n[0]+t,n[1]+e,n[6],n[7]);i.setAttribute("d",r)})},e.prototype.onMoveEnd=function(){this.edgePanner.stop();var t=this.movingNode.getAttribute("data-connection-id"),e=this.workflow.model.findById(t);e.customProps||(e.customProps={});var n=this.movingNode.transform.baseVal.getItem(0).matrix;Object.assign(e.customProps,{"sbg:x":n.e,"sbg:y":n.f}),this.onAfterChange({type:"node-move"}),document.removeEventListener("mousewheel",this.wheelPrevent,!0),delete this.startX,delete this.startY,delete this.movingNode,delete this.inputEdges,delete this.outputEdges,delete this.boundingClientRect,delete this.startWorkflowTranslation},e}(s.PluginBase);e.SVGNodeMovePlugin=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){void 0===e&&(e={scrollMargin:100,movementSpeed:10}),this.movementSpeed=10,this.scrollMargin=100,this.collision={x:0,y:0},this.panningCallback=function(t,e){};var n=Object.assign({scrollMargin:100,movementSpeed:10},e);this.workflow=t,this.scrollMargin=n.scrollMargin,this.movementSpeed=n.movementSpeed,this.viewportClientRect=this.workflow.svgRoot.getBoundingClientRect()}return t.prototype.triggerCollisionDetection=function(t,e,n){var i={x:0,y:0};this.panningCallback=n;var r=this.viewportClientRect,o=r.left,s=r.right,a=r.top,u=r.bottom;if(o+=this.scrollMargin,s-=this.scrollMargin,a+=this.scrollMargin,u-=this.scrollMargin,t<o?i.x=t-o:t>s&&(i.x=t-s),e<a?i.y=e-a:e>u&&(i.y=e-u),Math.sign(i.x)!==Math.sign(this.collision.x)||Math.sign(i.y)!==Math.sign(this.collision.y)){var c=this.collision;this.collision=i,this.onBoundaryCollisionChange(i,c)}},t.prototype.onBoundaryCollisionChange=function(t,e){this.stop(),0===t.x&&0===t.y||this.start(this.collision)},t.prototype.start=function(t){var e,n=this,i=this.workflow.scale,r=this.workflow.workflow.transform.baseVal.getItem(0).matrix,o=function(s){var a=s-(e||s);if(e=s,0!==a&&!n.panAnimationFrame)return void(e=void 0);var u=Math.sign(t.x)*n.movementSpeed*a/16.6666,c=Math.sign(t.y)*n.movementSpeed*a/16.6666;r.e-=u,r.f-=c;var l=u/i,p=c/i;n.panningCallback(l,p),n.panAnimationFrame=window.requestAnimationFrame(o)};this.panAnimationFrame=window.requestAnimationFrame(o)},t.prototype.stop=function(){window.cancelAnimationFrame(this.panAnimationFrame),this.panAnimationFrame=void 0},t}();e.EdgePanner=i},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boundEdgeEnterFunction=e.onEdgeEnter.bind(e),e.modelListener={dispose:function(){}},e}return i(e,t),e.prototype.afterRender=function(){this.attachEdgeHoverBehavior()},e.prototype.destroy=function(){this.detachEdgeHoverBehavior(),this.modelListener.dispose()},e.prototype.attachEdgeHoverBehavior=function(){this.detachEdgeHoverBehavior(),this.workflow.workflow.addEventListener("mouseenter",this.boundEdgeEnterFunction,!0)},e.prototype.detachEdgeHoverBehavior=function(){this.workflow.workflow.removeEventListener("mouseenter",this.boundEdgeEnterFunction,!0)},e.prototype.onEdgeEnter=function(t){var e=this;if(t.srcElement.classList.contains("edge")){var n,i=t.srcElement,o=function(t){var i=e.workflow.transformScreenCTMtoCanvas(t.clientX,t.clientY);n.setAttribute("x",String(i.x)),n.setAttribute("y",String(i.y-16))}.bind(this),s=function(t){n.remove(),i.removeEventListener("mousemove",o),i.removeEventListener("mouseleave",s)}.bind(this);this.modelListener=this.workflow.model.on("connection.remove",function(t,e){if(n){var i=r(n.getAttribute("data-source-destination").split("$!$"),2),o=i[0],s=i[1];o===t.connectionId&&s===e.connectionId&&n.remove()}});var a=i.getAttribute("data-source-node"),u=i.getAttribute("data-destination-node"),c=i.getAttribute("data-source-port"),l=i.getAttribute("data-destination-port"),p=i.getAttribute("data-source-connection"),d=i.getAttribute("data-destination-connection"),h=a===c?a:a+" ("+c+")",f=u===l?u:u+" ("+l+")",y=this.workflow.transformScreenCTMtoCanvas(t.clientX,t.clientY);n=document.createElementNS("http://www.w3.org/2000/svg","text"),n.classList.add("label"),n.classList.add("label-edge"),n.setAttribute("x",String(y.x)),n.setAttribute("y",String(y.y)),n.setAttribute("data-source-destination",p+"$!$"+d),n.innerHTML=h+" → "+f,this.workflow.workflow.appendChild(n),i.addEventListener("mousemove",o),i.addEventListener("mouseleave",s)}},e}(o.PluginBase);e.SVGEdgeHoverPlugin=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),s=n(41),a=n(27),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boundDeleteFunction=e.onDelete.bind(e),e}return i(e,t),e.prototype.afterRender=function(){this.attachDeleteBehavior()},e.prototype.onEditableStateChange=function(t){t?this.attachDeleteBehavior():this.detachDeleteBehavior()},e.prototype.attachDeleteBehavior=function(){this.detachDeleteBehavior(),window.addEventListener("keyup",this.boundDeleteFunction,!0)},e.prototype.detachDeleteBehavior=function(){window.removeEventListener("keyup",this.boundDeleteFunction,!0)},e.prototype.onDelete=function(t){(8===t.which||46===t.which)&&t.target instanceof SVGElement&&this.deleteSelection()},e.prototype.deleteSelection=function(){var t=this,e=this.workflow.getPlugin(s.SelectionPlugin);if(e&&this.workflow.editingEnabled){e.getSelection().forEach(function(n,i){if("node"===n){var o=t.workflow.model.findById(i);o instanceof a.StepModel?(t.workflow.model.removeStep(o),e.clearSelection()):o instanceof a.WorkflowInputParameterModel?(t.workflow.model.removeInput(o),e.clearSelection()):o instanceof a.WorkflowOutputParameterModel&&(t.workflow.model.removeOutput(o),e.clearSelection())}else{var u=r(i.split(s.SelectionPlugin.edgePortsDelimiter),2),c=u[0],l=u[1];t.workflow.model.disconnect(c,l),e.clearSelection()}})}},e.prototype.destroy=function(){this.detachDeleteBehavior()},e}(o.PluginBase);e.DeletionPlugin=u},function(t,e,n){"use strict";(function(e){function n(t){s.length||(o(),a=!0),s[s.length]=t}function i(){for(;u<s.length;){var t=u;if(u+=1,s[t].call(),u>c){for(var e=0,n=s.length-u;e<n;e++)s[e]=s[e+u];s.length-=u,u=0}}s.length=0,u=0,a=!1}function r(t){return function(){function e(){clearTimeout(n),clearInterval(i),t()}var n=setTimeout(e,0),i=setInterval(e,50)}}t.exports=n;var o,s=[],a=!1,u=0,c=1024,l=void 0!==e?e:self,p=l.MutationObserver||l.WebKitMutationObserver;o="function"==typeof p?function(t){var e=1,n=new p(t),i=document.createTextNode("");return n.observe(i,{characterData:!0}),function(){e=-e,i.data=e}}(i):r(i),n.requestFlush=o,n.makeRequestCallFromTimer=r}).call(e,n(114))},function(t,e,n){"use strict";function i(){}function r(t){try{return t.then}catch(t){return m=t,g}}function o(t,e){try{return t(e)}catch(t){return m=t,g}}function s(t,e,n){try{t(e,n)}catch(t){return m=t,g}}function a(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("Promise constructor's argument is not a function");this._75=0,this._83=0,this._18=null,this._38=null,t!==i&&y(t,this)}function u(t,e,n){return new t.constructor(function(r,o){var s=new a(i);s.then(r,o),c(t,new f(e,n,s))})}function c(t,e){for(;3===t._83;)t=t._18;if(a._47&&a._47(t),0===t._83)return 0===t._75?(t._75=1,void(t._38=e)):1===t._75?(t._75=2,void(t._38=[t._38,e])):void t._38.push(e);l(t,e)}function l(t,e){v(function(){var n=1===t._83?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._83?p(e.promise,t._18):d(e.promise,t._18));var i=o(n,t._18);i===g?d(e.promise,m):p(e.promise,i)})}function p(t,e){if(e===t)return d(t,new TypeError("A promise cannot be resolved with itself."));if(e&&("object"==typeof e||"function"==typeof e)){var n=r(e);if(n===g)return d(t,m);if(n===t.then&&e instanceof a)return t._83=3,t._18=e,void h(t);if("function"==typeof n)return void y(n.bind(e),t)}t._83=1,t._18=e,h(t)}function d(t,e){t._83=2,t._18=e,a._71&&a._71(t,e),h(t)}function h(t){if(1===t._75&&(c(t,t._38),t._38=null),2===t._75){for(var e=0;e<t._38.length;e++)c(t,t._38[e]);t._38=null}}function f(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function y(t,e){var n=!1,i=s(t,function(t){n||(n=!0,p(e,t))},function(t){n||(n=!0,d(e,t))});n||i!==g||(n=!0,d(e,m))}var v=n(67),m=null,g={};t.exports=a,a._47=null,a._71=null,a._44=i,a.prototype.then=function(t,e){if(this.constructor!==a)return u(this,t,e);var n=new a(i);return c(this,new f(t,e,n)),n}},function(t,e,n){"use strict";function i(t,e){return fetch("/pipeline/"+t+"/"+e,{headers:new Headers({Accept:"application/json"})}).then(function(t){return t.json()}).then(function(t){return o.WorkflowFactory.from(t)})}function r(t){i(t.dataset.workflowName,t.dataset.workflowVersion).then(function(e){var n=new s.Workflow({editingEnabled:!0,model:e,svgRoot:t,plugins:[new s.SVGArrangePlugin,new s.SVGEdgeHoverPlugin,new s.SVGNodeMovePlugin({movementSpeed:10}),new s.SVGPortDragPlugin,new s.SelectionPlugin,new s.ZoomPlugin]});n.getPlugin(s.SVGArrangePlugin).arrange(),n.getPlugin(s.SVGEdgeHoverPlugin),n.getPlugin(s.SVGNodeMovePlugin),n.getPlugin(s.SelectionPlugin),n.getPlugin(s.ZoomPlugin),n.getPlugin(s.SVGPortDragPlugin)})}Object.defineProperty(e,"__esModule",{value:!0}),n(70),n(73),n(75);var o=n(27),s=n(108);n(112),n(117),document.addEventListener("DOMContentLoaded",function(){r(document.getElementById("cwl"))})},function(t,e,n){var i=n(71);"string"==typeof i&&(i=[[t.i,i,""]]);var r={};r.transform=void 0;n(26)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(25)(void 0),e.push([t.i,"svg.cwl-workflow {\n  fill: #303030;\n  color: white;\n  font-family: sans-serif;\n  padding: 0;\n  width: 100%;\n  display: block;\n  transform: translateZ(0); }\n  svg.cwl-workflow [tabindex]:active, svg.cwl-workflow [tabindex]:focus {\n    outline: none; }\n  svg.cwl-workflow .hidden {\n    display: none; }\n  svg.cwl-workflow .workflow {\n    user-select: none; }\n  svg.cwl-workflow .label {\n    fill: white;\n    stroke: #303030;\n    stroke-width: 4px;\n    text-anchor: middle;\n    paint-order: stroke;\n    stroke-linecap: butt;\n    stroke-linejoin: miter; }\n  svg.cwl-workflow .node-icon {\n    fill: #303030;\n    stroke: #303030;\n    stroke-width: 3px;\n    stroke-linecap: round; }\n  svg.cwl-workflow .node .outer {\n    fill: #303030;\n    stroke: #9a9a9a;\n    stroke-width: 2px; }\n  svg.cwl-workflow .node .inner {\n    stroke: 0; }\n  svg.cwl-workflow .node.input .inner {\n    fill: #c3c3c3; }\n  svg.cwl-workflow .node.output .inner {\n    fill: #c3c3c3; }\n  svg.cwl-workflow .node.step .inner {\n    fill: #11a7a7; }\n  svg.cwl-workflow .node .core .inner,\n  svg.cwl-workflow .node .core .node-icon {\n    pointer-events: none; }\n  svg.cwl-workflow .node:hover .port .label {\n    transition: all 0.1s;\n    opacity: 1; }\n  svg.cwl-workflow .node .port {\n    fill: #c3c3c3; }\n    svg.cwl-workflow .node .port:hover {\n      stroke: white;\n      stroke-width: 2px; }\n    svg.cwl-workflow .node .port.output-port .label {\n      text-anchor: start;\n      transform: translate(10px, 0); }\n    svg.cwl-workflow .node .port.input-port .label {\n      text-anchor: end;\n      transform: translate(-10px, 0); }\n    svg.cwl-workflow .node .port .label {\n      fill: white;\n      opacity: 0;\n      font-size: .9em;\n      user-select: none;\n      transition: all .1s;\n      pointer-events: none;\n      alignment-baseline: middle; }\n  svg.cwl-workflow .edge:hover .inner {\n    stroke: #11a7a7; }\n  svg.cwl-workflow .edge .inner, svg.cwl-workflow .edge .outer {\n    fill: none;\n    stroke-linecap: round; }\n  svg.cwl-workflow .edge .inner {\n    stroke-width: 2px;\n    stroke: #9a9a9a; }\n  svg.cwl-workflow .edge .outer {\n    stroke-width: 7px;\n    stroke: #303030; }\n  svg.cwl-workflow .unselectable {\n    user-select: none;\n    cursor: pointer; }\n",""])},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var r=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(r))return t;var o;return o=0===r.indexOf("//")?r:0===r.indexOf("/")?n+r:i+r.replace(/^\.\//,""),"url("+JSON.stringify(o)+")"})}},function(t,e,n){var i=n(74);"string"==typeof i&&(i=[[t.i,i,""]]);var r={};r.transform=void 0;n(26)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(25)(void 0),e.push([t.i,".cwl-workflow.__plugin-port-drag .port.__port-drag-suggestion {\n  fill: #00fff0; }\n  .cwl-workflow.__plugin-port-drag .port.__port-drag-suggestion .label {\n    opacity: 1; }\n\n.cwl-workflow.__plugin-port-drag .port.__port-drag-snap {\n  stroke: white;\n  stroke-width: 2px; }\n\n.cwl-workflow.__plugin-port-drag .node.__port-drag-snap.__port-drag-snap-input .input-port .label,\n.cwl-workflow.__plugin-port-drag .node.__port-drag-snap.__port-drag-snap-output .output-port .label {\n  opacity: 1; }\n\n.cwl-workflow.__plugin-port-drag.__port-drag-dragging {\n  pointer-events: none; }\n\n.cwl-workflow.__plugin-port-drag .edge.__port-drag-dragging .inner {\n  stroke: #9a9a9a !important;\n  stroke-dasharray: 5; }\n\n.cwl-workflow.__plugin-port-drag .ghost {\n  stroke: #c3c3c3;\n  stroke-width: 2px;\n  stroke-dasharray: 5 3;\n  fill: #303030; }\n",""])},function(t,e,n){var i=n(76);"string"==typeof i&&(i=[[t.i,i,""]]);var r={};r.transform=void 0;n(26)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(25)(void 0),e.push([t.i,".cwl-workflow.__plugin-selection .node,\n.cwl-workflow.__plugin-selection .edge {\n  cursor: pointer; }\n\n.cwl-workflow.__plugin-selection.__selection-plugin-fade .node:not(.__selection-plugin-highlight) .outer {\n  stroke: #444343; }\n\n.cwl-workflow.__plugin-selection.__selection-plugin-fade .node:not(.__selection-plugin-highlight) .inner {\n  fill: #4E6767; }\n\n.cwl-workflow.__plugin-selection.__selection-plugin-fade .node:not(.__selection-plugin-highlight).input .inner {\n  fill: #838383; }\n\n.cwl-workflow.__plugin-selection.__selection-plugin-fade .node:not(.__selection-plugin-highlight).output .inner {\n  fill: #838383; }\n\n.cwl-workflow.__plugin-selection.__selection-plugin-fade .node:not(.__selection-plugin-highlight) .label {\n  fill: #7e7d7d; }\n\n.cwl-workflow.__plugin-selection.__selection-plugin-fade .node:not(.__selection-plugin-highlight) .port {\n  fill: #444343; }\n\n.cwl-workflow.__plugin-selection.__selection-plugin-fade .edge:not(.__selection-plugin-highlight) .inner {\n  stroke: #444343; }\n\n.cwl-workflow.__plugin-selection .port.__selection-plugin-highlight .label {\n  opacity: 1; }\n\n.cwl-workflow.__plugin-selection .__selection-plugin-selected.edge .inner {\n  stroke: #11a7a7; }\n\n.cwl-workflow.__plugin-selection .__selection-plugin-selected.node .outer {\n  stroke: #11a7a7; }\n",""])},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(28)),i(n(11)),i(n(18)),i(n(15)),i(n(16)),i(n(19)),i(n(20)),i(n(30)),i(n(21)),i(n(10)),i(n(32)),i(n(13)),i(n(35)),i(n(22)),i(n(9)),i(n(4)),i(n(34)),i(n(12)),i(n(14)),i(n(36)),i(n(37)),i(n(38))},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(11),o=n(79),s=n(48),a=n(44),u=n(0),c=n(6),l=n(5),p=function(t){function e(e,n){var i=t.call(this,n||"document")||this;return i.cwlVersion="v1.0",i.steps=[],i.inputs=[],i.outputs=[],i.requirements=[],i.customProps={},e&&i.deserialize(e),i.graph=i.constructGraph(),i.validateGraph(),i}return i(e,t),e.prototype.addStepFromProcess=function(t){var e=this,n=this.loc+".steps["+this.steps.length+"]",i=new o.V1StepModel({in:[],out:[],run:t},n,this.eventHub);return i.setValidationCallback(function(t){return e.updateValidity(t)}),this.steps.push(i),i.id=this.getNextAvailableId(i.id),this.addStepToGraph(i),this.eventHub.emit("step.create",i),i},e.prototype.addEntry=function(t,e){var n=this;return t.loc=this.loc+"."+e+"["+this[e].length+"]",this[e].push(t),t.setValidationCallback(function(t){return n.updateValidity(t)}),t},e.prototype.createInputFromPort=function(e,n){return void 0===n&&(n={}),t.prototype._createInputFromPort.call(this,e,s.V1WorkflowInputParameterModel,void 0,void 0,n)},e.prototype.createOutputFromPort=function(e,n){return void 0===n&&(n={}),t.prototype._createOutputFromPort.call(this,e,a.V1WorkflowOutputParameterModel,void 0,void 0,n)},e.prototype.exposePort=function(e){var n=t.prototype._exposePort.call(this,e,s.V1WorkflowInputParameterModel);n.customProps["sbg:exposed"]=!0,n.isVisible=!1},e.prototype.getSourceConnectionId=function(t){return/[\/]+/.test(t)?c.STEP_OUTPUT_CONNECTION_PREFIX+t:""+c.STEP_OUTPUT_CONNECTION_PREFIX+t+"/"+t},e.prototype.isSourceFromStep=function(t,e){if(/[\/]+/.test(t)){var n=t.split("/");return n[0]===e?n[1]:null}return null},e.prototype.addHint=function(t){return this.createReq(t,l.V1ExpressionModel,void 0,!0)},e.prototype.serializeEmbedded=function(t){return void 0===t&&(t=!1),this._serialize(!0,t)},e.prototype.serialize=function(){return this._serialize(!1)},e.prototype._serialize=function(t,e){void 0===e&&(e=!1);var n={};n.class="Workflow",n.cwlVersion="v1.0",(this.sbgId||this.id)&&(n.id=this.sbgId||this.id),this.description&&(n.doc=this.description),this.label&&(n.label=this.label),n.inputs=this.inputs.map(function(t){return t.serialize()}),n.outputs=this.outputs.map(function(t){return t.serialize()}),n.steps=this.steps.map(function(n){return t?n.serializeEmbedded(e):n.serialize()}),this.hints.length&&(n.hints=this.hints.map(function(t){return t.serialize()}));for(var i=u.ensureArray(this.customProps.requirements,"class","value")||[],o=!0,s={SubworkflowFeatureRequirement:!1,ScatterFeatureRequirement:!1,MultipleInputFeatureRequirement:!1},a=0;a<this.steps.length;a++){var c=this.steps[a];c.run&&c.run instanceof r.WorkflowModel?s.SubworkflowFeatureRequirement=!0:c.run||(o=!1),c.scatter.length&&(s.ScatterFeatureRequirement=!0);for(var l=0;l<c.in.length;l++){var p=c.in[l];p.source&&p.source.length>1&&(s.MultipleInputFeatureRequirement=!0)}}for(var d in s)!function(t){(o||"SubworkflowFeatureRequirement"!==t)&&(i=i.filter(function(e){return e.class!==t})),s[t]&&i.push({class:t})}(d);return n.requirements=i,delete this.customProps.requirements,u.spreadAllProps(n,this.customProps)},e.prototype.deserialize=function(t){var e=this,n=["class","id","inputs","outputs","steps","cwlVersion","doc","label","hints"];this.id=this.id=t["sbg:id"]&&t["sbg:id"].split("/").length>2?t["sbg:id"].split("/")[2]:u.snakeCase(t.id),this.sbgId=t["sbg:id"],this.label=t.label,this.description=t.doc,u.ensureArray(t.inputs,"id","type").forEach(function(t,n){e.addEntry(new s.V1WorkflowInputParameterModel(t,e.loc+".inputs["+n+"]",e.eventHub),"inputs")}),u.ensureArray(t.outputs,"id","type").forEach(function(t,n){e.addEntry(new a.V1WorkflowOutputParameterModel(t,e.loc+".outputs["+n+"]",e.eventHub),"outputs")}),u.ensureArray(t.steps,"id").forEach(function(t,n){t.run&&"string"!=typeof t.run&&(t.run.cwlVersion=t.run.cwlVersion||"v1.0"),e.addEntry(new o.V1StepModel(t,e.loc+".steps["+n+"]",e.eventHub),"steps")}),this.hints=u.ensureArray(t.hints).map(function(t,n){return e.createReq(t,l.V1ExpressionModel,e.loc+".hints["+n+"]",!0)}),u.spreadSelectProps(t,this.customProps,n)},e}(r.WorkflowModel);e.V1WorkflowModel=p},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(30),s=n(52),a=n(18),u=n(28),c=n(11),l=n(0),p=n(5),d=n(96),h=n(97),f=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.in=[],r.out=[],r.hasMultipleScatter=!0,r.hasScatterMethod=!0,e&&r.deserialize(e),r}return i(e,t),e.prototype.addHint=function(t){return this.createReq(t,p.V1ExpressionModel,void 0,!0)},e.prototype.serializeEmbedded=function(t){return void 0===t&&(t=!1),this._serialize(!0,t)},e.prototype.serialize=function(){return this._serialize(!1)},e.prototype._serialize=function(t,e){void 0===e&&(e=!1);var n={};n.id=this.id,n.in=this.in.map(function(t){return t.serialize()}).filter(function(t){var e=Object.keys(t);return!(1===e.length&&"id"===e[0])}),n.out=this.out.map(function(t){return t.serialize()}),this.customProps["sbg:rdfId"]&&!t?n.run=this.customProps["sbg:rdfId"]:t&&this.run&&this.run instanceof c.WorkflowModel?n.run=this.run.serializeEmbedded():this.run&&"function"==typeof this.run.serialize?n.run=this.run.serialize():n.run=this.runPath;var i=r({},this.customProps);return e||(delete i["sbg:rdfId"],delete i["sbg:rdfSource"]),this._label&&(n.label=this.label),this.description&&(n.doc=this.description),this.scatter.length&&(n.scatter=this.scatter),this.scatterMethod&&(n.scatterMethod=this.scatterMethod),this.hints.length&&(n.hints=this.hints.map(function(t){return t.serialize()})),l.spreadAllProps(n,i)},e.prototype.deserialize=function(t){var e=this,n=["id","doc","label","run","scatter","scatterMethod","in","out","hints"];this.id=t.id||"",this.description=t.doc,this._label=t.label;var i=t.run&&t.run.class;"string"==typeof t.run?(console.warn("Expected to get json for step.run at "+this.loc+", reading in and out from step"),this.runPath=t.run):i&&this.createRun(t.run),this.in=l.ensureArray(t.in,"id","source").map(function(t,n){return new d.V1WorkflowStepInputModel(t,e,e.loc+".in["+n+"]")}),this.out=l.ensureArray(t.out,"id").map(function(t,n){return new h.V1WorkflowStepOutputModel(t,e,e.loc+".out["+n+"]")}),i&&(this.compareInPorts(),this.compareOutPorts()),this.in.forEach(function(t){!t.type||t.type.isNullable||"File"!==t.type.type&&"File"!==t.type.items&&"Directory"!==t.type.type&&"Directory"!==t.type.items||(t.isVisible=!0)}),this.requirements=l.ensureArray(t.requirements,"class"),this.hints=l.ensureArray(t.hints).map(function(t,n){return e.createReq(t,p.V1ExpressionModel,e.loc+".hints["+n+"]",!0)}),this.scatter=l.ensureArray(t.scatter),this.scatterMethod=t.scatterMethod,l.spreadSelectProps(t,this.customProps,n)},e.prototype.setRunProcess=function(t){t&&t.class&&(this.createRun(t),this.compareInPorts(!0),this.compareOutPorts(!0),this.eventHub.emit("step.update",this))},e.prototype.createRun=function(t){switch(t.class){case"Workflow":this.run=u.WorkflowFactory.from(t,this.loc+".run");break;case"CommandLineTool":this.run=o.CommandLineToolFactory.from(t,this.loc+".run");break;case"ExpressionTool":this.run=new s.ExpressionToolModel(t);break;default:throw new Error('Unknown process class "'+t.class+'" at '+this.loc+'.step. Expected "CommandLineTool", "Workflow", or "ExpressionTool"')}this.id=this.id||l.snakeCase(this.run.id)||l.snakeCase(this.loc),this._label=this._label||this.run.label||""},e.prototype.compareInPorts=function(t){var e=this;void 0===t&&(t=!1);var n,i,o=this.run.inputs,s=[];i=this.in,t&&(u=a.StepModel.portDifference(this.in,this.run.inputs),s=u[0],i=u[1],n=u[2],n.forEach(function(t){return e.eventHub.emit("step.inPort.remove",t)})),this.in=o.map(function(n,o){var a=i.find(function(t){return n.id===t.id}),u=a?a.serialize():{id:n.id},c=new d.V1WorkflowStepInputModel(r({type:n.type,fileTypes:n.fileTypes||[],doc:n.description,label:n.label,"sbg:toolDefaultValue":n.customProps["sbg:toolDefaultValue"],"sbg:category":n.customProps["sbg:category"],"sbg:altPrefix":n.customProps["sbg:altPrefix"]},u),e,e.loc+".in["+o+"]");c.setValidationCallback(function(t){return e.updateValidity(t)}),s.find(function(t){return t.id===c.id})&&e.eventHub.emit("step.inPort.create",c),a&&t&&e.eventHub.emit("step.port.change",c),c.isVisible=a?a.isVisible||l.isFileType(c,!0):l.isFileType(c,!0);var p=!a||a.isVisible!==c.isVisible;return c.isVisible&&t&&p&&setTimeout(function(){e.eventHub.emit("step.inPort.show",c)}),c}).filter(function(t){return void 0!==t});var u},e.prototype.compareOutPorts=function(t){var e=this;void 0===t&&(t=!1);var n,i=this.run.outputs,o=[];t&&(s=a.StepModel.portDifference(this.out,this.run.outputs),o=s[0],s[1],n=s[2],n.forEach(function(t){return e.eventHub.emit("step.outPort.remove",t)})),this.out=i.map(function(n,i){var s=e.out.find(function(t){return t.id===n.id});s=s?s.serialize():{id:n.id};var a=new h.V1WorkflowStepOutputModel(r({type:n.type,format:n.fileTypes||[],doc:n.description,label:n.label},s),e,e.loc+".out["+i+"]");return o.find(function(t){return t.id===a.id})&&e.eventHub.emit("step.outPort.create",a),s&&t&&e.eventHub.emit("step.port.change",a),a}).filter(function(t){return void 0!==t});var s},e}(a.StepModel);e.V1StepModel=f},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(31),o=n(45),s=n(0),a=n(23);e.generateCommandLineParts=function(t,e,n){var u=o.CommandLinePrepare.flattenInputsAndArgs([].concat(t.arguments).concat(t.inputs)),c=s.isEmpty(e)?i({inputs:a.JobHelper.getJobInputs(t)},{runtime:n}):t.getContext(),l=o.CommandLinePrepare.flattenJob(c.inputs||c,{}),p=t.baseCommand.map(function(e,n){var i=t.loc+".baseCommand["+n+"]";return o.CommandLinePrepare.prepare(e,l,t.getContext(),i,"baseCommand").then(function(t){return t instanceof r.CommandLinePart?t:new r.CommandLinePart(t,"baseCommand",i)},function(t){return new r.CommandLinePart("<"+t.type+" at "+t.loc+">",t.type,i)})}),d=u.map(function(e){return o.CommandLinePrepare.prepare(e,l,t.getContext(e),e.loc)}).filter(function(t){return t instanceof Promise}).map(function(t){return t.then(function(t){return t},function(t){return new r.CommandLinePart("<"+t.type+" at "+t.loc+">",t.type)})}),h=o.CommandLinePrepare.prepare(t.stdout,l,t.getContext(),t.stdout.loc,"stdout"),f=o.CommandLinePrepare.prepare(t.stdin,l,t.getContext(),t.stdin.loc,"stdin");return Promise.all([].concat(p,d,h,f)).then(function(t){return t.filter(function(t){return null!==t})})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),r=n(31),o=n(45),s=n(29),a=n(46),u=n(5),c=function(){function t(){}return t.primitive=function(e,n,i,o,s,a){t.checkMismatch(e,n,i);var u=e.inputBinding.prefix||"",c=!1!==e.inputBinding.separate?" ":"",l=void 0!==i&&null!==i,p=l?i:n[e.id];return null!==p&&void 0!==p&&(p.hasOwnProperty("path")?p=p.path:p.hasOwnProperty("location")&&(p=p.location)),e.inputBinding.valueFrom&&void 0!==e.inputBinding.valueFrom.serialize()?e.inputBinding.valueFrom.evaluate(o).then(function(t){return new r.CommandLinePart(u+c+t,s,a)},function(t){return new r.CommandLinePart("<"+t.type+" at "+t.loc+">",t.type,a)}):new Promise(function(t){t(new r.CommandLinePart(u+c+p,s,a))})},t.string=function(t,e,n,i,o,s){return new Promise(function(e,n){e(new r.CommandLinePart(t,o,s))})},t.boolean=function(e,n,i,o,s,a){t.checkMismatch(e,n,i);var u="",c=e.inputBinding.prefix||"",l=e.type.typeBinding&&e.type.typeBinding.prefix?e.type.typeBinding.prefix:"",p=!1!==e.inputBinding.separate?" ":"";if(i=i||n[e.id]){if(c="boolean"===e.type.items?l:c,e.inputBinding.valueFrom&&void 0!==e.inputBinding.valueFrom.serialize())return e.inputBinding.valueFrom.evaluate(o).then(function(t){return new r.CommandLinePart(c+p+t,s,a)},function(t){return new r.CommandLinePart("<"+t.type+" at "+t.loc+">",t.type,a)});u=c}return new Promise(function(t){t(new r.CommandLinePart(u,s,a))})},t.record=function(e,n,i,o,s,a){t.checkMismatch(e,n,i);var u=e.inputBinding.prefix||"",c=!1!==e.inputBinding.separate?" ":"";return new Promise(function(t){t(new r.CommandLinePart(u+c,s,a))})},t.array=function(e,n,i,s,a,u){t.checkMismatch(e,n,i),i=i||n[e.id]||[],i=i.map(function(t){return t&&t.hasOwnProperty("path")?t.path:t});var c=e.inputBinding.prefix||"",l=!1!==e.inputBinding.separate?" ":"",p="string"==typeof e.inputBinding.itemSeparator?e.inputBinding.itemSeparator:" ";return Promise.all(i.map(function(t,n){return Object.assign({},e,{id:n,type:e.type.items,inputBinding:e.type.typeBinding||{}},{items:void 0})}).map(function(t){return o.CommandLinePrepare.prepare(t,i,i[t.id])})).then(function(t){return new r.CommandLinePart(c+l+t.map(function(t){return t.value}).join(p),a,u)})},t.expression=function(t,e,n,i,o,s){return t.evaluate(i).then(function(t){return void 0===t?"":t},function(t){return new r.CommandLinePart("<"+t.type+" at "+t.loc+">",t.type,s)})},t.argument=function(e,n,i,s,c,l){if(e.primitive){if(e instanceof a.V1CommandArgumentModel){var p=new u.V1ExpressionModel(e.primitive,e.loc);if(p.isExpression)return t.expression(p,n,i,s,c,l).then(function(t){return t instanceof r.CommandLinePart?t:new r.CommandLinePart(t,"argument",l)})}return new Promise(function(t){t(new r.CommandLinePart(e.primitive,"argument",l))})}var d=e.prefix||"",h=!1!==e.separate?" ":"";return e.valueFrom?o.CommandLinePrepare.prepare(e.valueFrom,n,s,l).then(function(t){return t instanceof r.CommandLinePart?t:new r.CommandLinePart(d+h+t,c,l)}):new Promise(function(t){t(new r.CommandLinePart(d,"input",l))})},t.stream=function(e,n,o,s,a,u){if(e instanceof i.ExpressionModel)return t.expression(e,n,o,s,a,u).then(function(t){if(t instanceof r.CommandLinePart)return t;var e=t?"stdin"===a?"< ":"> ":"";return new r.CommandLinePart(e+t,a,u)})},t.nullValue=function(){return new Promise(function(t){t(null)})},t.checkMismatch=function(t,e,n){n=n||e[t.id],null!==t&&null!==t.type&&(s.TypeResolver.doesTypeMatch(t.type.type,n)||!t.type.items||s.TypeResolver.doesTypeMatch(t.type.items,n))},t}();e.CommandLineParsers=c},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(21),s=n(34),a=n(14),u=n(23),c=n(0),l=n(46),p=n(33),d=n(49),h=n(5),f=n(83),y=n(85),v=n(86),m=n(10),g=n(13),b=n(87),_=n(17),w=n(50),P=function(t){function e(e,n){var i=t.call(this,n)||this;return i.cwlVersion="v1.0",i.inputs=[],i.outputs=[],i.baseCommand=[],i.arguments=[],i.hasStdErr=!0,i.runtime={},i.initializeExprWatchers(),e&&i.deserialize(e),i.constructed=!0,i.validateAllExpressions(),i.initializeJobWatchers(),i.initializeInlineJSWatchers(),i}return i(e,t),e.prototype.initializeInlineJSWatchers=function(){var t=this;this.eventHub.on("output.metadata.inherit",function(){t.inlineJavascriptRequirement.addExpressionLib(b.sbgHelperLibrary)})},e.prototype.setRuntime=function(t){void 0===t&&(t={}),this.runtime.cores=void 0!==t.cores?t.cores:this.runtime.cores,this.runtime.ram=void 0!==t.ram?t.ram:this.runtime.ram},e.prototype.resetJobDefaults=function(){this.jobInputs=u.JobHelper.getJobInputs(this),this.updateCommandLine()},e.prototype.getContext=function(t){var e={runtime:this.runtime,inputs:this.jobInputs};if(_.ExpressionEvaluator.libraries=this.inlineJavascriptRequirement.expressionLib,t&&t instanceof m.CommandInputParameterModel)if(t.isField){var n=this.findFieldRoot(t,this.jobInputs);e.self=n?n[t.id]:null}else e.self=this.jobInputs?this.jobInputs[t.id]:null;return t&&t instanceof g.CommandOutputParameterModel&&(e.self=u.JobHelper.generateMockJobData({type:{type:"array",items:"File"}})),e},e.prototype.addHint=function(t){var e=this,n=new a.RequirementBaseModel(t,h.V1ExpressionModel,this.loc+".hints["+this.hints.length+"]",this.eventHub);return n.setValidationCallback(function(t){return e.updateValidity(t)}),this.hints.push(n),n},e.prototype.addOutput=function(e){return t.prototype._addOutput.call(this,d.V1CommandOutputParameterModel,e)},e.prototype.addInput=function(e){return t.prototype._addInput.call(this,p.V1CommandInputParameterModel,e)},e.prototype.addArgument=function(t){var e=this,n=c.incrementLastLoc(this.arguments,this.loc+".arguments"),i=new l.V1CommandArgumentModel(t,n,this.eventHub);return this.arguments.push(i),i.setValidationCallback(function(t){return e.updateValidity(t)}),this.eventHub.emit("argument.create",t),i},e.prototype.addBaseCommand=function(t){this.baseCommand.push(t)},e.prototype.setRequirement=function(t,e){this.createReq(t,null,e)},e.prototype.createReq=function(t,e,n){var i=this;void 0===n&&(n=!1);var r,o=n?"hints":"requirements";switch(e=e||this.loc+"."+o+"["+this[o].length+"]",t.class){case"DockerRequirement":return this.docker=new s.DockerRequirementModel(t,this.docker?this.docker.loc||e:e),this.docker.isHint=n,void this.docker.setValidationCallback(function(t){return i.updateValidity(t)});case"InitialWorkDirRequirement":return e=this.fileRequirement?this.fileRequirement.loc||e:e,this.fileRequirement=new f.V1InitialWorkDirRequirementModel(t,e,this.eventHub),this.fileRequirement.setValidationCallback(function(t){return i.updateValidity(t)}),void(this.fileRequirement.isHint=n);case"ResourceRequirement":return e=this.resources?this.resources.loc||e:e,this.resources=new v.V1ResourceRequirementModel(t,e,this.eventHub),this.resources.setValidationCallback(function(t){return i.updateValidity(t)}),void(this.resources.isHint=n);case"InlineJavascriptRequirement":return e=this.inlineJavascriptRequirement?this.inlineJavascriptRequirement.loc||e:e,this.inlineJavascriptRequirement=new y.V1InlineJavascriptRequirementModel(t,e),this.inlineJavascriptRequirement.setValidationCallback(function(t){return i.updateValidity(t)}),this.inlineJavascriptRequirement.isHint=n,void(this.inlineJavascriptRequirement.wasPresent=!0);default:r=new a.RequirementBaseModel(t,h.V1ExpressionModel,e,this.eventHub),r.isHint=n}r&&(this[o].push(r),r.setValidationCallback(function(t){return i.updateValidity(t)}))},e.prototype.updateStream=function(t,e){var n=this;this[e]=t,t.loc=this.loc+"."+e,t.setValidationCallback(function(t){return n.updateValidity(t)})},e.prototype.deserialize=function(t){var e=this,n=["baseCommand","stdout","stdin","stderr","successCodes","temporaryFailCodes","permanentFailCodes","inputs","outputs","id","class","cwlVersion","doc","label","arguments","hints","requirements"];this.id=this.id=t["sbg:id"]&&t["sbg:id"].split("/").length>2?t["sbg:id"].split("/")[2]:c.snakeCase(t.id),this.description=t.doc,this.label=t.label,this.baseCommand=c.charSeparatedToArray(t.baseCommand,/\s+/),c.ensureArray(t.inputs,"id","type").map(function(t){return e.addInput(t)}),c.ensureArray(t.outputs,"id","type").map(function(t){return e.addOutput(t)}),this.arguments=c.ensureArray(t.arguments).map(function(t){return e.addArgument(t)}),c.ensureArray(t.hints,"class","value").map(function(t,n){return e.createReq(t,null,!0)}),c.ensureArray(t.requirements,"class","value").map(function(t,n){return e.createReq(t)});var i=this.requirements.length;this.docker||(this.docker=new s.DockerRequirementModel({},this.loc+".requirements["+ ++i+"]")),this.docker.setValidationCallback(function(t){return e.updateValidity(t)}),this.fileRequirement||(this.fileRequirement=new f.V1InitialWorkDirRequirementModel({},this.loc+".requirements["+ ++i+"]",this.eventHub)),this.fileRequirement.setValidationCallback(function(t){return e.updateValidity(t)}),this.resources||(this.resources=new v.V1ResourceRequirementModel({},this.loc+".requirements["+ ++i+"]",this.eventHub)),this.resources.setValidationCallback(function(t){return e.updateValidity(t)}),this.inlineJavascriptRequirement||(this.inlineJavascriptRequirement=new y.V1InlineJavascriptRequirementModel({},this.loc+".requirements["+ ++i+"]")),this.stdin=new h.V1ExpressionModel(t.stdin,this.loc+".stdin",this.eventHub),this.stdin.setValidationCallback(function(t){return e.updateValidity(t)}),this.stdout=new h.V1ExpressionModel(t.stdout,this.loc+".stdout",this.eventHub),this.stdout.setValidationCallback(function(t){return e.updateValidity(t)}),this.stderr=new h.V1ExpressionModel(t.stderr,this.loc+".stderr",this.eventHub),this.stderr.setValidationCallback(function(t){return e.updateValidity(t)}),this.runtime={cores:1,ram:1e3},t["sbg:job"]?(this.jobInputs=r({},u.JobHelper.getNullJobInputs(this),t["sbg:job"].inputs),this.runtime=r({},this.runtime,t["sbg:job"].runtime)):this.jobInputs=u.JobHelper.getJobInputs(this),this.sbgId=t["sbg:id"],this.successCodes=c.ensureArray(t.successCodes),this.temporaryFailCodes=c.ensureArray(t.temporaryFailCodes),this.permanentFailCodes=c.ensureArray(t.permanentFailCodes),c.spreadSelectProps(t,this.customProps,n)},e.prototype.serialize=function(){var t={},e=!1,n=!1,i=this.eventHub.on("binding.shellQuote",function(t){e=t}),r=this.eventHub.on("expression.serialize",function(t){n=t});t.class="CommandLineTool",t.cwlVersion="v1.0",(this.sbgId||this.id)&&(t.id=this.sbgId||this.id),t.baseCommand=this.baseCommand.filter(function(t){return!!t}),t.inputs=this.inputs.map(function(t){return t.serialize()}),t.outputs=this.outputs.map(function(t){return t.serialize()}),this.description&&(t.doc=this.description),this.label&&(t.label=this.label),this.arguments.length&&(t.arguments=this.arguments.map(function(t){return t.serialize()}).filter(function(t){return!!t}));var o=this.requirements.findIndex(function(t){return"ShellCommandRequirement"===t.class});if(e?(t.requirements=[],-1===o&&t.requirements.push({class:"ShellCommandRequirement"})):o>-1&&this.requirements.splice(o,1),i(),t.requirements=t.requirements||[],t.hints=[],this.requirements.length&&this.requirements.filter(function(t){return!!t}).forEach(function(e){return t.requirements.push(e.serialize())}),this.hints.length&&this.hints.forEach(function(e){return t.hints.push(e.serialize())}),this.resources.serialize()){var s=this.resources.isHint?"hints":"requirements";t[s].push(this.resources.serialize())}if(this.docker.serialize()){var s=this.docker.isHint?"hints":"requirements";t[s].push(this.docker.serialize())}if(this.fileRequirement.serialize()){var s=this.fileRequirement.isHint?"hints":"requirements";t[s].push(this.fileRequirement.serialize())}t.requirements.length||delete t.requirements,t.hints.length||delete t.hints,void 0!==this.stdin.serialize()&&(t.stdin=this.stdin.serialize()),void 0!==this.stdout.serialize()&&(t.stdout=this.stdout.serialize()),void 0!==this.stderr.serialize()&&(t.stderr=this.stderr.serialize()),this.successCodes.length&&(t.successCodes=this.successCodes),this.temporaryFailCodes.length&&(t.temporaryFailCodes=this.temporaryFailCodes),this.permanentFailCodes.length&&(t.permanentFailCodes=this.permanentFailCodes);for(var a=!1,u=0;u<t.outputs.length;u++){var l=t.outputs[u];if(l.outputBinding&&new RegExp(w.V1CommandOutputBindingModel.INHERIT_REGEX).test(l.outputBinding.outputEval)){a=!0;break}}return a||this.inlineJavascriptRequirement.removeExpressionLib(b.sbgHelperLibrary),this.inlineJavascriptRequirement.expressionLib.length>0||this.inlineJavascriptRequirement.wasPresent?(t.requirements=t.requirements||[],t.requirements.push(this.inlineJavascriptRequirement.serialize())):n&&(t.requirements=t.requirements||[],t.requirements.push({class:"InlineJavascriptRequirement"})),r(),c.spreadAllProps(t,this.customProps)},e}(o.CommandLineToolModel);e.V1CommandLineToolModel=P},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(36),s=n(84),a=n(0),u=n(9),c=n(5),l=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.class="InitialWorkDirRequirement",r.listing=[],e&&r.deserialize(e),r}return i(e,t),e.prototype.addDirent=function(t){var e=this,n=new s.V1DirentModel(t,this.loc+".listing["+this.listing.length+"]",this.eventHub);return n.setValidationCallback(function(t){return e.updateValidity(t)}),this.listing.push(n),n},e.prototype.addExpression=function(t){var e=this;void 0===t&&(t="");var n=new c.V1ExpressionModel(t,this.loc+".listing["+this.listing.length+"]",this.eventHub);return n.setValidationCallback(function(t){return e.updateValidity(t)}),this.listing.push(n),n},e.prototype.serialize=function(){var t={class:"InitialWorkDirRequirement",listing:this.listing.reduce(function(t,e){var n=e.serialize();return n&&(e instanceof u.ExpressionModel||n.entryname||n.entry)&&t.push(n),t},[])};if(this.customProps.listing){t.listing=t.listing.concat(this.customProps.listing);var e=r({},this.customProps);return delete e.listing,a.spreadAllProps(t,e)}var n=Object.keys(t),i=Object.keys(this.customProps);if(2!==n.length||"class"!==n[0]||"listing"!==n[1]||t.listing.length||0!==i.length)return a.spreadAllProps(t,this.customProps)},e.prototype.deserialize=function(t){var e=this,n=[],i=[],r=["class"];Array.isArray(t.listing)&&t.listing.forEach(function(t){if(t)if(t.entryname||t.entry){var r=e.addDirent(t);n.push(r)}else"string"==typeof t?n.push(e.addExpression(t)):i.push(t)}),n.length&&r.push("listing"),i.length&&(this.customProps.listing=i),this.listing=n,a.spreadSelectProps(t,this.customProps,r)},e}(o.CreateFileRequirementModel);e.V1InitialWorkDirRequirementModel=l},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(37),o=n(5),s=n(0),a=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return e&&r.deserialize(e),r}return i(e,t),e.prototype.serialize=function(){var t={};return void 0!==this.entryName.serialize()&&(t.entryname=this.entryName.serialize()),void 0!==this.entry.serialize()&&(t.entry=this.entry.serialize()),s.spreadAllProps(t,this.customProps)},e.prototype.deserialize=function(t){var e=this;this.entryName=new o.V1ExpressionModel(t.entryname,this.loc+".entryname",this.eventHub),this.entryName.setValidationCallback(function(t){return e.updateValidity(t)}),this.entry=new o.V1ExpressionModel(t.entry,this.loc+".entry",this.eventHub),this.entry.setValidationCallback(function(t){return e.updateValidity(t)}),s.spreadSelectProps(t,this.customProps,["entry","entryname"])},e}(r.DirentModel);e.V1DirentModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(12),o=n(0),s=function(t){function e(e,n){var i=t.call(this,n)||this;return i.class="InlineJavascriptRequirement",i.wasPresent=!1,i.expressionLib=[],e&&i.deserialize(e),i}return i(e,t),e.prototype.addExpressionLib=function(t){-1===this.expressionLib.indexOf(t)&&this.expressionLib.push(t)},e.prototype.removeExpressionLib=function(t){var e=this.expressionLib.indexOf(t);-1!==e&&this.expressionLib.splice(e,1)},e.prototype.deserialize=function(t){this.expressionLib=t.expressionLib||[],o.spreadSelectProps(t,this.customProps,["expressionLib","class"])},e.prototype.serialize=function(){var t={};return t.class=this.class,this.expressionLib.length&&(t.expressionLib=this.expressionLib),o.spreadAllProps(t,this.customProps)},e}(r.ProcessRequirementModel);e.V1InlineJavascriptRequirementModel=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(38),o=n(5),s=n(0),a=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.class="ResourceRequirement",r.mem=new o.V1ExpressionModel("",r.loc+".ramMin",r.eventHub),r.mem.setValidationCallback(function(t){return r.updateValidity(t)}),r.cores=new o.V1ExpressionModel("",r.loc+".coresMin",r.eventHub),r.cores.setValidationCallback(function(t){return r.updateValidity(t)}),e&&r.deserialize(e),r}return i(e,t),e.prototype.serialize=function(){var t=this.mem.serialize(),e=this.cores.serialize();if(void 0!==t||void 0!==e||Object.keys(this.customProps).length){t=s.returnNumIfNum(t),e=s.returnNumIfNum(e);var n={class:"ResourceRequirement"};return void 0!==t&&(n.ramMin=t),void 0!==e&&(n.coresMin=e),s.spreadAllProps(n,this.customProps)}},e.prototype.deserialize=function(t){var e=this;void 0!==t.ramMin&&null!==t.ramMin&&(this.mem=new o.V1ExpressionModel(t.ramMin.toString(),this.loc+".ramMin",this.eventHub),this.mem.setValidationCallback(function(t){return e.updateValidity(t)})),void 0!==t.coresMin&&null!==t.coresMin&&(this.cores=new o.V1ExpressionModel(t.coresMin.toString(),this.loc+".coresMin",this.eventHub),this.cores.setValidationCallback(function(t){return e.updateValidity(t)})),s.spreadSelectProps(t,this.customProps,["class","ramMin","coresMin"])},e.prototype.validate=function(t){return Promise.all([this.mem.validate(t),this.cores.validate(t)])},e}(r.ResourceRequirementModel);e.V1ResourceRequirementModel=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sbgHelperLibrary="\nvar setMetadata = function(file, metadata) {\n    if (!('metadata' in file))\n        file['metadata'] = metadata;\n    else {\n        for (var key in metadata) {\n            file['metadata'][key] = metadata[key];\n        }\n    }\n    return file\n};\n\nvar inheritMetadata = function(o1, o2) {\n    var commonMetadata = {};\n    if (!Array.isArray(o2)) {\n        o2 = [o2]\n    }\n    for (var i = 0; i < o2.length; i++) {\n        var example = o2[i]['metadata'];\n        for (var key in example) {\n            if (i == 0)\n                commonMetadata[key] = example[key];\n            else {\n                if (!(commonMetadata[key] == example[key])) {\n                    delete commonMetadata[key]\n                }\n            }\n        }\n    }\n    if (!Array.isArray(o1)) {\n        o1 = setMetadata(o1, commonMetadata)\n    } else {\n        for (var i = 0; i < o1.length; i++) {\n            o1[i] = setMetadata(o1[i], commonMetadata)\n        }\n    }\n    return o1;\n};"},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(21),s=n(34),a=n(14),u=n(23),c=n(0),l=n(89),p=n(90),d=n(91),h=n(93),f=n(7),y=n(95),v=n(10),m=n(13),g=n(1),b=function(t){function e(e,n){var i=t.call(this,n)||this;return i.cwlVersion="sbg:draft-2",i.baseCommand=[],i.inputs=[],i.outputs=[],i.requirements=[],i.hints=[],i.arguments=[],i.hasStdErr=!1,i.initializeExprWatchers(),e&&i.deserialize(e),i.constructed=!0,i.validateAllExpressions(),i.initializeJobWatchers(),i}return i(e,t),e.prototype.setRuntime=function(t){void 0===t&&(t={}),this.runtime.cpu=void 0!==t.cpu?t.cpu:this.runtime.cpu,this.runtime.mem=void 0!==t.mem?t.mem:this.runtime.mem},e.prototype.getContext=function(t){var e={$job:{inputs:this.jobInputs,allocatedResources:this.runtime}};if(t&&t instanceof v.CommandInputParameterModel)if(t.isField){var n=this.findFieldRoot(t,this.jobInputs);e.$self=n?n[t.id]:null}else e.$self=this.jobInputs?this.jobInputs[t.id]:null;return t&&t instanceof m.CommandOutputParameterModel&&(e.$self=u.JobHelper.generateMockJobData({type:{type:"array",items:"File"}})),e},e.prototype.resetJobDefaults=function(){this.jobInputs=u.JobHelper.getJobInputs(this),this.updateCommandLine()},e.prototype.addHint=function(t){var e=this,n=new a.RequirementBaseModel(t,f.SBDraft2ExpressionModel,this.loc+".hints["+this.hints.length+"]",this.eventHub);return n.setValidationCallback(function(t){return e.updateValidity(t)}),this.hints.push(n),n},e.prototype.addBaseCommand=function(t){var e=this;void 0===t&&(t="");var n=c.incrementLastLoc(this.baseCommand,this.loc+".baseCommand"),i=new f.SBDraft2ExpressionModel(t,n,this.eventHub);return this.baseCommand.push(i),i.setValidationCallback(function(t){return e.updateValidity(t)}),i},e.prototype.updateBaseCommand=function(t){var e=this;this.baseCommand.forEach(function(t){return t.clearIssue(g.ErrorCode.EXPR_ALL)}),this.baseCommand=[],t.forEach(function(t){return e.addBaseCommand(t.serialize())})},e.prototype.addArgument=function(t){var e=this,n=c.incrementLastLoc(this.arguments,this.loc+".arguments"),i=new l.SBDraft2CommandArgumentModel(t,n,this.eventHub);return this.arguments.push(i),i.setValidationCallback(function(t){return e.updateValidity(t)}),i},e.prototype.addInput=function(e){return t.prototype._addInput.call(this,p.SBDraft2CommandInputParameterModel,e)},e.prototype.addOutput=function(e){return t.prototype._addOutput.call(this,d.SBDraft2CommandOutputParameterModel,e)},e.prototype.setRequirement=function(t,e){var n=e?"hints":"requirements";this.createReq(t,this.loc+"."+n+"["+this[n].length+"]",e)},e.prototype.updateStream=function(t,e){var n=this;this[e]=t,t.loc=this.loc+"."+e,t.setValidationCallback(function(t){return n.updateValidity(t)})},e.prototype.createReq=function(t,e,n){var i,r=this,o=n?"hints":"requirements";switch(t.class){case"DockerRequirement":return this.docker=new s.DockerRequirementModel(t,e),void this.docker.setValidationCallback(function(t){return r.updateValidity(t)});case"CreateFileRequirement":return i=new h.SBDraft2CreateFileRequirementModel(t,e,this.eventHub),this.fileRequirement=i,void i.setValidationCallback(function(t){return r.updateValidity(t)});case"sbg:CPURequirement":return this.resources.cores=new f.SBDraft2ExpressionModel(t.value,e+".value",this.eventHub),void this.resources.cores.setValidationCallback(function(t){return r.updateValidity(t)});case"sbg:MemRequirement":return this.resources.mem=new f.SBDraft2ExpressionModel(t.value,e+".value",this.eventHub),void this.resources.mem.setValidationCallback(function(t){return r.updateValidity(t)});default:i=new a.RequirementBaseModel(t,f.SBDraft2ExpressionModel,e)}i&&(this[o].push(i),i.setValidationCallback(function(t){return r.updateValidity(t)}))},e.prototype.deserialize=function(t){var e=this,n=["baseCommand","class","id","label","description","inputs","hints","requirements","arguments","outputs","stdin","stdout","successCodes","temporaryFailCodes","permanentFailCodes","cwlVersion"];this.id=t["sbg:id"]&&t["sbg:id"].split("/").length>2?t["sbg:id"].split("/")[2]:c.snakeCase(t.id),this.sbgId=t["sbg:id"],this.label=t.label,this.description=t.description,c.ensureArray(t.inputs).forEach(function(t){return e.addInput(t)}),c.ensureArray(t.outputs).forEach(function(t){return e.addOutput(t)}),c.checkPortIdUniqueness(this.inputs.concat(this.outputs)),t.arguments&&t.arguments.forEach(function(t){e.addArgument(t)}),this.resources=this.resources||new y.SBDraft2ResourceRequirementModel(this.loc+".hints["+this.hints.length+"]",this.eventHub),this.resources.setValidationCallback(function(t){return e.updateValidity(t)}),t.requirements&&t.requirements.forEach(function(t,n){e.createReq(t,e.loc+".requirements["+n+"]")}),t.hints&&t.hints.forEach(function(t,n){e.createReq(t,e.loc+".hints["+n+"]",!0)}),this.docker=this.docker||new s.DockerRequirementModel({},this.loc+".hints["+this.hints.length+"]"),this.docker.isHint=!0,this.docker.setValidationCallback(function(t){return e.updateValidity(t)}),this.fileRequirement=this.fileRequirement||new h.SBDraft2CreateFileRequirementModel({},this.loc+".requirements["+this.requirements.length+"]",this.eventHub),this.fileRequirement.setValidationCallback(function(t){return e.updateValidity(t)}),this.updateStream(new f.SBDraft2ExpressionModel(t.stdin,this.loc+".stdin",this.eventHub),"stdin"),this.updateStream(new f.SBDraft2ExpressionModel(t.stdout,this.loc+".stdout",this.eventHub),"stdout"),this.successCodes=c.ensureArray(t.successCodes),this.temporaryFailCodes=c.ensureArray(t.temporaryFailCodes),this.permanentFailCodes=c.ensureArray(t.permanentFailCodes),t.baseCommand=t.baseCommand||[""],t.baseCommand=Array.isArray(t.baseCommand)?t.baseCommand:[t.baseCommand],this.baseCommand=[],t.baseCommand.reduce(function(t,e){return"string"==typeof e&&"string"==typeof t[t.length-1]?(t[t.length-1]+=" "+e,t):t.concat([e])},[]).forEach(function(t){e.addBaseCommand(t)}),this.runtime={mem:1e3,cpu:1},t["sbg:job"]?(this.jobInputs=r({},u.JobHelper.getNullJobInputs(this),t["sbg:job"].inputs),this.runtime=r({},this.runtime,t["sbg:job"].allocatedResources)):this.jobInputs=u.JobHelper.getJobInputs(this),c.spreadSelectProps(t,this.customProps,n)},e.prototype.serialize=function(){var t={},e=!1;t.cwlVersion="sbg:draft-2",t.class="CommandLineTool",(this.sbgId||this.id)&&(t.id=this.sbgId||this.id),this.label&&(t.label=this.label),this.description&&(t.description=this.description);var n=this.eventHub.on("expression.serialize",function(t){e=t});t.baseCommand=this.baseCommand.map(function(t){return t.serialize()}).filter(function(t){return!!t}).reduce(function(t,e){return"string"==typeof e?t.concat(e.split(/\s+/)):t.concat([e])},[]),t.inputs=this.inputs.map(function(t){return t.serialize()}),t.outputs=this.outputs.map(function(t){return t.serialize()}),t.requirements=[],this.requirements.length&&(t.requirements=this.requirements.map(function(t){return t.serialize()})),this.fileRequirement.serialize()&&t.requirements.push(this.fileRequirement.serialize()),t.requirements.length||delete t.requirements,t.hints=[],this.hints.length&&(t.hints=this.hints.map(function(t){return t.serialize()})),void 0!==this.resources.cores.serialize()&&t.hints.push({class:"sbg:CPURequirement",value:c.returnNumIfNum(this.resources.cores.serialize())}),void 0!==this.resources.mem.serialize()&&t.hints.push({class:"sbg:MemRequirement",value:c.returnNumIfNum(this.resources.mem.serialize())}),this.docker.serialize()&&t.hints.push(this.docker.serialize()),t.hints.length||delete t.hints,this.arguments.length&&(t.arguments=this.arguments.map(function(t){return t.serialize()}).filter(function(t){return!!t})),this.stdin.serialize()&&(t.stdin=this.stdin.serialize()),this.stdout.serialize()&&(t.stdout=this.stdout.serialize()),this.successCodes.length&&(t.successCodes=this.successCodes),this.temporaryFailCodes.length&&(t.temporaryFailCodes=this.temporaryFailCodes),this.permanentFailCodes.length&&(t.permanentFailCodes=this.permanentFailCodes);var i=this.requirements.findIndex(function(t){return"ExpressionEngineRequirement"===t.class});return e&&(t.requirements=t.requirements||[],-1===i&&t.requirements.push({id:"#cwl-js-engine",class:"ExpressionEngineRequirement",requirements:[{dockerPull:"rabix/js-engine",class:"DockerRequirement"}]})),n(),t=Object.assign({},t,this.customProps)},e}(o.CommandLineToolModel);e.SBDraft2CommandLineToolModel=b},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(22),o=n(51),s=n(1),a=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.hasExprPrimitive=!1,r.hasShellQuote=!1,r.deserialize(e||{}),r}return i(e,t),e.prototype.updateBinding=function(t){this.hasBinding=!0,this.primitive=void 0,this.binding.prefix=t.prefix,this.binding.position=t.position,this.binding.separate=t.separate,this.binding.itemSeparator=t.itemSeparator},e.prototype.updatePrimitive=function(t){this.hasBinding=!1,this.binding=void 0,this.primitive=t},e.prototype.toggleBinding=function(t){var e=this;t?(this.binding=new o.SBDraft2CommandLineBindingModel({},this.loc,this.eventHub),this.binding.setValidationCallback(function(t){return e.updateValidity(t)}),this.primitive=void 0):(this.primitive="",this.binding.clearIssue(s.ErrorCode.ALL),this.binding=void 0),this.hasBinding=t},Object.defineProperty(e.prototype,"arg",{get:function(){return this.primitive||this.binding},set:function(t){this.deserialize(t)},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.primitive?this.primitive:this.binding?this.binding.valueFrom.toString():""},e.prototype.serialize=function(){return this.primitive?this.primitive:this.binding?this.binding.serialize():void 0},e.prototype.deserialize=function(t){var e=this;"string"==typeof t?(this.hasBinding=!1,this.primitive=t):t instanceof o.SBDraft2CommandLineBindingModel?(this.hasBinding=!0,this.binding=new o.SBDraft2CommandLineBindingModel(t.serialize(),this.loc,this.eventHub),this.binding.setValidationCallback(function(t){return e.updateValidity(t)})):(this.hasBinding=!0,this.binding=new o.SBDraft2CommandLineBindingModel(t,this.loc,this.eventHub),this.binding.setValidationCallback(function(t){return e.updateValidity(t)}))},e}(r.CommandArgumentModel);e.SBDraft2CommandArgumentModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(10),s=n(4),a=n(0),u=n(51),c=n(7),l=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.inputBinding=null,r.hasSecondaryFiles=!1,r.hasSecondaryFilesInRoot=!1,r.hasStageInput=!0,r.secondaryFiles=[],r.deserialize(e),r}return i(e,t),e.prototype.serialize=function(){var t=r({},this.customProps);return t.type=this.type.serialize(),this.inputBinding&&(t.inputBinding=this.inputBinding.serialize(),("File"===this.type.type||"File"===this.type.items&&this.secondaryFiles.length)&&(t.inputBinding.secondaryFiles=this.secondaryFiles.map(function(t){return t.serialize()}).filter(function(t){return!!t}))),this.label&&(t.label=this.label),this.description&&(t.description=this.description),this.fileTypes.length&&(t["sbg:fileTypes"]=this.fileTypes.join(", ")),this.isField?(t.name=this.id,t):(t.id=this.id?"#"+this.id:"",t)},e.prototype.deserialize=function(t){var n=this,i=["label","description","inputBinding","type","sbg:fileTypes"];t=t||{},this.isField=!!t.name,this.isField?i.push("name"):i.push("id"),t.id&&"#"===t.id.charAt(0)?this.id=t.id.substr(1):this.id=t.id||t.name||"";try{a.validateID(this.id)}catch(t){this.setIssue((r={},r[this.loc+".id"]={type:"error",code:t.code,message:t.message},r))}this.label=t.label,this.description=t.description,this.fileTypes=a.commaSeparatedToArray(t["sbg:fileTypes"]),void 0!==t.inputBinding&&(this.inputBinding=new u.SBDraft2CommandLineBindingModel(t.inputBinding,this.loc+".inputBinding",this.eventHub),this.inputBinding.setValidationCallback(function(t){return n.updateValidity(t)}),t.inputBinding.secondaryFiles&&(this.secondaryFiles=a.ensureArray(t.inputBinding.secondaryFiles).map(function(t){return n.addSecondaryFile(t)}))),this.type=new s.ParameterTypeModel(t.type,e,this.id+"_field",this.loc+".type",this.eventHub),this.type.setValidationCallback(function(t){return n.updateValidity(t)}),a.isType(this,["record","enum"])&&!this.type.name&&(this.type.name=this.id),this.attachFileTypeListeners(),a.spreadSelectProps(t,this.customProps,i);var r},e.prototype.updateInputBinding=function(t){var e=this;t instanceof u.SBDraft2CommandLineBindingModel&&(this.inputBinding.setValidationCallback(function(t){return e.updateValidity(t)}),this.inputBinding.cloneStatus(t))},e.prototype.createInputBinding=function(){var t=this;return this.inputBinding=new u.SBDraft2CommandLineBindingModel({},this.loc+".inputBinding",this.eventHub),this.inputBinding.setValidationCallback(function(e){return t.updateValidity(e)}),this.inputBinding},e.prototype.addSecondaryFile=function(t){if(this.inputBinding)return this._addSecondaryFile(t,c.SBDraft2ExpressionModel,this.inputBinding.loc)},e.prototype.updateSecondaryFiles=function(t){this.inputBinding&&this._updateSecondaryFiles(t)},e.prototype.removeSecondaryFile=function(t){this.inputBinding&&this._removeSecondaryFile(t)},e}(o.CommandInputParameterModel);e.SBDraft2CommandInputParameterModel=l},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(13),o=n(4),s=n(0),a=n(92),u=n(7),c=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.secondaryFiles=[],r.hasSecondaryFiles=!1,r.hasSecondaryFilesInRoot=!1,r.deserialize(e||{}),r}return i(e,t),e.prototype.updateSecondaryFiles=function(t){this.outputBinding&&this._updateSecondaryFiles(t)},e.prototype.addSecondaryFile=function(t){if(this.outputBinding)return this._addSecondaryFile(t,u.SBDraft2ExpressionModel,this.outputBinding.loc)},e.prototype.removeSecondaryFile=function(t){this.outputBinding&&this._removeSecondaryFile(t)},e.prototype.updateOutputBinding=function(t){var e=this;this.outputBinding=new a.SBDraft2CommandOutputBindingModel(t instanceof a.SBDraft2CommandOutputBindingModel?t.serialize():{},this.loc+".outputBinding",this.eventHub),this.outputBinding.setValidationCallback(function(t){return e.updateValidity(t)})},e.prototype.serialize=function(){var t={};return t.type=this.type.serialize(),this.label&&(t.label=this.label),this.description&&(t.description=this.description),this.fileTypes&&this.fileTypes.length&&(t["sbg:fileTypes"]=(this.fileTypes||[]).join(", ")),this.outputBinding&&(t.outputBinding=this.outputBinding.serialize(),s.isFileType(this)||(delete t.outputBinding.secondaryFiles,delete t.outputBinding.loadContents,delete t["sbg:fileTypes"]),s.isFileType(this)&&this.secondaryFiles.length>0&&(t.outputBinding.secondaryFiles=this.secondaryFiles.map(function(t){return t.serialize()}).filter(function(t){return!!t})),Object.keys(t.outputBinding).length||delete t.outputBinding),this.isField?t.name=this.id||"":t.id=this.id?"#"+this.id:"",s.spreadAllProps(t,this.customProps)},e.prototype.deserialize=function(t){var n=this,i=["id","label","description","outputBinding","type","sbg:fileTypes"];this.isField=!!t.name,this.isField?i.push("name"):i.push("id"),t.id&&"#"===t.id.charAt(0)?this.id=t.id.substr(1):this.id=t.id||t.name||"",this.label=t.label,this.description=t.description,this.fileTypes=s.commaSeparatedToArray(t["sbg:fileTypes"]),this.outputBinding=new a.SBDraft2CommandOutputBindingModel(t.outputBinding,this.loc+".outputBinding",this.eventHub),this.outputBinding.setValidationCallback(function(t){return n.updateValidity(t)}),t.outputBinding&&t.outputBinding.secondaryFiles&&(this.secondaryFiles=t.outputBinding.secondaryFiles.map(function(t){return n.addSecondaryFile(t)})),this.type=new o.ParameterTypeModel(t.type,e,this.id+"_field",this.loc+".type",this.eventHub),this.type.setValidationCallback(function(t){return n.updateValidity(t)}),s.isType(this,["record","enum"])&&!this.type.name&&(this.type.name=this.id),this.attachFileTypeListeners(),s.spreadSelectProps(t,this.customProps,i)},e}(r.CommandOutputParameterModel);e.SBDraft2CommandOutputParameterModel=c},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(35),o=n(7),s=n(1),a=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.metadata={},r.hasSecondaryFiles=!0,r.hasMetadata=!0,r.hasInheritMetadata=!0,r.customProps={},r.deserialize(e||{}),r}return i(e,t),Object.defineProperty(e.prototype,"glob",{get:function(){return this._glob},set:function(t){this.setGlob(t,o.SBDraft2ExpressionModel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputEval",{get:function(){return this._outputEval},set:function(t){this.setOutputEval(t,o.SBDraft2ExpressionModel),this.validateOutputEval()},enumerable:!0,configurable:!0}),e.prototype.validateOutputEval=function(){"expression"!==this._outputEval.type&&void 0!==this._outputEval.serialize()?this._outputEval.setIssue((t={},t[this.loc+".outputEval"]={type:"error",message:"outputEval must be an expression",code:s.ErrorCode.OUTPUT_EVAL_EXPR},t)):this._outputEval.clearIssue(s.ErrorCode.OUTPUT_EVAL_EXPR);var t},e.prototype.setInheritMetadataFrom=function(t){this.inheritMetadataFrom=t},e.prototype.serialize=function(){var t=this,e={};return this._glob&&this._glob.serialize()&&(e.glob=this._glob.serialize()),Object.keys(this.metadata).length&&(e["sbg:metadata"]={},Object.keys(this.metadata).filter(function(t){return t}).forEach(function(n){var i=t.metadata[n].serialize();void 0!==i&&(e["sbg:metadata"][n]=i)})),this.inheritMetadataFrom&&(e["sbg:inheritMetadataFrom"]="#"===this.inheritMetadataFrom.substr(0)?this.inheritMetadataFrom:"#"+this.inheritMetadataFrom),this.loadContents&&(e.loadContents=!0),this._outputEval.serialize()&&(e.outputEval=this._outputEval.serialize()),Object.assign({},this.customProps,e)},e.prototype.deserialize=function(t){var e=this,n=["glob","secondaryFiles","outputEval","loadContents","sbg:metadata","sbg:inheritMetadataFrom"];t&&t.constructor===Object&&(Array.isArray(t.glob)?(console.warn("Not supporting glob which is string[] at "+this.loc+". Glob cannot be edited via model"),n.splice(0,1)):(this._glob=new o.SBDraft2ExpressionModel(t.glob,this.loc+".glob",this.eventHub),this._glob.setValidationCallback(function(t){return e.updateValidity(t)}),this.validateGlob()),this.loadContents=!0===t.loadContents,this.inheritMetadataFrom=null,t["sbg:inheritMetadataFrom"]&&(this.inheritMetadataFrom="#"===t["sbg:inheritMetadataFrom"].charAt(0)?t["sbg:inheritMetadataFrom"].substr(1):t["sbg:inheritMetadataFrom"]),this.eventHub&&this.modelListeners.push(this.eventHub.on("input.change.id",function(t){t.oldId===e.inheritMetadataFrom&&(e.inheritMetadataFrom=t.newId)})),this._outputEval=new o.SBDraft2ExpressionModel(t.outputEval,this.loc+".outputEval",this.eventHub),this._outputEval.setValidationCallback(function(t){return e.updateValidity(t)}),this.validateOutputEval(),t["sbg:metadata"]&&t["sbg:metadata"].constructor===Object&&Object.keys(t["sbg:metadata"]).filter(function(t){return t}).forEach(function(n){var i=t["sbg:metadata"][n];void 0!==i&&(e.metadata[n]=new o.SBDraft2ExpressionModel(i,e.loc+'["sbg:metadata"].'+n,e.eventHub),e.metadata[n].setValidationCallback(function(t){return e.updateValidity(t)}))}),Object.keys(t).forEach(function(i){-1===n.indexOf(i)&&(e.customProps[i]=t[i])}))},e}(r.CommandOutputBindingModel);e.SBDraft2CommandOutputBindingModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(36),o=n(94),s=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.class="CreateFileRequirement",r._listing=[],r.deserialize(e),r}return i(e,t),Object.defineProperty(e.prototype,"listing",{get:function(){return this._listing},set:function(t){var e=this;this._listing=[],t.forEach(function(t,n){t instanceof o.SBDraft2FileDefModel||(t=new o.SBDraft2FileDefModel(t,e.loc+".fileDef["+n+"]",e.eventHub)),e._listing.push(t),t.setValidationCallback(function(t){return e.updateValidity(t)})})},enumerable:!0,configurable:!0}),e.prototype.addDirent=function(t){var e=this;if(t instanceof o.SBDraft2FileDefModel)return this._listing.push(t),t.setValidationCallback(function(t){return e.updateValidity(t)}),t.loc=this.loc+".fileDef["+this._listing.length+"]",t;var n=new o.SBDraft2FileDefModel(t,this.loc+".fileDef["+this._listing.length+"]",this.eventHub);return n.setValidationCallback(function(t){return e.updateValidity(t)}),this._listing.push(n),n},e.prototype.deserialize=function(t){var e=this;t.fileDef&&Array.isArray(t.fileDef)&&(this._listing=t.fileDef.map(function(t,n){var i=new o.SBDraft2FileDefModel(t,e.loc+".fileDef["+n+"]",e.eventHub);return i.setValidationCallback(function(t){return e.updateValidity(t)}),i})),Object.keys(t).forEach(function(n){"fileDef"!==n&&"class"!==n&&(e.customProps[n]=t[n])})},e.prototype.serialize=function(){var t={};t.class="CreateFileRequirement",t.fileDef=this._listing.map(function(t){return t.serialize()});var e=Object.keys(this.customProps);if(0!==t.fileDef.length||0!==e.length)return Object.assign({},t,this.customProps)},e}(r.CreateFileRequirementModel);e.SBDraft2CreateFileRequirementModel=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(37),o=n(0),s=n(7),a=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.entryName=new s.SBDraft2ExpressionModel("",r.loc+".filename",r.eventHub),r.entry=new s.SBDraft2ExpressionModel("",r.loc+".fileContent",r.eventHub),r.customProps={},r.entryName.setValidationCallback(function(t){return r.updateValidity(t)}),r.entry.setValidationCallback(function(t){return r.updateValidity(t)}),r.deserialize(e),r}return i(e,t),e.prototype.serialize=function(){var t={};return void 0!==this.entryName.serialize()&&(t.filename=this.entryName.serialize()),void 0!==this.entry.serialize()&&(t.fileContent=this.entry.serialize()),Object.assign({},t,this.customProps)},e.prototype.deserialize=function(t){var e=this;t&&(this.entryName=new s.SBDraft2ExpressionModel(t.filename,this.loc+".filename",this.eventHub),this.entryName.setValidationCallback(function(t){return e.updateValidity(t)}),this.entry=new s.SBDraft2ExpressionModel(t.fileContent,this.loc+".fileContent",this.eventHub),this.entry.setValidationCallback(function(t){return e.updateValidity(t)})),o.spreadSelectProps(t,this.customProps,["filename","fileContent"])},e}(r.DirentModel);e.SBDraft2FileDefModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(38),o=n(0),s=n(7),a=function(t){function e(e,n){var i=t.call(this,e,n)||this,r=i.loc.slice(0,-1);return i.mem=new s.SBDraft2ExpressionModel("",r+"].value",i.eventHub),i.mem.setValidationCallback(function(t){return i.updateValidity(t)}),i.cores=new s.SBDraft2ExpressionModel("",o.incrementString(r)+"].value",i.eventHub),i.cores.setValidationCallback(function(t){return i.updateValidity(t)}),i}return i(e,t),e}(r.ResourceRequirementModel);e.SBDraft2ResourceRequirementModel=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(19),o=n(0),s=n(4),a=n(5),u=function(t){function e(e,n,i){var r=t.call(this,i)||this;return r.isVisible=!1,r.parentStep=n,e&&r.deserialize(e),r}return i(e,t),e.prototype.serialize=function(){var t={id:this.id};return void 0!==this.default&&null!==this.default&&(t.default=this.default),this.source.length&&(t.source=this.source.slice()),this.valueFrom&&this.valueFrom.serialize()&&(t.valueFrom=this.valueFrom.serialize()),t=o.spreadAllProps(t,this.customProps),delete t["sbg:toolDefaultValue"],delete t["sbg:category"],delete t["sbg:altPrefix"],t},e.prototype.deserialize=function(t){var e=["id","default","source","type","doc","label","fileTypes"];this.id=t.id,this.default=t.default,this.source=o.ensureArray(t.source),this.valueFrom=new a.V1ExpressionModel(t.valueFrom,this.loc+".valueFrom"),this.type=t.type,this.type||(this.type=new s.ParameterTypeModel(null)),this.type.hasDirectoryType=!0,this.description=t.doc,this.label=t.label,this.fileTypes=t.fileTypes,o.spreadSelectProps(t,this.customProps,e)},e}(r.WorkflowStepInputModel);e.V1WorkflowStepInputModel=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(20),o=n(4),s=function(t){function e(e,n,i){var r=t.call(this,i)||this;return r.parentStep=n,e&&r.deserialize(e),r}return i(e,t),e.prototype.serialize=function(){return{id:this.id}},Object.defineProperty(e.prototype,"sourceId",{get:function(){return this.parentStep.id+"/"+this.id},enumerable:!0,configurable:!0}),e.prototype.deserialize=function(t){this.id=t.id,this.type=t.type,this.type||(this.type=new o.ParameterTypeModel(null)),this.type.hasDirectoryType=!0,this.description=t.doc,this.label=t.label,this.fileTypes=t.format},e}(r.WorkflowStepOutputModel);e.V1WorkflowStepOutputModel=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(11),o=n(99),s=n(102),a=n(103),u=n(0),c=n(6),l=n(15),p=n(7),d=function(t){function e(e,n){void 0===n&&(n="document");var i=t.call(this,n)||this;return i.cwlVersion="sbg:draft-2",i.steps=[],i.inputs=[],i.outputs=[],i.hasBatch=!0,e&&i.deserialize(e),i.graph=i.constructGraph(),i.validateGraph(),i.eventHub.on("io.change.id",function(t,e){t instanceof l.WorkflowInputParameterModel&&i.batchInput===e&&(i.batchInput=t.id)}),i}return i(e,t),e.prototype.createInputFromPort=function(e,n){void 0===n&&(n={});var i=t.prototype._createInputFromPort.call(this,e,s.SBDraft2WorkflowInputParameterModel,void 0,void 0,n);return i.customProps["sbg:includeInPorts"]=!0,i},e.prototype.createOutputFromPort=function(e,n){return void 0===n&&(n={}),t.prototype._createOutputFromPort.call(this,e,a.SBDraft2WorkflowOutputParameterModel,void 0,void 0,n)},e.prototype.exposePort=function(e){t.prototype._exposePort.call(this,e,s.SBDraft2WorkflowInputParameterModel)},e.prototype.getSourceConnectionId=function(t){if(/[.]+/.test(t)){var e=t.split("."),n=e[0],i=e[1];return n="#"===n.charAt(0)?n.substr(1):n,""+c.STEP_OUTPUT_CONNECTION_PREFIX+n+"/"+i}var r="#"===t.charAt(0)?t.substr(1):t;return""+c.STEP_OUTPUT_CONNECTION_PREFIX+r+"/"+r},e.prototype.isSourceFromStep=function(t,e){if(/[.]+/.test(t)){var n=t.split(".");return n[0]==="#"+e?n[1]:null}return null},e.prototype.addStepFromProcess=function(t){var e=this,n=this.loc+".steps["+this.steps.length+"]",i=new o.SBDraft2StepModel({inputs:[],outputs:[],run:t},n,this.eventHub);return i.setValidationCallback(function(t){return e.updateValidity(t)}),this.steps.push(i),i.id=this.getNextAvailableId(i.id),this.addStepToGraph(i),this.eventHub.emit("step.create",i),i},e.prototype.setBatch=function(t,e){if(!e||"none"===e)return this.batchByValue=null,void(this.batchInput=null);this.batchInput=t,this.batchByValue=e},e.prototype.addHint=function(t){return this.createReq(t,p.SBDraft2ExpressionModel,void 0,!0)},e.prototype.serializeEmbedded=function(t){return void 0===t&&(t=!1),this._serialize(!0,t)},e.prototype.serialize=function(){return this._serialize(!1)},e.prototype._serialize=function(t,e){void 0===e&&(e=!1);var n={};if(n.class="Workflow",n.cwlVersion="sbg:draft-2",(this.sbgId||this.id)&&(n.id=this.sbgId||this.id),this.label&&(n.label=this.label),this.description&&(n.description=this.description),n.inputs=this.inputs.map(function(t){return t.serialize()}),n.outputs=this.outputs.map(function(t){return t.serialize()}),n.steps=this.steps.map(function(n){return t?n.serializeEmbedded(e):n.serialize()}),this.hints.length&&(n.hints=this.hints.map(function(t){return t.serialize()})),this.batchInput&&(n["sbg:batchInput"]="#"+this.batchInput),this.batchByValue){var i=Array.isArray(this.batchByValue),r={type:i?"criteria":"item"};i&&(r.criteria=this.batchByValue),n["sbg:batchBy"]=r}return u.spreadAllProps(n,this.customProps)},e.prototype.deserialize=function(t){var e=this,n=["id","class","cwlVersion","steps","inputs","outputs","label","hints","description","sbg:batchBy","sbg:batchInput"];this.label=t.label,this.description=t.description,this.id=t["sbg:id"]&&t["sbg:id"].split("/").length>2?t["sbg:id"].split("/")[2]:u.snakeCase(t.id),this.sbgId=t["sbg:id"],this.steps=u.ensureArray(t.steps).map(function(t,n){t.run&&"string"!=typeof t.run&&(t.run.cwlVersion=t.run.cwlVersion||"sbg:draft-2");var i=new o.SBDraft2StepModel(t,e.loc+".steps["+n+"]",e.eventHub);return i.setValidationCallback(function(t){return e.updateValidity(t)}),i}),this.inputs=u.ensureArray(t.inputs).map(function(t,n){var i=new s.SBDraft2WorkflowInputParameterModel(t,e.loc+".inputs["+n+"]",e.eventHub);return i.setValidationCallback(function(t){return e.updateValidity(t)}),i}),this.outputs=u.ensureArray(t.outputs).map(function(t,n){var i=new a.SBDraft2WorkflowOutputParameterModel(t,e.loc+".outputs["+n+"]",e.eventHub);return i.setValidationCallback(function(t){return e.updateValidity(t)}),i}),this.hints=u.ensureArray(t.hints).map(function(t,n){return e.createReq(t,p.SBDraft2ExpressionModel,e.loc+".hints["+n+"]",!0)}),t["sbg:batchInput"]?(0===t["sbg:batchInput"].indexOf("#")&&(this.batchInput=t["sbg:batchInput"].substring(1)),"item"===t["sbg:batchBy"].type?this.batchByValue="item":this.batchByValue=t["sbg:batchBy"].criteria):(this.batchByValue=null,this.batchInput=null),u.spreadSelectProps(t,this.customProps,n)},e}(r.WorkflowModel);e.SBDraft2WorkflowModel=d},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(18),s=n(11),a=n(52),u=n(100),c=n(101),l=n(0),p=n(28),d=n(30),h=n(7),f=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.hasMultipleScatter=!1,r.hasScatterMethod=!1,e&&r.deserialize(e),r}return i(e,t),e.prototype.setRunProcess=function(t){t&&t.class&&(this.createRun(t),this.compareInPorts(!0),this.compareOutPorts(!0),this.eventHub.emit("step.update",this))},e.prototype.addHint=function(t){return this.createReq(t,h.SBDraft2ExpressionModel,void 0,!0)},e.prototype.compareInPorts=function(t){var e=this;void 0===t&&(t=!1);var n,i,s=this.run.inputs,a=[];i=this.in,t&&(c=o.StepModel.portDifference(this.in,this.run.inputs),a=c[0],i=c[1],n=c[2],n.forEach(function(t){return e.eventHub.emit("step.inPort.remove",t)})),this.in=s.map(function(n,o){var s=i.find(function(t){return n.id===t.id}),c=s?s.serialize():{id:e.id+"."+n.id},p=new u.SBDraft2WorkflowStepInputModel(r({type:n.type,fileTypes:n.fileTypes||[],description:n.description,label:n.label},c,{"sbg:toolDefaultValue":n.customProps["sbg:toolDefaultValue"],"sbg:category":n.customProps["sbg:category"],"sbg:altPrefix":n.customProps["sbg:altPrefix"]}),e,e.loc+".inputs["+o+"]");p.setValidationCallback(function(t){return e.updateValidity(t)}),a.find(function(t){return t.id===p.id})&&e.eventHub.emit("step.inPort.create",p),s&&t&&e.eventHub.emit("step.port.change",p),p.isVisible=(s?s.isVisible:!!n.customProps["sbg:includeInPorts"])||l.isFileType(n,!0);var d=!s||s.isVisible!==p.isVisible;return p.isVisible&&t&&d&&setTimeout(function(){e.eventHub.emit("step.inPort.show",p)}),p}).filter(function(t){return void 0!==t});var c},e.prototype.compareOutPorts=function(t){var e=this;void 0===t&&(t=!1);var n,i=this.run.outputs,s=[];t&&(a=o.StepModel.portDifference(this.out,this.run.outputs),s=a[0],a[1],n=a[2],n.forEach(function(t){return e.eventHub.emit("step.outPort.remove",t)})),this.out=i.map(function(n,i){var o=e.out.find(function(t){return n.id===t.id});o=o?o.serialize():{id:e.id+"."+n.id};var a=new c.SBDraft2WorkflowStepOutputModel(r({type:n.type,fileTypes:n.fileTypes,description:n.description,label:n.label},o),e,e.loc+".outputs["+i+"]");return s.find(function(t){return t.id===a.id})&&e.eventHub.emit("step.outPort.create",a),o&&t&&e.eventHub.emit("step.port.change",a),a}).filter(function(t){return void 0!==t});var a},e.prototype.createRun=function(t){var e=this;switch(t.class){case"Workflow":this.run=p.WorkflowFactory.from(t,this.loc+".run"),this.run.setValidationCallback(function(t){return e.updateValidity(t)});break;case"CommandLineTool":this.run=d.CommandLineToolFactory.from(t,this.loc+".run"),this.run.setValidationCallback(function(t){return e.updateValidity(t)});break;case"ExpressionTool":this.run=new a.ExpressionToolModel(t);break;default:throw new Error('Unknown process class "'+t.class+'" at '+this.loc+'.step. Expected "CommandLineTool", "Workflow", or "ExpressionTool"')}this.id=this.id||l.snakeCase(this.run.id)||l.snakeCase(this.run.label)||l.snakeCase(this.loc),this.id="#"===this.id.charAt(0)?this.id.substr(1):this.id,this._label=this._label||this.run.label||""},e.prototype.serialize=function(){return this._serialize(!1)},e.prototype.serializeEmbedded=function(t){return void 0===t&&(t=!1),this._serialize(!0,t)},e.prototype._serialize=function(t,e){var n=this;void 0===e&&(e=!1);var i={};i.id="#"+this.id,i.inputs=this.in.map(function(t){return t.serialize()}).filter(function(t){var e=Object.keys(t);return!(1===e.length&&"id"===e[0])}),i.outputs=this.out.map(function(t){return t.serialize()}),this.customProps["sbg:rdfId"]&&!t?i.run=this.customProps["sbg:rdfId"]:t&&this.run&&this.run instanceof s.WorkflowModel?i.run=this.run.serializeEmbedded():this.run&&"function"==typeof this.run.serialize?i.run=this.run.serialize():i.run=this.runPath,this.hints.length&&(i.hints=this.hints.map(function(t){return t.serialize()}));var o=r({},this.customProps);return e||(delete o["sbg:rdfId"],delete o["sbg:rdfSource"]),this._label&&(i.label=this._label),this.description&&(i.description=this.description),this.scatter&&(i.scatter=this.in.filter(function(t){return n.scatter===t.id})[0].destinationId),l.spreadAllProps(i,o)},e.prototype.deserialize=function(t){var e=this,n=["id","description","label","run","scatter","inputs","outputs","hints"];this.id=t.id||"",this.description=t.description,this._label=t.label,this.scatter=t.scatter?t.scatter.split(".")[1]:null,this.hints=l.ensureArray(t.hints).map(function(t,n){return e.createReq(t,h.SBDraft2ExpressionModel,e.loc+".hints["+n+"]",!0)}),t.run&&"string"==typeof t.run?this.runPath=t.run:t.run&&"string"!=typeof t.run&&t.run.class&&this.createRun(t.run),this.id="#"===this.id.charAt(0)?this.id.substr(1):this.id,this.in=l.ensureArray(t.inputs).map(function(t,n){return new u.SBDraft2WorkflowStepInputModel(t,e,e.loc+".inputs["+n+"]")}),this.out=l.ensureArray(t.outputs).map(function(t,n){return new c.SBDraft2WorkflowStepOutputModel(t,e,e.loc+".outputs["+n+"]")}),"string"==typeof t.run?console.warn("Expected to get json for step.run at "+this.loc+", reading in and out from step"):(this.compareInPorts(),this.compareOutPorts()),this.in.forEach(function(t){l.isFileType(t,!0)&&(t.isVisible=!0)}),l.spreadSelectProps(t,this.customProps,n)},e}(o.StepModel);e.SBDraft2StepModel=f},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(19),o=n(0),s=n(6),a=n(4),u=function(t){function e(e,n,i){var r=t.call(this,i)||this;return r.parentStep=n||{},e&&r.deserialize(e),r}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectionId",{get:function(){return""+s.STEP_INPUT_CONNECTION_PREFIX+this.parentStep.id+"/"+this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destinationId",{get:function(){return"#"+this.parentStep.id+"."+this._id},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){var t={};return t.id="#"+this.parentStep.id+"."+this._id,this.source.length&&(t.source=this.source.slice()),this.linkMerge&&(t.linkMerge=this.linkMerge),void 0!==this.default&&null!==this.default&&(t.default=this.default),t=o.spreadAllProps(t,this.customProps),delete t["sbg:toolDefaultValue"],delete t["sbg:category"],delete t["sbg:altPrefix"],t},e.prototype.deserialize=function(t){var e=["default","id","fileTypes","type","description","label","source"];this.default=t.default,this._id=t.id.split(".")[1],this.fileTypes=t.fileTypes,this.description=t.description,this.label=t.label,this.source=o.ensureArray(t.source),this.type=t.type,this.type||(this.type=new a.ParameterTypeModel(null)),o.spreadSelectProps(t,this.customProps,e)},e}(r.WorkflowStepInputModel);e.SBDraft2WorkflowStepInputModel=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(20),o=n(0),s=n(6),a=n(4),u=function(t){function e(e,n,i){var r=t.call(this,i)||this;return r.parentStep=n||{},e&&r.deserialize(e),r}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectionId",{get:function(){return""+s.STEP_OUTPUT_CONNECTION_PREFIX+this.parentStep.id+"/"+this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sourceId",{get:function(){return"#"+this.parentStep.id+"."+this._id},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){return{id:"#"+this.parentStep.id+"."+this._id}},e.prototype.deserialize=function(t){var e=["id","sbg:fileTypes"];this._id=t.id.split(".")[1],this.fileTypes=t.fileTypes,this.type=t.type,this.description=t.description,this.label=t.label,this.type||(this.type=new a.ParameterTypeModel(null)),o.spreadSelectProps(t,this.customProps,e)},e}(r.WorkflowStepOutputModel);e.SBDraft2WorkflowStepOutputModel=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),o=n(4),s=n(6),a=n(0),u=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return e&&r.deserialize(e),r}return i(e,t),Object.defineProperty(e.prototype,"connectionId",{get:function(){return""+s.STEP_OUTPUT_CONNECTION_PREFIX+this.id+"/"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sourceId",{get:function(){return"#"+this.id},enumerable:!0,configurable:!0}),e.prototype.deserialize=function(t){var n=this,i=["name","id","type","label","description","sbg:fileTypes"];this.isField=!!t.name,t.id&&"#"===t.id.charAt(0)?this.id=t.id.substr(1):this.id=t.id||t.name||"",this.type=new o.ParameterTypeModel(t.type,e,this.id+"_field",this.loc+".type",this.eventHub),this.type.setValidationCallback(function(t){n.updateValidity(t)}),this.fileTypes=a.commaSeparatedToArray(t["sbg:fileTypes"]),this._label=t.label,this.description=t.description,this.isVisible="File"===this.type.type||"File"===this.type.items||!!t["sbg:includeInPorts"],a.spreadSelectProps(t,this.customProps,i)},e.prototype.serialize=function(){var t={};return t.type=this.type.serialize(),this._label&&(t.label=this._label),this.description&&(t.description=this.description),this.fileTypes.length&&(t["sbg:fileTypes"]=this.fileTypes.join(", ")),this.isField?t.name=this.id:t.id="#"+this.id,a.spreadAllProps(t,this.customProps)},e}(r.WorkflowInputParameterModel);e.SBDraft2WorkflowInputParameterModel=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(16),o=n(4),s=n(0),a=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return e&&r.deserialize(e),r}return i(e,t),Object.defineProperty(e.prototype,"destinationId",{get:function(){return"#"+this.id},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){var t={};return t.id="#"+this.id,this._label&&(t.label=this._label),this.description&&(t.description=this.description),t.source=s.ensureArray(this.source),this.type&&(t.type=this.type.serialize()),this.fileTypes.length&&(t["sbg:fileTypes"]=this.fileTypes.join(", ")),s.spreadAllProps(t,this.customProps)},e.prototype.deserialize=function(t){var n=["id","type","source","label","description","sbg:fileTypes"];t.id&&"#"===t.id.charAt(0)?this.id=t.id.substr(1):this.id=t.id||"",this.source=s.ensureArray(t.source),this.type=new o.ParameterTypeModel(t.type,e,this.id+"_field",this.loc+".type",this.eventHub),this._label=t.label,this.description=t.description,this.fileTypes=s.commaSeparatedToArray(t["sbg:fileTypes"]),s.spreadSelectProps(t,this.customProps,n)},e}(r.WorkflowOutputParameterModel);e.SBDraft2WorkflowOutputParameterModel=a},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(17)),i(n(31)),i(n(105)),i(n(43)),i(n(29)),i(n(6)),i(n(0))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(106),r=function(){function t(){}return t.evaluate=function(t,e){return new Promise(function(n,r){try{n(i.runInNewContext(t,e||{},{timeout:1e3}))}catch(t){r(t)}})},t}();e.JSExecutor=r},function(module,exports,__webpack_require__){function Context(){}var indexOf=__webpack_require__(107),Object_keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)e.push(n);return e},forEach=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(t,e,n){Object.defineProperty(t,e,{writable:!0,enumerable:!1,configurable:!0,value:n})}}catch(t){return function(t,e,n){t[e]=n}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];Context.prototype={};var Script=exports.Script=function(t){if(!(this instanceof Script))return new Script(t);this.code=t};Script.prototype.runInContext=function(t){if(!(t instanceof Context))throw new TypeError("needs a 'context' argument.");var e=document.createElement("iframe");e.style||(e.style={}),e.style.display="none",document.body.appendChild(e);var n=e.contentWindow,i=n.eval,r=n.execScript;!i&&r&&(r.call(n,"null"),i=n.eval),forEach(Object_keys(t),function(e){n[e]=t[e]}),forEach(globals,function(e){t[e]&&(n[e]=t[e])});var o=Object_keys(n),s=i.call(n,this.code);return forEach(Object_keys(n),function(e){(e in t||-1===indexOf(o,e))&&(t[e]=n[e])}),forEach(globals,function(e){e in t||defineProp(t,e,n[e])}),document.body.removeChild(e),s},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(t){var e=Script.createContext(t),n=this.runInContext(e);return forEach(Object_keys(e),function(n){t[n]=e[n]}),n},forEach(Object_keys(Script.prototype),function(t){exports[t]=Script[t]=function(e){var n=Script(e);return n[t].apply(n,[].slice.call(arguments,1))}}),exports.createScript=function(t){return exports.Script(t)},exports.createContext=Script.createContext=function(t){var e=new Context;return"object"==typeof t&&forEach(Object_keys(t),function(n){e[n]=t[n]}),e}},function(t,e){var n=[].indexOf;t.exports=function(t,e){if(n)return t.indexOf(e);for(var i=0;i<t.length;++i)if(t[i]===e)return i;return-1}},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(39)),i(n(56)),i(n(58)),i(n(61)),i(n(65)),i(n(63)),i(n(62)),i(n(41)),i(n(60)),i(n(66)),i(n(8))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.root=t,this.handlers=new Map}return t.prototype.on=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=e.shift(),r="string"==typeof e[0]?e.shift():void 0,o="function"==typeof e[0]?e.shift():function(){},s=e.shift(),a=s||this.root;this.handlers.has(a)||this.handlers.set(a,{}),this.handlers.get(a)[i]||(this.handlers.get(a)[i]=[]);var u=function(e){var n;if(r){var i=Array.from(t.root.querySelectorAll(r));for(n=e.target;n&&!i.find(function(t){return t===n});)n=n.parentNode;if(!n)return}o(e,n||e.target,t.root);return!1};return a.addEventListener(i,u),this.handlers.get(a)[i].push(u),function(){a.removeEventListener(i,u)}},t.prototype.keyup=function(){},t.prototype.adaptedDrag=function(t,e,n,i){var r,o,s,a,u=this,c=!1,l=0,p=function(t,e){return c=!0,r=t,o=e,s=t,t.preventDefault(),a=u.detachHandlers("mouseover"),document.addEventListener("mousemove",h),document.addEventListener("mouseup",f),!1},d=this.on("mousedown",t,p),h=function(t){if(c){var i=t.screenX-r.screenX,a=t.screenY-r.screenY;l++,3===l&&"function"==typeof n&&n(s,o,u.root),l>=3&&"function"==typeof e&&e(i,a,t,o,u.root)}},f=function(t){if(l>=3){c&&"function"==typeof i&&i(t,o,u.root);var e=o.parentNode,n=function(t){t.stopPropagation(),e.removeEventListener("click",n,!0)};e.addEventListener("click",n,!0)}c=!1,o=void 0,r=void 0,l=0,document.removeEventListener("mouseup",f),document.removeEventListener("mousemove",h);for(var s in a)u.root.addEventListener("mouseover",a[s]),u.handlers.get(u.root).mouseover=[],u.handlers.get(u.root).mouseover.push(a[s])};return d},t.prototype.drag=function(t,e,n,i){var r,o,s,a,u=this,c=!1,l=0,p=function(t,e,n){return c=!0,r=t,o=e,s=t,t.preventDefault(),a=u.detachHandlers("mouseover"),document.addEventListener("mousemove",h),document.addEventListener("mouseup",f),!1},d=this.on("mousedown",t,p),h=function(t){if(c){var i=t.screenX-r.screenX,a=t.screenY-r.screenY;l++,3===l&&"function"==typeof n&&n(s,o,u.root),l>=3&&"function"==typeof e&&e(i,a,t,o,u.root)}},f=function(t){if(l>=3&&(c&&"function"==typeof i&&i(t,o,u.root),o.contains(t.target))){var e=o.parentNode,n=function(t){t.stopPropagation(),e.removeEventListener("click",n,!0)};e.addEventListener("click",n,!0)}c=!1,o=void 0,r=void 0,l=0,document.removeEventListener("mouseup",f),document.removeEventListener("mousemove",h);for(var s in a)u.root.addEventListener("mouseover",a[s]),u.handlers.get(u.root).mouseover=[],u.handlers.get(u.root).mouseover.push(a[s])};return d},t.prototype.hover=function(t,e,n,i){var r=this;void 0===e&&(e=function(){}),void 0===n&&(n=function(){}),void 0===i&&(i=function(){});var o=!1;t.addEventListener("mouseenter",function(e){o=!0,n(e,t,r.root)}),t.addEventListener("mouseleave",function(e){o=!1,i(e,t,r.root)}),t.addEventListener("mousemove",function(n){o&&e(n,t,r.root)})},t.prototype.detachHandlers=function(t,e){e=e||this.root;var n=[];return this.handlers.forEach(function(i,r){if(r.id===e.id&&r===e){for(var o in i)!function(e){if(e!==t)return"continue";i[e].forEach(function(t){n.push(t),r.removeEventListener(e,t)})}(o)}}),delete this.handlers.get(this.root)[t],n},t.prototype.detachAll=function(){this.handlers.forEach(function(t,e){for(var n in t)!function(n){t[n].forEach(function(t){return e.removeEventListener(n,t)})}(n)}),this.handlers.clear()},t}();e.DomEvents=i},function(t,e,n){"use strict";var i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},r=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t){this.handlers=t.reduce(function(t,e){return Object.assign(t,(n={},n[e]=[],n));var n},{})}return t.prototype.on=function(t,e){var n=this;return this.guard(t,"subscribe to"),this.handlers[t].push(e),function(){return n.off(t,e)}},t.prototype.off=function(t,e){return this.guard(t,"unsubscribe from"),this.handlers[t].splice(this.handlers[t].findIndex(function(t){return e===t}),1)},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.guard(t,"emit");for(var i=0;i<this.handlers[t].length;i++)(o=this.handlers[t])[i].apply(o,r(e));var o},t.prototype.empty=function(){for(var t in this.handlers)this.handlers[t]=[]},t.prototype.guard=function(t,e){this.handlers[t]||console.warn("Trying to "+e+" a non-supported event “"+t+"”. \n            Supported events are: "+Object.keys(this.handlers).join(", ")+"”")},t}();e.EventHub=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.escapeHTML=function(e){return String(e).replace(/[&<>"'\/]/g,function(e){return t.entityMap[e]})},t.entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'""':"&quot;","'":"&#39;","/":"&#x2F;"},t}();e.HtmlUtils=i},function(t,e,n){n(113);"undefined"==typeof Promise&&(Promise=n(68),n(115)),n(116)},function(t,e,n){"use strict";function i(){if(u.length)throw u.shift()}function r(t){var e;e=a.length?a.pop():new o,e.task=t,s(e)}function o(){this.task=null}var s=n(67),a=[],u=[],c=s.makeRequestCallFromTimer(i);t.exports=r,o.prototype.call=function(){try{this.task.call()}catch(t){r.onerror?r.onerror(t):(u.push(t),c())}finally{this.task=null,a[a.length]=this}}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";function i(t){var e=new r(r._44);return e._83=1,e._18=t,e}var r=n(68);t.exports=r;var o=i(!0),s=i(!1),a=i(null),u=i(void 0),c=i(0),l=i("");r.resolve=function(t){if(t instanceof r)return t;if(null===t)return a;if(void 0===t)return u;if(!0===t)return o;if(!1===t)return s;if(0===t)return c;if(""===t)return l;if("object"==typeof t||"function"==typeof t)try{var e=t.then;if("function"==typeof e)return new r(e.bind(t))}catch(t){return new r(function(e,n){n(t)})}return i(t)},r.all=function(t){var e=Array.prototype.slice.call(t);return new r(function(t,n){function i(s,a){if(a&&("object"==typeof a||"function"==typeof a)){if(a instanceof r&&a.then===r.prototype.then){for(;3===a._83;)a=a._18;return 1===a._83?i(s,a._18):(2===a._83&&n(a._18),void a.then(function(t){i(s,t)},n))}var u=a.then;if("function"==typeof u){return void new r(u.bind(a)).then(function(t){i(s,t)},n)}}e[s]=a,0==--o&&t(e)}if(0===e.length)return t([]);for(var o=e.length,s=0;s<e.length;s++)i(s,e[s])})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){t.forEach(function(t){r.resolve(t).then(e,n)})})},r.prototype.catch=function(t){return this.then(null,t)}},function(t,e){"function"!=typeof Promise.prototype.done&&(Promise.prototype.done=function(t,e){(arguments.length?this.then.apply(this,arguments):this).then(null,function(t){setTimeout(function(){throw t},0)})})},function(t,e){!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!=typeof t&&(t=String(t)),t}function i(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return m.iterable&&(e[Symbol.iterator]=function(){return e}),e}function r(t){this.map={},t instanceof r?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function o(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function s(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function a(t){var e=new FileReader,n=s(e);return e.readAsArrayBuffer(t),n}function u(t){var e=new FileReader,n=s(e);return e.readAsText(t),n}function c(t){for(var e=new Uint8Array(t),n=new Array(e.length),i=0;i<e.length;i++)n[i]=String.fromCharCode(e[i]);return n.join("")}function l(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(m.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(m.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(m.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(m.arrayBuffer&&m.blob&&b(t))this._bodyArrayBuffer=l(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!m.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!_(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=l(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):m.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},m.blob&&(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(a)}),this.text=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},m.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(JSON.parse)},this}function d(t){var e=t.toUpperCase();return w.indexOf(e)>-1?e:t}function h(t,e){e=e||{};var n=e.body;if(t instanceof h){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new r(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new r(e.headers)),this.method=d(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function f(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(r))}}),e}function y(t){var e=new r;return t.split(/\r?\n/).forEach(function(t){var n=t.split(":"),i=n.shift().trim();if(i){var r=n.join(":").trim();e.append(i,r)}}),e}function v(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new r(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var m={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(m.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=function(t){return t&&DataView.prototype.isPrototypeOf(t)},_=ArrayBuffer.isView||function(t){return t&&g.indexOf(Object.prototype.toString.call(t))>-1};r.prototype.append=function(t,i){t=e(t),i=n(i);var r=this.map[t];this.map[t]=r?r+","+i:i},r.prototype.delete=function(t){delete this.map[e(t)]},r.prototype.get=function(t){return t=e(t),this.has(t)?this.map[t]:null},r.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},r.prototype.set=function(t,i){this.map[e(t)]=n(i)},r.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},r.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),i(t)},r.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),i(t)},r.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),i(t)},m.iterable&&(r.prototype[Symbol.iterator]=r.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];h.prototype.clone=function(){return new h(this,{body:this._bodyInit})},p.call(h.prototype),p.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new r(this.headers),url:this.url})},v.error=function(){var t=new v(null,{status:0,statusText:""});return t.type="error",t};var P=[301,302,303,307,308];v.redirect=function(t,e){if(-1===P.indexOf(e))throw new RangeError("Invalid status code");return new v(null,{status:e,headers:{location:t}})},t.Headers=r,t.Request=h,t.Response=v,t.fetch=function(t,e){return new Promise(function(n,i){var r=new h(t,e),o=new XMLHttpRequest;o.onload=function(){var t={status:o.status,statusText:o.statusText,headers:y(o.getAllResponseHeaders()||"")};t.url="responseURL"in o?o.responseURL:t.headers.get("X-Request-URL");var e="response"in o?o.response:o.responseText;n(new v(e,t))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.open(r.method,r.url,!0),"include"===r.credentials&&(o.withCredentials=!0),"responseType"in o&&m.blob&&(o.responseType="blob"),r.headers.forEach(function(t,e){o.setRequestHeader(e,t)}),o.send(void 0===r._bodyInit?null:r._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)}]);
//# sourceMappingURL=rabix.bundle.map