 PathWest Germline Panel 


#### General Pipeline information 

Most the pipeline in executed on the cloud via Illumina _Basespace_. Most features parallelised by chromosome. Each panel has preset configurations (determined by the manufacturer) which would rarely be modified by the bioinformatician. Basespace has various in-built internal checks.


#### Sample QC 

#### FASTQ QC 

 * demultpliex - part of _BaseSpace_ workflow
 * QC statistics generated via Illumina BaseSpace. These are reviewed by the bioinformatician before being entered into an in-house SQL database.

#### Alignment/Assembly 

 * _bwa-mem 0.7.7_ for assembly with default parameters kept [-b -M -t 8 -R ]
 * Exons +-15 bp padding to capture splice sites
 * alignment is performed for each sequencing lane separately, after which the bam files are merged
 * _samtools_ sort - samtools merge
 * duplicates are marked with _picard markduplicates_ (by sample). Note - duplicate reads are not removed from the statistics and hence not necessarily directly comparable to the output from other packages.
 * indel realignment: GATK - split by chromosome. Alignments are concatenated using samtools.
 * Base recalibration not performed.

#### BAM QC 
 * Quality control in BaseSpace can be summarised into several reports:
 * enrichment - summarised across target and reads
 * SNV and indel - basic statistics such as no., percent in dbsnp.
 * coverage, fragment length and duplicate summary
 * bam stats are collected with _Picard CalculateHsMetrics_

 * Coverage assessed in _NextGENe verion XX_. A report containing bam quality metrics is generated and output as an excel file. Evaluated by the bioinformatician with NextGENe flagging metrics that fall outside of a default acceptable range:
  * No. of reads
  * no. of variant calls
  * average read depth
 * Read depth at exon level. Calculated via BWA enrichment Illumina App. Uses built in compiled program called _BamStats.exe_.
 * Stats files downloaded and processed by Bioinformatician via in-house python scripts to assess coverage and gaps.
 * gap analysis - performed on the bam files - custom script for gap checks. _bedtools version XX_ is used to generate the gap report. A bed file defines the gene panel intervals. Exon by exon coverage +- 15 bp splice site. % coverage < 20

#### Variant Calling 

 * vcf 4.1
 * variant calling part of Basespace
 * _GATK UnifiedGenotyper_ does not call SNVs and indels simultaneously

#### SNV & Indels 

 * Part of BaseSpace. Sample-by-sample calling.
 * GATK Unified Genotyper [-dcov 5000 -glm BOTH --output_mode EMIT_ALL_SITES -gvcf ] with gvcf file generated via _GATK GenotypeGVCF_.
 * Variant calling by chromosome [--no-default-filters --min-qd 2.0000 --min-gqx 30.0000 --min-mq 20.0000 ]
 * vcf annotated with _dbSNP version 138_

#### Structural variants & CNV's 

 * Not part of workflow.

#### Variant Annotation 

 * _refseq version 72.5_ sites annotated to vcf as part of Basespace. Off-target sites skipped.
 * _Cartegenia version 4.5_ - combines variant filtering and curation steps. This stage is handled by the curators and medical scientists
 * vcf file generated by BaseSpace is downloaded from the cloud and imported into _Cartegenia version 4.5_
 * Annotation sources XX

#### Variant Filtering 
 * Default filters specified by UnifiedGenotyper: AD, DP set with UnifiedGenotyper pipeline - flag - to identify variants which are known to show poor coverage.
 * Hard filters part of UnifiedGenotyper: --min-qd 2.0000 --min-gqx 30.0000 --min-mq 20.0000

#### Annotation filters 
 * vcf is downloaded from BaseSpace for variant annotation pipeline
 * Hard-cut based on 1 % population frequency (exac, MAF)
 * Variant effect: non-synonymous variants, synonymous/intronic variant plus a predicted effect on splicing
 * Variant compared to an in-house database to filter common variants and known artefacts.

#### Post-annotation filters 
 * Additional annotation and filters by comparing against clinical databases (ClinVar)
 * Mode of inheritance filters

#### Variant QC 

 * Variant quality not evaluated against 'hard thresholds' but instead a visual assessment by the bioinformatician/clinician
 * Hard filters part of UnifiedGenotyper: --min-qd 2.0000 --min-gqx 30.0000 --min-mq 20.0000

#### Verification/Validation 

 * Every run has a control sample so the quality of a run can be assessed
 * Controls sets have been generated for each panel to provide range of expected values for each panel variant
 * Genome is a bottle reference standards processed as part of the NATA accreditation
 * Sanger sequencing or MLPA for independent verification
 * Variants are manually reviewed via Alamut Visualise - in bam format.
#### Curation 

#### Reporting 

 * Follow ACMG guidelines
 * Refseq genes reported for panels
 * HGSV nomenclature used for reporting


Page Authors: M. Gall (AGHA), Michael Black (PathWest), Mark Davis (PathWest)
